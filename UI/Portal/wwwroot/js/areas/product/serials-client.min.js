function setupControls(){$("#Listado").kendoListView({template:kendo.template($("#temp-item").html()),dataBound:function(){$(".no-items").toggleClass("d-none",this.dataSource.data().length>0||pageLoad)}});pageLoad=!1;$("#Report").kendoWindow({visible:!1,width:1100,modal:!0})}function onFiltering(){var n=$.trim($("#serial").val()),t=$("#card-code").val();n!==""&&$.get(urlFilter,{CardCode:t,Serial:n},function(n){if($.trim(n.message)!=="")console.error(n.message),showError("Se ha producido un error al traer los datos del servidor");else{n.items.forEach(n=>n.date=JSON.toDate(n.date));var t=$("#Listado").getKendoListView(),i=new kendo.data.DataSource({data:n.items});t.setDataSource(i)}})}function onFiltering2(n){n.keyCode===13&&onFiltering(n)}function openNote(n){n.preventDefault();var r=$(n.currentTarget).closest(".doc-detail"),t=$(n.currentTarget).closest(".k-listview").data("kendoListView").dataItem(r),i=$("#Report").data("kendoWindow");loadReport(t.number,t.subsidiary,t.docType===13?"Note":"Delivery");i.title(`${t.docType===13?"Nota de Venta":"Nota de Entrega"} ${t.number}`);i.open().center()}function loadReport(n,t,i){var r={Subsidiary:t,DocNumber:n,User:$.trim($(".user-info > .user-name").first().text())},f=i==="Note"?"SaleNote.trdp":"DeliveryNote.trdp",u=$("#reportViewer1").data("telerik_ReportViewer");if(i==="Delivery"&&(r.SearchType=2),u)try{u.reportSource({report:f,parameters:r});u.refreshReport()}catch(e){showInfo("El servidor est√° ocupado, espere un momento y vuelva a intentar.")}else $("#reportViewer1").telerik_ReportViewer({serviceUrl:urlService,reportSource:{report:f,parameters:r},viewMode:telerikReportViewer.ViewModes.INTERACTIVE,scaleMode:telerikReportViewer.ScaleModes.FIT_PAGE_WIDTH})}var pageLoad=!0;$(function(){setupControls()});$("#filter").click(onFiltering);$("#serial").on("keydown",onFiltering2);$("#Listado").on("click",".sale-note, .delivery-note",openNote);