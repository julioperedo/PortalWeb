function setupControls(){var n=$("#initial-date").kendoDatePicker({format:"d/M/yyyy",change:function(){var n=this.value();n===null&&this.value("");t.min(n?n:_minDate)}}).data("kendoDatePicker"),t=$("#final-date").kendoDatePicker({format:"d/M/yyyy",change:function(){var t=this.value();t===null&&this.value("");n.max(t?t:_maxDate)}}).data("kendoDatePicker");_maxDate=t.max();_minDate=n.min();$("#search-type").kendoDropDownList();$("#ContactList").kendoGrid({columns:[{title:"Nombre",field:"name",media:"(min-width: 450px)"},{title:"Empresa",width:160,field:"company",media:"(min-width: 450px)"},{title:"Ciudad",field:"city",media:"(min-width: 550px)"},{title:"Categoría",width:160,field:"category",media:"(min-width: 900px)"},{title:"Cargo",width:120,field:"position",media:"(min-width: 1050px)"},{title:"Fecha",field:"logDate",width:90,format:"{0:dd-MM-yyyy}",attributes:alignCenter,headerAttributes:alignCenter,media:"(min-width: 450px)"},{title:"Hora",field:"logDate",width:65,format:"{0:HH:mm:ss}",attributes:alignCenter,headerAttributes:alignCenter,media:"(min-width: 1200px)"},{width:35,template:'<a class="action action-link see-detail"><i class="fas fa-pen"><\/i><\/a>',attributes:alignCenter,media:"(min-width: 450px)"},{media:"(max-width: 450px)",template:`<div class="row"><div class="col see-detail">#=name#<br />#=company#<br />#=city#<br />Fecha: #=kendo.toString(logDate, "dd-MM-yyyy HH:mm:ss")#</div></div>`}],groupable:{enabled:!1},sortable:!0,selectable:"Single, Row",scrollable:{height:200},noRecords:{template:'<div class="text-center w-100">No se encontraron registros para el criterio de b&uacute;squeda.<\/div>'},dataSource:[],dataBound:n=>n.sender.element.find("table").attr("style","")});$("#WorkList").kendoGrid({columns:[{title:"Nombres",field:"firstName",media:"(min-width: 450px)"},{title:"Apellidos",field:"lastName",media:"(min-width: 450px)"},{title:"F. Nacimiento",width:100,field:"birthday",media:"(min-width: 450px)"},{title:"Estado Civil",width:160,field:"maritalStatus",media:"(min-width: 900px)"},{title:"Ciudad",field:"city",media:"(min-width: 550px)"},{title:"Cargo",width:120,field:"position",media:"(min-width: 1050px)"},{title:"Fecha",field:"logDate",width:90,format:"{0:dd-MM-yyyy}",attributes:alignCenter,headerAttributes:alignCenter,media:"(min-width: 450px)"},{title:"Hora",field:"logDate",width:65,format:"{0:HH:mm:ss}",attributes:alignCenter,headerAttributes:alignCenter,media:"(min-width: 1200px)"},{width:35,template:'<a class="action action-link see-detail"><i class="fas fa-pen"><\/i><\/a>',attributes:alignCenter,media:"(min-width: 450px)"},{media:"(max-width: 450px)",template:`<div class="row"><div class="col see-detail">#=firstName# #=lastName#<br />F. Nacimiento: #=birthday#<br />#=maritalStatus#<br />#=position#<br />Fecha: #=kendo.toString(logDate, "dd-MM-yyyy HH:mm:ss")#</div></div>`}],groupable:{enabled:!1},sortable:!0,selectable:"Single, Row",scrollable:{height:200},noRecords:{template:'<div class="text-center w-100">No se encontraron registros para el criterio de b&uacute;squeda.<\/div>'},dataSource:[],dataBound:n=>n.sender.element.find("table").attr("style","")});$("#RMAList").kendoGrid({columns:[{title:"Nombre",field:"name",media:"(min-width: 450px)"},{title:"Empresa",width:160,field:"company",media:"(min-width: 450px)"},{title:"Ciudad",field:"city",media:"(min-width: 550px)"},{title:"Cod. Producto",width:160,field:"itemCode",media:"(min-width: 900px)"},{title:"Marca",width:120,field:"brand",media:"(min-width: 1050px)"},{title:"Fecha",field:"logDate",width:90,format:"{0:dd-MM-yyyy}",attributes:alignCenter,headerAttributes:alignCenter,media:"(min-width: 450px)"},{title:"Hora",field:"logDate",width:65,format:"{0:HH:mm:ss}",attributes:alignCenter,headerAttributes:alignCenter,media:"(min-width: 1200px)"},{width:35,template:'<a class="action action-link see-detail"><i class="fas fa-pen"><\/i><\/a>',attributes:alignCenter,media:"(min-width: 450px)"},{media:"(max-width: 450px)",template:`<div class="row"><div class="col see-detail">#=name#<br />#=company#<br />#=city#<br />( #=itemCode# ) #=productDesc#<br />Fecha: #=kendo.toString(logDate, "dd-MM-yyyy HH:mm:ss")#</div></div>`}],groupable:{enabled:!1},sortable:!0,selectable:"Single, Row",scrollable:{height:200},noRecords:{template:'<div class="text-center w-100">No se encontraron registros para el criterio de b&uacute;squeda.<\/div>'},dataSource:[],dataBound:n=>n.sender.element.find("table").attr("style","")});$("#Detail").kendoWindow({visible:!1,modal:!0,iframe:!1,scrollable:!0,title:"Detalle del correo",resizable:!1,width:760,actions:["Close"],close:onCloseWindow,activate:function(){var n=this;setTimeout(()=>n.center(),300)}})}function onCleaningFilters(){$("#search-type").data("kendoDropDownList").value("");$("#initial-date").data("kendoDatePicker").value("");$("#final-date").data("kendoDatePicker").value("")}function loadGrid(n,t){t.forEach(t=>{t.logDate=JSON.toDate(t.logDate),n==="RMAList"&&(t.saleDate=JSON.toDate(t.saleDate))});$(".k-grid").addClass("d-none");$(`#${n}`).removeClass("d-none");var i=$(`#${n}`).data("kendoGrid"),r=new kendo.data.DataSource({data:t});i.setDataSource(r);t&&t.length>0?($("#filter-box").collapse("hide"),$("#action-excel").removeClass("d-none")):$("#action-excel").addClass("d-none");setTimeout(()=>setGridHeight("Listado",gridMargin),300)}function filterData(){var n=getFilters(),t;$("#last-search").val(n.data.Type);t=n.data.Type==="C"?"ContactList":n.data.Type==="W"?"WorkList":"RMAList";n.message===""?$.get(urlFilter,n.data,function(n){n.message===""?loadGrid(t,n.items):(console.error(n.message),showError("Se ha producido un error al traer los datos del servidor."))}):showInfo(`Se deben ingresar los siguientes campos: <br />${n.message}`)}function getFilters(){var i="",n=$(`#initial-date`).data("kendoDatePicker").value(),t=$(`#final-date`).data("kendoDatePicker").value(),r=$(`#search-type`).data("kendoDropDownList").value();return n||t?(n&&(n=kendo.toString(n,"yyyy-MM-dd")),t&&(t=t.toString(n,"yyyy-MM-dd"))):i+=`Debe seleccionar al menos una fecha.`,{message:i,data:{Type:r,Since:n,Until:t}}}function seeDetail(n){var l=$("#Detail").data("kendoWindow"),t,i,f,e,o,r,u,s,h,c;c=$("#last-search").val();f=`<div>
    <dl class="row">
        <dt class="col-sm-2">Nombre</dt><dd class="col-sm-10">#=name#</dd>
        <dt class="col-sm-2">E-Mail</dt><dd class="col-sm-10">#=eMail#</dd>
        <dt class="col-sm-2">Empresa</dt><dd class="col-sm-10">#=company#</dd>
        <dt class="col-sm-2">Catego&iacute;a</dt><dd class="col-sm-10">#=category#</dd>
        <dt class="col-sm-2">Cargo</dt><dd class="col-sm-10">#=position#</dd>
        <dt class="col-sm-2">Ciudad</dt><dd class="col-sm-10">#=city#</dd>
        <dt class="col-sm-2">Direcci&oacute;n</dt><dd class="col-sm-10">#=address#</dd>
        <dt class="col-sm-2">Tel&eacute;fono</dt><dd class="col-sm-10">#=phone#</dd>
        <dt class="col-sm-2">NIT</dt><dd class="col-sm-10">#=nit#</dd>
        <dt class="col-sm-2">Tipo de Cliente</dt><dd class="col-sm-10">#=clientType#</dd>
        <dt class="col-sm-2">Mensaje</dt><dd class="col-sm-10">#=message#</dd>
        <dt class="col-sm-2">Fecha</dt><dd class="col-sm-10">#=kendo.toString(logDate, "dd-MM-yyyy HH:mm:ss")#</dd>
    </dl>
</div>`;e=`<div>
    <dl class="row">
        <dt class="col-sm-3">Nombre</dt><dd class="col-sm-9">#=firstName# #=lastName#</dd>
        <dt class="col-sm-3">Fecha Nac.</dt><dd class="col-sm-9">#=birthday#</dd>
        <dt class="col-sm-3">Estado Civil</dt><dd class="col-sm-9">#=maritalStatus#</dd>
        <dt class="col-sm-3">No. Doc.</dt><dd class="col-sm-9">#=identitynDoc#</dd>
        <dt class="col-sm-3">Ciudad</dt><dd class="col-sm-9">#=city#</dd>
        <dt class="col-sm-3">Direcci&oacute;n</dt><dd class="col-sm-9">#=address#</dd>
        <dt class="col-sm-3">Celular</dt><dd class="col-sm-9">#=cellphone#</dd>
        <dt class="col-sm-3">Tel&eacute;fono</dt><dd class="col-sm-9">#=phone#</dd>
        <dt class="col-sm-3">E-Mail</dt><dd class="col-sm-9">#=eMail#</dd>
        <dt class="col-sm-3">Puesto Vacante</dt><dd class="col-sm-9">#=meetRequirements#</dd>
        <dt class="col-sm-3">Experiencia (a&ntilde;os)</dt><dd class="col-sm-9">#=experience#</dd>
        <dt class="col-sm-3">Idiomas</dt><dd class="col-sm-9">#=languages#</dd>
        <dt class="col-sm-3">Pasatiempos</dt><dd class="col-sm-9">#=hobbies#</dd>
        <dt class="col-sm-3">Descr&iacute;bete</dt><dd class="col-sm-9">#=aboutYourself#</dd>
        <dt class="col-sm-3">Referencias</dt><dd class="col-sm-9">#=references#</dd>
        <dt class="col-sm-3">¿Por qu&eacute; nosotros?</dt><dd class="col-sm-9">#=whyUs#</dd>
        <dt class="col-sm-3">Logros</dt><dd class="col-sm-9">#=achievements#</dd>
        <dt class="col-sm-3">Motivo salida</dt><dd class="col-sm-9">#=leavingReason#</dd>
        <dt class="col-sm-3">Celular</dt><dd class="col-sm-9">#=cellphone#</dd>
        <dt class="col-sm-3">Experiencia</dt><dd class="col-sm-9">#=laboralExperience#</dd>
        <dt class="col-sm-3">Puesto</dt><dd class="col-sm-9">#=position#</dd>
        <dt class="col-sm-3">Pretensi&oacute;n salarial</dt><dd class="col-sm-9">#=salaryPretension#</dd>
        <dt class="col-sm-3">Disp. Viaje</dt><dd class="col-sm-9">#=travelAvailability#</dd>
        <dt class="col-sm-3">Adjunto</dt><dd class="col-sm-9"># if($.trim(linkCV) !== "") {# <a href="#=linkCV#" target="_blank">#=linkCV#</a> #} #</dd>
        <dt class="col-sm-3">Fecha</dt><dd class="col-sm-9">#=kendo.toString(logDate, "dd-MM-yyyy HH:mm:ss")#</dd>
    </dl>
</div>`;o=`<div>
    <dl class="row">
        <dt class="col-sm-2">Nombre</dt><dd class="col-sm-10">#=name#</dd>        
        <dt class="col-sm-2">Empresa</dt><dd class="col-sm-10">#=company#</dd>
        <dt class="col-sm-2">Ciudad</dt><dd class="col-sm-10">#=city#</dd>
        <dt class="col-sm-2">Direcci&oacute;n</dt><dd class="col-sm-10">#=address#</dd>
        <dt class="col-sm-2">Celular</dt><dd class="col-sm-10">#=cellphone#</dd>
        <dt class="col-sm-2">Tel&eacute;fono</dt><dd class="col-sm-10">#=phone#</dd>
        <dt class="col-sm-2">E-Mail</dt><dd class="col-sm-10">#=eMail#</dd>
        <dt class="col-sm-2">Producto</dt><dd class="col-sm-10">( #=itemCode# ) #=productDesc#</dd>
        <dt class="col-sm-2">Marca</dt><dd class="col-sm-10">#=brand#</dd>
        <dt class="col-sm-2">Serial</dt><dd class="col-sm-10">#=serialNumber#</dd>
        <dt class="col-sm-2">Nota de Venta</dt><dd class="col-sm-10">#=saleNote#</dd>        
        <dt class="col-sm-2">Fecha Nota</dt><dd class="col-sm-10">#=kendo.toString(saleDate, "dd-MM-yyyy")#</dd>
        <dt class="col-sm-2">Falla</dt><dd class="col-sm-10">#=failure#</dd>
        <dt class="col-sm-2">Tipo</dt><dd class="col-sm-10"># if(type === "DI") {# Distribuidor #} else {# Usuario Final #} #</dd>
        <dt class="col-sm-2">Fecha</dt><dd class="col-sm-10">#=kendo.toString(logDate, "dd-MM-yyyy HH:mm:ss")#</dd>
    </dl>
</div>`;switch(c){case"C":t="ContactList";i=kendo.template(f);break;case"W":t="WorkList";i=kendo.template(e);break;default:t="RMAList";i=kendo.template(o)}r=$(`#${t}`).data("kendoGrid");u=$(n.currentTarget).closest("tr");s=r.dataItem(u);r.select(u);h=i(s);l.content(h).open()}function exportExcel(){var n=$("#last-search").val(),t=n==="C"?"ContactList":n==="W"?"WorkList":"RMAList";$(`#${t}`).data("kendoGrid").saveAsExcel()}var _maxDate,_minDate,products=[],_lastRecieverGridHeight=null,_docId=-1;const alignCenter={style:"text-align: center;"},alignRight={style:"text-align: right;"},gridMargin=30,numberFormat="{0:#,##0.00}",dateFormat="{0:dd-MM-yyyy}";$(window).resize(setGridHeight("Listado",gridMargin));$(()=>setupControls());$("#action-clean").click(onCleaningFilters);$("#action-filter").click(filterData);$("#action-excel").click(exportExcel);$("#ContactList, #WorkList, #RMAList").on("click",".see-detail",seeDetail);