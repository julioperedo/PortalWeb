function onUserChange(){var n=this.dataItem();$("#SAPUser").val(n.code)}function onSavingData(){var n=$(this).closest("form"),i=n.kendoValidator({messages:{required:"Campo requerido.",email:"No es un E-Mail válido."}}).data("kendoValidator"),t;i.validate()&&(t=n.serializeObject(),console.log(t),$.post(n.attr("action"),{UserData:t},function(n){n.message!==""?showError("Algo salió mal",`Se ha producido el siguiente error al intentar guardar los datos:<br />${n.message}`):showMessage("Datos guardados correctamente")}))}function onChangePassword(){var n=$(this).closest("form"),i={rules:{oldpassword:n=>n.is("#OldPassword")?$.trim(n.val())===$.trim($("#CurrentPassword").val()):!0,confirmpassword:n=>n.is("#ConfirmPassword")?$.trim(n.val())===$.trim($("#NewPassword").val()):!0,minlen:n=>n.is("#NewPassword")||n.is("#ConfirmPassword")?n.val().length>5:!0},messages:{required:"Campo requerido",oldpassword:"La contrase&ntilde;a no es correcta",minlen:"La nueva contrase&ntilde;a debe tener al menos 6 caracteres",confirmpassword:"Las contrase&ntilde;as no coinciden"}},r=n.kendoValidator(i).data("kendoValidator"),t;r.validate()&&(t=n.serializeObject(),$.post(n.attr("action"),{NewPassword:t.NewPassword},function(n){n.message!==""?showError("Se ha producido el siguiente error al intentar actualizar la contrase&ntilde;a:<br />"+n.message):($("#CurrentPassword").val(t.NewPassword),showMessage("Contraseña actualizada correctamente."))}))}function onUpdateOtherData(){var n=$(this).closest("form"),t=n.serializeObject();$.post(n.attr("action"),{UserData:t},function(n){n.message!==""?showError("Se ha producido el siguiente error al intentar guardar los datos:<br />"+n.message):showMessage("Datos guardados correctamente")})}$("#savePersonalData").click(onSavingData);$("#changePassword").click(onChangePassword);$("#updateOtherData").click(onUpdateOtherData);$(document).on("click",".k-imagebrowser>.k-filemanager-listview>.k-listview-content>.k-listview-item",function(){var n=$("#k-editor-image-url")[0];n&&/%2F/.test(n.value)&&(n.value=n.value.replace(/%2F/g,"/").replace("userdata/",""))});$("#photo-camera").on("click",function(){Webcam.set({width:320,height:240,dest_width:320,dest_height:240,crop_width:240,crop_height:240});Webcam.attach("#my_camera");$("#camera").removeClass("d-none")});$("#photo-gallery").click(function(){$("#gallery").val(null);$("#gallery").click()});$("#photo-remove").click(function(){$("#photo").attr("src",urlNoPhoto);$("#new-photo").val("")});$("#gallery").change(function(){if(this.files&&this.files[0]){var n=new FileReader;n.addEventListener("load",function(n){$("#photo").attr("src",n.target.result);$("#new-photo").val(n.target.result)});n.readAsDataURL(this.files[0])}});$("#take-photo-ok").click(function(){Webcam.snap(function(n){$("#photo").attr("src",n);$("#new-photo").val(n);Webcam.reset();$("#camera").addClass("d-none")})});$("#take-photo-cancel").click(function(){Webcam.reset();$("#camera").addClass("d-none")});$("#savePicture").click(function(){var n=$("#new-photo").val();n===""?showInfo("No hay nada para guardar."):$.post(urlSavePhoto,{ImageBase64:n},function(n){n.message===""?($("#new-photo").val(""),showMessage("Fotografía actualizada correctamente.")):showError(n.message)})});