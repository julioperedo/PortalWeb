function setupControls(){$("#Listado").kendoGrid({noRecords:{template:'<div class="text-center w-100">No se encontraron registros para el criterio de b&uacute;squeda.<\/div>'},columns:[{title:"Nombre",field:"name"},{title:"Descripción",field:"description"},{title:"Tipo",field:"type",hidden:!0},{field:"id",title:" ",attributes:alignCenter,width:70,sortable:!1,headerAttributes:alignCenter,headerTemplate:'<a title="Nuevo Perfil" class="action action-link action-new"><i class="fas fa-plus"><\/i><\/a>',template:'<a title="Editar Perfil" class="action action-link action-edit"><i class="fas fa-pen"><\/i><\/a><a title="Eliminar Perfil" class="action action-link action-delete"><i class="fas fa-trash-alt"><\/i><\/a>'}],sortable:!0,selectable:"Single, Row",dataSource:[]});filterData(!0)}function cleanFilters(){$("#filter").val("")}function getFilters(){var n=$("#filter").val();return{message:"",data:{FilterData:n}}}function filterData(n){var t=getFilters();t.message===""?$.get(urlFilter,t.data,function(n){loadGrid(n.items);n.message!==""&&showError(`Se ha producido el siguiente error al traer los datos: ${n.message}`)}):(setGridHeight("Listado",_gridMargin),n||showInfo(`Se deben ingresar los siguientes campos: <br />${t.message}`))}function loadGrid(n){if(n){var t=$("#Listado").data("kendoGrid"),i=new kendo.data.DataSource({data:n,group:[{field:"type",dir:"asc"}],sort:[{field:"type",dir:"asc"}],schema:{model:{id:"id"}}});t.setDataSource(i);n&&n.length>0?($("#filter-box").collapse("hide"),$("#action-excel").removeClass("d-none")):$("#action-excel").addClass("d-none");setGridHeight("Listado",_gridMargin)}}function toBool(n){return n==="true"||n==="True"}function onEdit(n){var i,t,r,u;n.preventDefault();i=$("#Detail").data("kendoWindow");t=$("#Listado").data("kendoGrid");this.classList.contains("action-new")?(t.clearSelection(),r={id:0}):(u=$(n.currentTarget).closest("tr"),t.select(u),r=t.dataItem(u));i.refresh({url:urlEdit,data:{Id:r.id}});i.center().open()}function onDelete(n){n.preventDefault();var t=$("#Listado").data("kendoGrid").dataItem($(n.currentTarget).closest("tr"));showConfirm(`¿Está seguro que desea eliminar el Perfil <b>${t.name}</b>?`,function(){var n=getFilters();$.post(urlDelete,{Id:t.id,FilterData:n.FilterData},function(n){n.message===""?(loadGrid(n.items),showMessage(`Se ha eliminado el Perfil <b>${t.name}</b> correctamente.`)):showError(n.message)})})}function onSave(n){var i,r,t,u;n.preventDefault();i=$("#form-profile");r=i.kendoValidator().data("kendoValidator");r.validate()&&(t=i.serializeObject(),t.isExternalCapable=$("#isExternalCapable").prop("checked"),t.ListProfileActivitys=[],$(".activity-row").each(function(n,i){var r=$(i).find(".p-insert"),u=$(i).find(".p-update"),f=$(i).find(".p-delete"),e;(toBool(r.data("value"))!==r.prop("checked")||toBool(u.data("value"))!==u.prop("checked")||toBool(f.data("value"))!==f.prop("checked"))&&(e=r.data("id")===0?1:2,t.ListProfileActivitys.push({Id:r.data("id"),IdActivity:r.data("idactivity"),Insert:r.prop("checked"),Update:u.prop("checked"),Delete:f.prop("checked"),StatusType:e}))}),t.ListProfilePages=[],$(".page-row").each(function(n,i){var r=$(i).find("[type=checkbox]"),u;toBool(r.data("value"))!==r.prop("checked")&&(u=r.prop("checked")?1:3,t.ListProfilePages.push({Id:r.data("id"),IdPage:r.data("idpage"),StatusType:u}))}),t.ListProfileCharts=[],$(".chart-row").each(function(n,i){var r=$(i).find("[type=checkbox]"),u;toBool(r.data("value"))!==r.prop("checked")&&(u=r.prop("checked")?1:3,t.ListProfileCharts.push({Id:r.data("id"),IdChart:r.data("idchart"),StatusType:u}))}),u=getFilters(),$.post(urlEdit,{Item:t,FilterData:u.FilterData},function(n){n.message===""?(loadGrid(n.items),$("#Detail").data("kendoWindow").close(),showMessage("Se realizaron los cambios correctamente.")):showError(n.message)}))}var newId=0;const alignCenter={style:"text-align: center;"},alignRight={style:"text-align: right;"},numberFormat="{0:#,##0.00}",dateFormat="{0:dd-MM-yyyy}",_gridMargin=30;$(()=>setupControls());$(window).resize(()=>setGridHeight("Listado",_gridMargin));$("#filter-box").on("hidden.bs.collapse",()=>setGridHeight("Listado",_gridMargin));$("#filter-box").on("shown.bs.collapse",()=>setGridHeight("Listado",_gridMargin));$("#action-clean").click(()=>cleanFilters());$("#action-filter").click(()=>filterData(!1));$("#Listado").on("click",".action-new",onEdit);$("#Listado").on("click",".action-edit",onEdit);$("#Listado").on("click",".action-delete",onDelete);$("#Detail").on("click","#action-cancel",()=>$("#Detail").data("kendoWindow").close());$("#Detail").on("click","#action-save",onSave);