!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return t(o),t.Highcharts=o,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){"use strict";o=o?o._modules:{};function t(o,t,n,e){o.hasOwnProperty(t)||(o[t]=e.apply(null,n),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:o[t]}})))}t(o,"Stock/Indicators/IKH/IKHIndicator.js",[o["Extensions/DataGrouping/ApproximationRegistry.js"],o["Core/Color/Color.js"],o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(i,o,X,t){var e,n=this&&this.__extends||(e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])})(o,t)},function(o,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p=o.parse,o=X.seriesTypes.sma,L=t.defined,s=t.extend,v=t.isArray,r=t.isNumber,m=t.getClosestDistance,_=t.merge,M=t.objectEach;function C(o){return{high:o.reduce(function(o,t){return Math.max(o,t[1])},-1/0),low:o.reduce(function(o,t){return Math.min(o,t[2])},1/0)}}function D(o){var t=o.indicator;t.points=o.points,t.nextPoints=o.nextPoints,t.color=o.color,t.options=_(o.options.senkouSpan.styles,o.gap),t.graph=o.graph,t.fillGraph=!0,X.seriesTypes.sma.prototype.drawGraph.call(t)}n(l,a=o),l.prototype.init=function(){a.prototype.init.apply(this,arguments),this.options=_({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:p(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:p(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:p(this.color).setOpacity(.2).get()}}},this.options)},l.prototype.toYData=function(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]},l.prototype.translate=function(){X.seriesTypes.sma.prototype.translate.apply(this);for(var o=0,t=this.points;o<t.length;o++)for(var n=t[o],e=0,i=this.pointArrayMap;e<i.length;e++){var p=i[e],s=n[p];r(s)&&(n["plot"+p]=this.yAxis.toPixels(s,!0),n.plotY=n["plot"+p],n.tooltipPos=[n.plotX,n["plot"+p]],n.isNull=!1)}},l.prototype.drawGraph=function(){var o,t,n,e,i,p,s,r,a,l,h,u,c,f,g=this,d=g.points,k=g.options,y=g.graph,S=g.color,v={options:{gapSize:k.gapSize}},m=g.pointArrayMap.length,C=[[],[],[],[],[],[]],A={tenkanLine:C[0],kijunLine:C[1],chikouLine:C[2],senkouSpanA:C[3],senkouSpanB:C[4],senkouSpan:C[5]},x=[],Y=g.options.senkouSpan,P=Y.color||Y.styles.fill,j=Y.negativeColor,B=[[],[]],b=[[],[]],N=d.length,w=0;for(g.ikhMap=A;N--;){for(n=0,t=d[N];n<m;n++)L(t[o=g.pointArrayMap[n]])&&C[n].push({plotX:t.plotX,plotY:t["plot"+o],isNull:!1});j&&N!==d.length-1&&(c=A.senkouSpanB.length-1,(f=function(o,t,n,e){if(o&&t&&n&&e){var i=t.plotX-o.plotX,t=t.plotY-o.plotY,p=e.plotX-n.plotX,e=e.plotY-n.plotY,s=o.plotX-n.plotX,n=o.plotY-n.plotY,r=(-t*s+i*n)/(-p*t+i*e),n=(p*n-e*s)/(-p*t+i*e);if(0<=r&&r<=1&&0<=n&&n<=1)return{plotX:o.plotX+n*i,plotY:o.plotY+n*t}}}(A.senkouSpanA[c-1],A.senkouSpanA[c],A.senkouSpanB[c-1],A.senkouSpanB[c]))&&(f={plotX:f.plotX,plotY:f.plotY,isNull:!1,intersectPoint:!0},A.senkouSpanA.splice(c,0,f),A.senkouSpanB.splice(c,0,f),x.push(c)))}if(M(A,function(o,t){k[t]&&"senkouSpan"!==t&&(g.points=C[w],g.options=_(k[t].styles,v),g.graph=g["graph"+t],g.fillGraph=!1,g.color=S,X.seriesTypes.sma.prototype.drawGraph.call(g),g["graph"+t]=g.graph),w++}),g.graphCollection)for(var O=0,E=g.graphCollection;O<E.length;O++){var G=E[O];g[G].destroy(),delete g[G]}if(g.graphCollection=[],j&&A.senkouSpanA[0]&&A.senkouSpanB[0]){for(x.unshift(0),x.push(A.senkouSpanA.length-1),h=0;h<x.length-1;h++)if(T=x[h],e=x[h+1],i=A.senkouSpanB.slice(T,e+1),p=A.senkouSpanA.slice(T,e+1),1<=Math.floor(i.length/2)){var T=Math.floor(i.length/2);if(i[T].plotY===p[T].plotY){for(r=s=u=0;u<i.length;u++)s+=i[u].plotY,r+=p[u].plotY;B[l=r<s?0:1]=B[l].concat(i),b[l]=b[l].concat(p)}else B[l=i[T].plotY>p[T].plotY?0:1]=B[l].concat(i),b[l]=b[l].concat(p)}else B[l=i[0].plotY>p[0].plotY?0:1]=B[l].concat(i),b[l]=b[l].concat(p);["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,t){B[t].length&&b[t].length&&(a=0===t?P:j,D({indicator:g,points:B[t],nextPoints:b[t],color:a,options:k,gap:v,graph:g[o]}),g[o]=g.graph,g.graphCollection.push(o))})}else D({indicator:g,points:A.senkouSpanB,nextPoints:A.senkouSpanA,color:P,options:k,gap:v,graph:g.graphsenkouSpan}),g.graphsenkouSpan=g.graph;delete g.nextPoints,delete g.fillGraph,g.points=d,g.options=k,g.graph=y,g.color=S},l.prototype.getGraphPath=function(o){var t,n=[];if(o=o||this.points,this.fillGraph&&this.nextPoints){if((t=X.seriesTypes.sma.prototype.getGraphPath.call(this,this.nextPoints))&&t.length){t[0][0]="L";for(var e,n=X.seriesTypes.sma.prototype.getGraphPath.call(this,o),i=(e=t.slice(0,n.length)).length-1;0<=i;i--)n.push(e[i])}}else n=X.seriesTypes.sma.prototype.getGraphPath.apply(this,arguments);return n},l.prototype.getValues=function(o,t){var n,e,i,p,s,r,a=t.period,l=t.periodTenkan,h=t.periodSenkouSpanB,u=o.xData,c=o.yData,t=o.xAxis,f=c&&c.length||0,g=m(t.series.map(function(o){return o.xData||[]})),d=[],k=[];if(!(u.length<=a)&&v(c[0])&&4===c[0].length){for(var y=u[0]-a*g,S=0;S<a;S++)k.push(y+S*g);for(S=0;S<f;S++)l<=S&&(e=((e=C(c.slice(S-l,S))).high+e.low)/2),a<=S&&(s=(e+(i=((i=C(c.slice(S-a,S))).high+i.low)/2))/2),h<=S&&(r=((r=C(c.slice(S-h,S))).high+r.low)/2),p=c[S][3],n=u[S],void 0===d[S]&&(d[S]=[]),void 0===d[S+a-1]&&(d[S+a-1]=[]),d[S+a-1][0]=e,d[S+a-1][1]=i,(d[S+a-1][2]=void 0)===d[S+1]&&(d[S+1]=[]),d[S+1][2]=p,S<=a&&(d[S+a-1][3]=void 0,d[S+a-1][4]=void 0),void 0===d[S+2*a-2]&&(d[S+2*a-2]=[]),d[S+2*a-2][3]=s,d[S+2*a-2][4]=r,k.push(n);for(S=1;S<=a;S++)k.push(n+S*g);return{values:d,xData:k,yData:d}}},l.defaultOptions=_(o.defaultOptions,{params:{index:void 0,period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}});var a,t=l;function l(){var o=null!==a&&a.apply(this,arguments)||this;return o.data=[],o.options={},o.points=[],o.graphCollection=[],o}return s(t.prototype,{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"]}),i["ichimoku-averages"]=function(){var n,e=[];return[].forEach.call(arguments,function(o,t){e.push(i.average(o)),n=!n&&void 0===e[t]}),n?void 0:e},X.registerSeriesType("ikh",t),t}),t(o,"masters/indicators/ichimoku-kinko-hyo.src.js",[],function(){})});