!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/indicators/volume-by-price",["highcharts","highcharts/modules/stock"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";t=t?t._modules:{};function e(t,e,o,i){t.hasOwnProperty(e)||(t[e]=i.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t,"Stock/Indicators/VBP/VBPPoint.js",[t["Core/Series/SeriesRegistry.js"]],function(t){var i,e,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});return e=t.seriesTypes.sma.prototype.pointClass,o(n,e),n.prototype.destroy=function(){this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy()),e.prototype.destroy.apply(this,arguments)},n;function n(){return null!==e&&e.apply(this,arguments)||this}}),e(t,"Stock/Indicators/VBP/VBPIndicator.js",[t["Stock/Indicators/VBP/VBPPoint.js"],t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"],t["Core/Chart/StockChart.js"]],function(t,e,o,i,n,s){var a,r,p=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=e.animObject,e=o.noop,o=i.seriesTypes,v=o.column.prototype,o=o.sma,h=n.addEvent,y=n.arrayMax,f=n.arrayMin,g=n.correctFloat,m=n.defined,u=n.error,d=n.extend,c=n.isArray,n=n.merge,x=Math.abs,p=(p(S,r=o),S.prototype.init=function(o,t){var i=this,n=(delete t.data,r.prototype.init.apply(i,arguments),h(s,"afterLinkSeries",function(){var t,e;i.options&&(e=i.options.params,t=i.linkedParent,e=o.get(e.volumeSeriesID),i.addCustomEvents(t,e)),n()},{order:1}));return i},S.prototype.addCustomEvents=function(t,e){function o(){i.chart.redraw(),i.setData([]),i.zoneStarts=[],i.zoneLinesSVG&&(i.zoneLinesSVG=i.zoneLinesSVG.destroy())}var i=this;return i.dataEventsToUnbind.push(h(t,"remove",function(){o()})),e&&i.dataEventsToUnbind.push(h(e,"remove",function(){o()})),i},S.prototype.animate=function(t){var o=this,e=o.chart.inverted,i=o.group,n={};!t&&i&&(t=e?o.yAxis.top:o.xAxis.left,e?(i["forceAnimate:translateY"]=!0,n.translateY=t):(i["forceAnimate:translateX"]=!0,n.translateX=t),i.animate(n,d(l(o.options.animation),{step:function(t,e){o.group.attr({scaleX:Math.max(.001,e.pos)})}})))},S.prototype.drawPoints=function(){this.options.volumeDivision.enabled&&(this.posNegVolume(!0,!0),v.drawPoints.apply(this,arguments),this.posNegVolume(!1,!1)),v.drawPoints.apply(this,arguments)},S.prototype.posNegVolume=function(t,e){var o,i,n,s,a=e?["positive","negative"]:["negative","positive"],r=this.options.volumeDivision,p=this.points.length,l=[],h=[],u=0;for(t?(this.posWidths=l,this.negWidths=h):(l=this.posWidths,h=this.negWidths);u<p;u++)(s=this.points[u])[a[0]+"Graphic"]=s.graphic,s.graphic=s[a[1]+"Graphic"],t&&(o=s.shapeArgs.width,(n=(i=this.priceZones[u]).wholeVolumeData)?(l.push(o/n*i.positiveVolumeData),h.push(o/n*i.negativeVolumeData)):(l.push(0),h.push(0))),s.color=e?r.styles.positiveColor:r.styles.negativeColor,s.shapeArgs.width=(e?this.posWidths:this.negWidths)[u],s.shapeArgs.x=e?s.shapeArgs.x:this.posWidths[u]},S.prototype.translate=function(){var o,i,n,s,a,r,p,l=this,t=l.options,e=l.chart,h=l.yAxis,u=h.min,d=l.options.zoneLines,c=l.priceZones,f=0,m=(v.translate.apply(l),l.points);m.length&&(t=t.pointPadding<.5?t.pointPadding:.1,o=y(l.volumeDataArray),i=e.plotWidth/2,r=e.plotTop,n=x(h.toPixels(u)-h.toPixels(u+l.rangeStep)),s=x(h.toPixels(u)-h.toPixels(u+l.rangeStep)),t&&(u=x(n*(1-2*t)),f=x((n-u)/2),n=x(u)),m.forEach(function(t,e){t.barX=t.plotX=0,p=t.plotY=h.toPixels(c[e].start)-r-(h.reversed?n-s:n)-f,a=g(i*c[e].wholeVolumeData/o),t.pointWidth=a,t.shapeArgs=l.crispCol.apply(l,[0,p,a,n]),t.volumeNeg=c[e].negativeVolumeData,t.volumePos=c[e].positiveVolumeData,t.volumeAll=c[e].wholeVolumeData}),d.enabled&&l.drawZones(e,h,l.zoneStarts,d.styles))},S.prototype.getExtremes=function(){var t,e=this.options.compare,o=this.options.cumulative;return this.options.compare?(this.options.compare=void 0,t=r.prototype.getExtremes.call(this),this.options.compare=e):this.options.cumulative?(this.options.cumulative=!1,t=r.prototype.getExtremes.call(this),this.options.cumulative=o):t=r.prototype.getExtremes.call(this),t},S.prototype.getValues=function(t,e){var o,i=t.processedXData,n=t.processedYData,s=this.chart,a=e.ranges,r=[],p=[],l=[],h=s.get(e.volumeSeriesID);if(t.chart){if(h&&h.processedXData.length)return(o=c(n[0]))&&4!==n[0].length?void u("Type of "+t.name+" series is different than line, OHLC or candlestick.",!0,s):((this.priceZones=this.specifyZones(o,i,n,a,h)).forEach(function(t,e){r.push([t.x,t.end]),p.push(r[e][0]),l.push(r[e][1])}),{values:r,xData:p,yData:l});t=h&&!h.processedXData.length?" does not contain any data.":" not found! Check `volumeSeriesID`.",void u("Series "+e.volumeSeriesID+t,!0,s)}else u("Base series not found! In case it has been removed, add a new one.",!0,s)},S.prototype.specifyZones=function(t,e,o,i,n){var s=!!t&&function(t){for(var e,o=t.length,i=t[0][3],n=i,s=1;s<o;s++)(e=t[s][3])<i&&(i=e),n<e&&(n=e);return{min:i,max:n}}(o),a=this.zoneStarts=[],r=[],p=s?s.min:f(o),s=s?s.max:y(o),l=0,h=1,u=this.linkedParent;if(!this.options.compareToMain&&u.dataModify&&(p=u.dataModify.modifyValue(p),s=u.dataModify.modifyValue(s)),!m(p)||!m(s))return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG&&(this.zoneLinesSVG=this.zoneLinesSVG.destroy())),[];var d=this.rangeStep=g(s-p)/i;for(a.push(p);l<i-1;l++)a.push(g(a[l]+d));a.push(s);for(var c=a.length;h<c;h++)r.push({index:h-1,x:e[0],start:a[h-1],end:a[h]});return this.volumePerZone(t,r,n,e,o)},S.prototype.volumePerZone=function(o,t,e,i,n){var s,a,r,p,l,h=this,u=e.processedXData,d=e.processedYData,c=t.length-1,f=n.length,e=d.length;return x(f-e)&&(i[0]!==u[0]&&d.unshift(0),i[f-1]!==u[e-1]&&d.push(0)),h.volumeDataArray=[],t.forEach(function(t){for(l=0,t.wholeVolumeData=0,t.positiveVolumeData=0,t.negativeVolumeData=0;l<f;l++){r=a=!1,p=o?n[l][3]:n[l],s=l?o?n[l-1][3]:n[l-1]:p;var e=h.linkedParent;!h.options.compareToMain&&e.dataModify&&(p=e.dataModify.modifyValue(p),s=e.dataModify.modifyValue(s)),p<=t.start&&0===t.index&&(a=!0),p>=t.end&&t.index===c&&(r=!0),(p>t.start||a)&&(p<t.end||r)&&(t.wholeVolumeData+=d[l],p<s?t.negativeVolumeData+=d[l]:t.positiveVolumeData+=d[l])}h.volumeDataArray.push(t.wholeVolumeData)}),t},S.prototype.drawZones=function(e,o,t,i){var n,s=e.renderer,a=e.plotWidth,r=e.plotTop,p=this.zoneLinesSVG,l=[];t.forEach(function(t){n=o.toPixels(t)-r,l=l.concat(e.renderer.crispLine([["M",0,n],["L",a,n]],i.lineWidth))}),p?p.animate({d:l}):this.zoneLinesSVG=s.path(l).attr({"stroke-width":i.lineWidth,stroke:i.color,dashstyle:i.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)},S.defaultOptions=n(o.defaultOptions,{params:{index:void 0,period:void 0,ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},animationLimit:1e3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",padding:0,style:{fontSize:"0.5em"},verticalAlign:"top"}}),S);function S(){var t=null!==r&&r.apply(this,arguments)||this;return t.data=void 0,t.negWidths=void 0,t.options=void 0,t.points=void 0,t.posWidths=void 0,t.priceZones=void 0,t.rangeStep=void 0,t.volumeDataArray=void 0,t.zoneStarts=void 0,t.zoneLinesSVG=void 0,t}return d(p.prototype,{nameBase:"Volume by Price",nameComponents:["ranges"],calculateOn:{chart:"render",xAxis:"afterSetExtremes"},pointClass:t,markerAttribs:e,drawGraph:e,getColumnMetrics:v.getColumnMetrics,crispCol:v.crispCol}),i.registerSeriesType("vbp",p),p}),e(t,"masters/indicators/volume-by-price.src.js",[],function(){})});