!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/indicators/volume-by-price",["highcharts","highcharts/modules/stock"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";t=t?t._modules:{};function e(t,e,o,i){t.hasOwnProperty(e)||(t[e]=i.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t,"Stock/Indicators/VBP/VBPPoint.js",[t["Core/Series/SeriesRegistry.js"]],function(t){var i,e,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),t=t.seriesTypes.sma.prototype.pointClass;function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e=t),n.prototype.destroy=function(){this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy()),e.prototype.destroy.apply(this,arguments)},n}),e(t,"Stock/Indicators/VBP/VBPIndicator.js",[t["Stock/Indicators/VBP/VBPPoint.js"],t["Core/Animation/AnimationUtilities.js"],t["Core/Globals.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"],t["Core/Chart/StockChart.js"]],function(t,e,o,i,n,s){var a,r=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),p=e.animObject,e=o.noop,o=i.seriesTypes,y=o.column.prototype,o=o.sma,l=n.addEvent,g=n.arrayMax,v=n.arrayMin,x=n.correctFloat,f=n.defined,u=n.error,d=n.extend,h=n.isArray,n=n.merge,S=Math.abs;r(m,c=o),m.prototype.init=function(o,t){var i=this,n=(delete t.data,c.prototype.init.apply(i,arguments),l(s,"afterLinkSeries",function(){var t,e;i.options&&(e=i.options.params,t=i.linkedParent,e=o.get(e.volumeSeriesID),i.addCustomEvents(t,e)),n()},{order:1}));return i},m.prototype.addCustomEvents=function(t,e){function o(){i.chart.redraw(),i.setData([]),i.zoneStarts=[],i.zoneLinesSVG&&(i.zoneLinesSVG=i.zoneLinesSVG.destroy())}var i=this;return i.dataEventsToUnbind.push(l(t,"remove",function(){o()})),e&&i.dataEventsToUnbind.push(l(e,"remove",function(){o()})),i},m.prototype.animate=function(t){var o=this,e=o.chart.inverted,i=o.group,n={};!t&&i&&(t=e?o.yAxis.top:o.xAxis.left,e?(i["forceAnimate:translateY"]=!0,n.translateY=t):(i["forceAnimate:translateX"]=!0,n.translateX=t),i.animate(n,d(p(o.options.animation),{step:function(t,e){o.group.attr({scaleX:Math.max(.001,e.pos)})}})))},m.prototype.drawPoints=function(){var t=this;t.options.volumeDivision.enabled&&(t.posNegVolume(!0,!0),y.drawPoints.apply(t,arguments),t.posNegVolume(!1,!1)),y.drawPoints.apply(t,arguments)},m.prototype.posNegVolume=function(t,e){var o,i,n,s,a=this,r=e?["positive","negative"]:["negative","positive"],p=a.options.volumeDivision,l=a.points.length,d=[],u=[],h=0;for(t?(a.posWidths=d,a.negWidths=u):(d=a.posWidths,u=a.negWidths);h<l;h++)(s=a.points[h])[r[0]+"Graphic"]=s.graphic,s.graphic=s[r[1]+"Graphic"],t&&(o=s.shapeArgs.width,(n=(i=a.priceZones[h]).wholeVolumeData)?(d.push(o/n*i.positiveVolumeData),u.push(o/n*i.negativeVolumeData)):(d.push(0),u.push(0))),s.color=e?p.styles.positiveColor:p.styles.negativeColor,s.shapeArgs.width=(e?a.posWidths:a.negWidths)[h],s.shapeArgs.x=e?s.shapeArgs.x:a.posWidths[h]},m.prototype.translate=function(){var o,i,n,t,s,a,r,p,l=this,e=l.options,d=l.chart,u=l.yAxis,h=u.min,c=l.options.zoneLines,m=l.priceZones,v=0,f=(y.translate.apply(l),l.points);f.length&&(e=e.pointPadding<.5?e.pointPadding:.1,t=l.volumeDataArray,o=g(t),i=d.plotWidth/2,r=d.plotTop,n=S(u.toPixels(h)-u.toPixels(h+l.rangeStep)),s=S(u.toPixels(h)-u.toPixels(h+l.rangeStep)),e&&(t=S(n*(1-2*e)),v=S((n-t)/2),n=S(t)),f.forEach(function(t,e){t.barX=t.plotX=0,p=t.plotY=u.toPixels(m[e].start)-r-(u.reversed?n-s:n)-v,a=x(i*m[e].wholeVolumeData/o),t.pointWidth=a,t.shapeArgs=l.crispCol.apply(l,[0,p,a,n]),t.volumeNeg=m[e].negativeVolumeData,t.volumePos=m[e].positiveVolumeData,t.volumeAll=m[e].wholeVolumeData}),c.enabled&&l.drawZones(d,u,l.zoneStarts,c.styles))},m.prototype.getExtremes=function(){var t,e=this.options.compare,o=this.options.cumulative;return this.options.compare?(this.options.compare=void 0,t=c.prototype.getExtremes.call(this),this.options.compare=e):this.options.cumulative?(this.options.cumulative=!1,t=c.prototype.getExtremes.call(this),this.options.cumulative=o):t=c.prototype.getExtremes.call(this),t},m.prototype.getValues=function(t,e){var o,i=t.processedXData,n=t.processedYData,s=this.chart,a=e.ranges,r=[],p=[],l=[],d=s.get(e.volumeSeriesID);if(t.chart){if(d&&d.processedXData.length)return(o=h(n[0]))&&4!==n[0].length?void u("Type of "+t.name+" series is different than line, OHLC or candlestick.",!0,s):((this.priceZones=this.specifyZones(o,i,n,a,d)).forEach(function(t,e){r.push([t.x,t.end]),p.push(r[e][0]),l.push(r[e][1])}),{values:r,xData:p,yData:l});t=d&&!d.processedXData.length?" does not contain any data.":" not found! Check `volumeSeriesID`.",void u("Series "+e.volumeSeriesID+t,!0,s)}else u("Base series not found! In case it has been removed, add a new one.",!0,s)},m.prototype.specifyZones=function(t,e,o,i,n){var s=this,a=!!t&&function(t){for(var e,o=t.length,i=t[0][3],n=i,s=1;s<o;s++)(e=t[s][3])<i&&(i=e),n<e&&(n=e);return{min:i,max:n}}(o),r=s.zoneStarts=[],p=[],l=a?a.min:v(o),a=a?a.max:g(o),d=0,u=1,h=s.linkedParent;if(!s.options.compareToMain&&h.dataModify&&(l=h.dataModify.modifyValue(l),a=h.dataModify.modifyValue(a)),!f(l)||!f(a))return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG&&(this.zoneLinesSVG=this.zoneLinesSVG.destroy())),[];var c=s.rangeStep=x(a-l)/i;for(r.push(l);d<i-1;d++)r.push(x(r[d]+c));r.push(a);for(var m=r.length;u<m;u++)p.push({index:u-1,x:e[0],start:r[u-1],end:r[u]});return s.volumePerZone(t,p,n,e,o)},m.prototype.volumePerZone=function(o,t,e,i,n){var s,a,r,p,l,d=this,u=e.processedXData,h=e.processedYData,c=t.length-1,m=n.length,e=h.length;return S(m-e)&&(i[0]!==u[0]&&h.unshift(0),i[m-1]!==u[e-1]&&h.push(0)),d.volumeDataArray=[],t.forEach(function(t){for(t.wholeVolumeData=0,t.positiveVolumeData=0,t.negativeVolumeData=0,l=0;l<m;l++){r=a=!1,p=o?n[l][3]:n[l],s=l?o?n[l-1][3]:n[l-1]:p;var e=d.linkedParent;!d.options.compareToMain&&e.dataModify&&(p=e.dataModify.modifyValue(p),s=e.dataModify.modifyValue(s)),p<=t.start&&0===t.index&&(a=!0),p>=t.end&&t.index===c&&(r=!0),(p>t.start||a)&&(p<t.end||r)&&(t.wholeVolumeData+=h[l],p<s?t.negativeVolumeData+=h[l]:t.positiveVolumeData+=h[l])}d.volumeDataArray.push(t.wholeVolumeData)}),t},m.prototype.drawZones=function(e,o,t,i){var n,s=e.renderer,a=e.plotWidth,r=e.plotTop,p=this.zoneLinesSVG,l=[];t.forEach(function(t){n=o.toPixels(t)-r,l=l.concat(e.renderer.crispLine([["M",0,n],["L",a,n]],i.lineWidth))}),p?p.animate({d:l}):this.zoneLinesSVG=s.path(l).attr({"stroke-width":i.lineWidth,stroke:i.color,dashstyle:i.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)},m.defaultOptions=n(o.defaultOptions,{params:{index:void 0,period:void 0,ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},animationLimit:1e3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",padding:0,style:{fontSize:"0.5em"},verticalAlign:"top"}});var c,r=m;function m(){var t=null!==c&&c.apply(this,arguments)||this;return t.data=void 0,t.negWidths=void 0,t.options=void 0,t.points=void 0,t.posWidths=void 0,t.priceZones=void 0,t.rangeStep=void 0,t.volumeDataArray=void 0,t.zoneStarts=void 0,t.zoneLinesSVG=void 0,t}return d(r.prototype,{nameBase:"Volume by Price",nameComponents:["ranges"],calculateOn:{chart:"render",xAxis:"afterSetExtremes"},pointClass:t,markerAttribs:e,drawGraph:e,getColumnMetrics:y.getColumnMetrics,crispCol:y.crispCol}),i.registerSeriesType("vbp",r),r}),e(t,"masters/indicators/volume-by-price.src.js",[],function(){})});