!function(o){"object"==typeof module&&module.exports?module.exports=o.default=o:"function"==typeof define&&define.amd?define("highcharts/modules/geoheatmap",["highcharts"],function(t){return o(t),o.Highcharts=t,o}):o("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";t=t?t._modules:{};function o(t,o,e,i){t.hasOwnProperty(o)||(t[o]=i.apply(null,e),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:o,module:t[o]}})))}o(t,"Series/GeoHeatmap/GeoHeatmapPoint.js",[t["Core/Utilities.js"],t["Core/Series/SeriesRegistry.js"]],function(t,o){var i,a,e=this&&this.__extends||(i=function(t,o){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){if("function"!=typeof o&&null!==o)throw TypeError("Class extends value "+String(o)+" is not a constructor or null");function e(){this.constructor=t}i(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}),o=o.seriesTypes.map.prototype.pointClass,r=t.isNumber;return e(n,a=o),n.prototype.applyOptions=function(t,o){var e,i,t=a.prototype.applyOptions.call(this,t,o),o=t.options,n=o.lat,o=o.lon;return r(o)&&r(n)&&(e=(i=this.series.options).colsize,i=i.rowsize,t.geometry=t.options.geometry={type:"Polygon",coordinates:[[[e=o-(o=void 0===e?1:e)/2,i=n-(n=void 0===i?1:i)/2],[e+o,i],[e+o,i+n],[e,i+n],[e,i]]]}),t},n;function n(){var t=null!==a&&a.apply(this,arguments)||this;return t.lat=void 0,t.lon=void 0,t.options=void 0,t.series=void 0,t}}),o(t,"Series/InterpolationUtilities.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(t,o){var i=t.doc,n=o.defined,a=o.pick;return{colorFromPoint:function(t,o){var e=o.series.colorAxis;return e?((e=e.toColor(t||0,o).split(")")[0].split("(")[1].split(",").map(function(t){return a(parseFloat(t),parseInt(t,10))}))[3]=255*a(e[3],1),n(t)&&o.visible||(e[3]=0),e):[0,0,0,0]},getContext:function(t){var o=t.canvas,e=t.context;return o&&e?(e.clearRect(0,0,o.width,o.height),e):(t.canvas=i.createElement("canvas"),t.context=t.canvas.getContext("2d",{willReadFrequently:!0})||void 0,t.context)}}}),o(t,"Series/GeoHeatmap/GeoHeatmapSeries.js",[t["Core/Animation/AnimationUtilities.js"],t["Series/GeoHeatmap/GeoHeatmapPoint.js"],t["Core/Globals.js"],t["Series/InterpolationUtilities.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,o,e,i,n,a){var r,s=this&&this.__extends||(r=function(t,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(t,o)},function(t,o){if("function"!=typeof o&&null!==o)throw TypeError("Class extends value "+String(o)+" is not a constructor or null");function e(){this.constructor=t}r(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}),O=t.animObject,P=t.stop,t=e.noop,I=i.colorFromPoint,U=i.getContext,e=n.seriesTypes.map,i=a.addEvent,p=a.extend,T=a.isNumber,l=a.isObject,A=a.merge,S=a.pick;function g(t){return t-360*Math.floor((t+180)/360)}s(h,L=e),h.prototype.update=function(){this.options=A(this.options,arguments[0]),this.getInterpolation().enabled&&(this.isDirtyCanvas=!0,this.points.forEach(function(t){t.graphic&&(t.graphic.destroy(),delete t.graphic)})),L.prototype.update.apply(this,arguments)},h.prototype.translate=function(){this.getInterpolation().enabled&&this.image&&!this.isDirty&&!this.isDirtyData||L.prototype.translate.apply(this,arguments)},h.prototype.getInterpolation=function(){return l(this.options.interpolation)?this.options.interpolation:{blur:1,enabled:this.options.interpolation}},h.prototype.drawPoints=function(){var t=this.chart.mapView,o=this.options;if(this.getInterpolation().enabled&&t&&this.bounds){var e=this.context||U(this),i=this.canvas,n=this.colorAxis,a=this.image,r=this.chart,s=this.points,o=[S(o.colsize,1),S(o.rowsize,1)],p=o[0],l=o[1],o=t.projectedUnitsToPixels({x:this.bounds.x1,y:this.bounds.y2}),h=t.projectedUnitsToPixels({x:this.bounds.x2,y:this.bounds.y1});if(i&&e&&n&&o&&h){var c,d,u,y,g,f={x:o.x,y:o.y,width:h.x-o.x,height:h.y-o.y};if(this.isDirtyCanvas||this.isDirtyData||"Orthographic"===t.projection.options.name){this.isDirtyCanvas=!0;var m=i.width=1+~~(360/p),v=i.height=1+~~(180/l),b=new Uint8ClampedArray(4*(m*v));this.directTouch=!1;for(var x=0;x<s.length;x++){var w=s[x],C=new Uint8ClampedArray(I(w.value,w)),w=w.options,j=w.lon,w=w.lat;T(j)&&T(w)&&b.set(C,4*Math.ceil(m*(v-1-(w+90)/l)+(j+180)/p))}var n=this.getInterpolation().blur,h=0===n?1:11*n,o=~~(m*h),n=~~(v*h),h=~~f.width,D=~~f.height,_=new ImageData(b,m,v),o=(i.width=o,i.height=n,e.putImageData(_,0,0),e.globalCompositeOperation="copy",e.drawImage(i,0,0,_.width,_.height,0,0,i.width,i.height),e.getImageData(0,0,i.width,i.height)),n=this.getProjectedImageData(t,h,D,o,i,f.x,f.y),_=new ImageData(n,h,D);e.globalCompositeOperation="copy",i.width=h,i.height=D,e.putImageData(_,0,0)}a?r.renderer.globalAnimation&&r.hasRendered?(c=Number(a.attr("x")),d=Number(a.attr("y")),u=Number(a.attr("width")),y=Number(a.attr("height")),t=A(O(r.renderer.globalAnimation)),g=t.step,t.step=function(){g&&g.apply(this,arguments),function(t,o){a.attr({x:c+(f.x-c)*o.pos,y:d+(f.y-d)*o.pos,width:u+(f.width-u)*o.pos,height:y+(f.height-y)*o.pos})}.apply(this,arguments)},a.attr(A({animator:0},this.isDirtyCanvas?{href:i.toDataURL("image/png",1)}:void 0)).animate({animator:1},t)):(P(a),a.attr(A(f,this.isDirtyCanvas?{href:i.toDataURL("image/png",1)}:void 0))):this.image=r.renderer.image(i.toDataURL("image/png",1)).attr(f).add(this.group),this.isDirtyCanvas=!1}}else L.prototype.drawPoints.apply(this,arguments)},h.prototype.getProjectedImageData=function(t,o,e,i,n,a,r){for(var s=new Uint8ClampedArray(o*e*4),p=S(null==(e=t.projection.options.rotation)?void 0:e[0],0),l=n.width/360,h=-1*n.height/180,c=-1,d=0;d<s.length;d+=4){var u,y=d/4%o,y=(0==y&&c++,t.pixelsToLonLat({x:a+y,y:r+c}));y&&(y.lon>-180-p&&y.lon<180-p&&(y.lon=g(y.lon)),u=(y=[y.lon,y.lat])[0]*l+n.width/2,y=y[1]*h+n.height/2,0<=u&&u<=n.width&&0<=y&&y<=n.height&&(y=Math.floor(y)*n.width*4+4*Math.round(u),s[d]=i.data[y],s[d+1]=i.data[1+y],s[d+2]=i.data[2+y],s[d+3]=i.data[3+y]))}return s},h.prototype.searchPoint=function(t,o){var e=this.chart,i=e.mapView;if(i&&this.bounds&&this.image&&e.tooltip&&e.tooltip.options.enabled)if(!1===e.pointer.hasDragged&&(+this.image.attr("animator")<=.01||.99<=+this.image.attr("animator"))){var n=i.projectedUnitsToPixels({x:this.bounds.x1,y:this.bounds.y2}),i=i.projectedUnitsToPixels({x:this.bounds.x2,y:this.bounds.y1});if(e.pointer.normalize(t),t.lon&&t.lat&&n&&i&&t.chartX-e.plotLeft>n.x&&t.chartX-e.plotLeft<i.x&&t.chartY-e.plotTop>n.y&&t.chartY-e.plotTop<i.y)return this.searchKDTree({clientX:t.chartX,lon:g(t.lon),lat:t.lat},o,t)}else e.tooltip.destroy()},h.defaultOptions=A(e.defaultOptions,{nullColor:"transparent",tooltip:{pointFormat:"Lat: {point.lat}, Lon: {point.lon}, Value: {point.value}<br/>"},borderWidth:0,colsize:1,rowsize:1,stickyTracking:!0,interpolation:{enabled:!1,blur:1}});var L,a=h;function h(){var t=null!==L&&L.apply(this,arguments)||this;return t.options=void 0,t.data=void 0,t.points=void 0,t.canvas=void 0,t.context=void 0,t.isDirtyCanvas=!0,t}return i(a,"afterDataClassLegendClick",function(){this.isDirtyCanvas=!0,this.drawPoints()}),p(a.prototype,{type:"geoheatmap",applyJitter:t,pointClass:o,pointArrayMap:["lon","lat","value"],kdAxisArray:["lon","lat"]}),n.registerSeriesType("geoheatmap",a),a}),o(t,"masters/modules/geoheatmap.src.js",[],function(){})});