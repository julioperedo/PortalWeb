!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";t=t?t._modules:{};function e(t,e,o,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t,"Data/Modifiers/DataModifier.js",[t["Core/Utilities.js"]],function(t){var o,r=t.addEvent,e=t.fireEvent,a=t.merge,t=(n.prototype.benchmark=function(t,e){function o(){n.modifyTable(t),n.emit({type:"afterBenchmarkIteration"})}var r=[],n=this,i=a({iterations:1},e).iterations,s=(n.on("afterBenchmarkIteration",function(){r.length===i?n.emit({type:"afterBenchmark",results:r}):o()}),{startTime:0,endTime:0});return n.on("modify",function(){s.startTime=window.performance.now()}),n.on("afterModify",function(){s.endTime=window.performance.now(),r.push(s.endTime-s.startTime)}),o(),r},n.prototype.emit=function(t){e(this,t.type,t)},n.prototype.modify=function(o,r){var n=this;return new Promise(function(t,e){o.modified===o&&(o.modified=o.clone(!1,r));try{t(n.modifyTable(o,r))}catch(t){n.emit({type:"error",detail:r,table:o}),e(t)}})},n.prototype.modifyCell=function(t,e,o,r,n){return this.modifyTable(t)},n.prototype.modifyColumns=function(t,e,o,r){return this.modifyTable(t)},n.prototype.modifyRows=function(t,e,o,r){return this.modifyTable(t)},n.prototype.on=function(t,e){return r(this,t,e)},n);function n(){}return(o=t=n||{}).types={},o.registerType=function(t,e){return!!t&&!o.types[t]&&!!(o.types[t]=e)},t}),e(t,"Data/DataTable.js",[t["Core/Utilities.js"]],function(t){var o=t.addEvent,e=t.fireEvent,m=t.uniqueKey;function v(t){this.aliases=(t=void 0===t?{}:t).aliases?JSON.parse(JSON.stringify(t.aliases)):{},this.autoId=!t.id,this.columns={},this.id=t.id||m(),(this.modified=this).rowCount=0,this.versionTag=m();for(var e,o,r=t.columns||{},n=Object.keys(r),i=this.columns,s=0,a=0,u=n.length;a<u;++a)e=r[o=n[a]].slice(),i[o]=e,s=Math.max(s,e.length);for(a=0,u=n.length;a<u;++a)i[n[a]].length=s;this.rowCount=s;for(var l,c=t.aliases||{},f=Object.keys(c),p=this.aliases,a=0,u=f.length;a<u;++a)p[l=f[a]]=c[l]}return v.isNull=function(t){if(t===v.NULL)return!0;if(t instanceof Array){if(!t.length)return!1;for(var e=0,o=t.length;e<o;++e)if(null!==t[e])return!1}else{var r=Object.keys(t);if(!r.length)return!1;for(e=0,o=r.length;e<o;++e)if(null!==t[r[e]])return!1}return!0},v.prototype.clone=function(t,e){var o=this,r={},r=(o.emit({type:"cloneTable",detail:e}),t||(r.aliases=o.aliases,r.columns=o.columns),o.autoId||(r.id=o.id),new v(r));return t||(r.versionTag=o.versionTag),o.emit({type:"afterCloneTable",detail:e,tableClone:r}),r},v.prototype.deleteColumnAlias=function(t){var e=this,o=e.aliases[t],r=e.modifier;return o&&(delete e.aliases[t],r&&r.modifyColumns(e,((t={})[o]=new Array(e.rowCount),t),0)),o},v.prototype.deleteColumns=function(t,e){var o=this,r=o.columns,n={},i={},s=o.modifier,a=o.rowCount;if((t=t||Object.keys(r)).length){o.emit({type:"deleteColumns",columnNames:t,detail:e});for(var u,l,c=0,f=t.length;c<f;++c)(u=r[l=t[c]])&&(n[l]=u,i[l]=new Array(a)),delete r[l];return Object.keys(r).length||(o.rowCount=0),s&&s.modifyColumns(o,i,0,e),o.emit({type:"afterDeleteColumns",columns:n,columnNames:t,detail:e}),n}},v.prototype.deleteRows=function(t,e,o){var r=this,n=[],i=[],s=r.modifier;if(r.emit({type:"deleteRows",detail:o,rowCount:e=void 0===e?1:e,rowIndex:t||0}),void 0===t&&(t=0,e=r.rowCount),0<e&&t<r.rowCount)for(var a,u=r.columns,l=Object.keys(u),c=0,f=l.length,p=void 0;c<f;++c){a=(p=u[l[c]]).splice(t,e),c||(r.rowCount=p.length);for(var m=0,h=a.length;m<h;++m)n[m]=n[m]||[],n[m][c]=a[m];i.push(new Array(f))}return s&&s.modifyRows(r,i,t||0,o),r.emit({type:"afterDeleteRows",detail:o,rowCount:e,rowIndex:t||0,rows:n}),n},v.prototype.emit=function(t){switch(t.type){case"afterDeleteColumns":case"afterDeleteRows":case"afterSetCell":case"afterSetColumns":case"afterSetRows":this.versionTag=m()}e(this,t.type,t)},v.prototype.getCell=function(t,e){t=this.aliases[t]||t;t=this.columns[t];if(t)return t[e]},v.prototype.getCellAsBoolean=function(t,e){t=this.aliases[t]||t;t=this.columns[t];return!(!t||!t[e])},v.prototype.getCellAsNumber=function(t,e,o){t=this.aliases[t]||t;var t=this.columns[t],r=t&&t[e];switch(typeof r){case"boolean":return r?1:0;case"number":return isNaN(r)&&!o?null:r}return r=parseFloat("".concat(r)),isNaN(r)&&!o?null:r},v.prototype.getCellAsString=function(t,e){t=this.aliases[t]||t;t=this.columns[t];return"".concat(t&&t[e])},v.prototype.getColumn=function(t,e){return this.getColumns([t],e)[t]},v.prototype.getColumnAsNumbers=function(t,e){var o=this.columns[t=this.aliases[t]||t],r=[];if(o){var n=o.length;if(e)for(var i=0;i<n;++i)r.push(this.getCellAsNumber(t,i,!0));else{for(var s,i=0;i<n;++i){if("number"==typeof(s=o[i]))return o.slice();if(null!=s)break}for(i=0;i<n;++i)r.push(this.getCellAsNumber(t,i))}}return r},v.prototype.getColumnNames=function(){return Object.keys(this.columns)},v.prototype.getColumns=function(t,e){for(var o,r=this.aliases,n=this.columns,i={},s=0,a=(t=t||Object.keys(n)).length,u=void 0;s<a;++s)(u=n[r[o=t[s]]||o])&&(i[o]=e?u:u.slice());return i},v.prototype.getModifier=function(){return this.modifier},v.prototype.getRow=function(t,e){return this.getRows(t,1,e)[0]},v.prototype.getRowCount=function(){return this.rowCount},v.prototype.getRowIndexBy=function(t,e,o){t=this.aliases[t]||t;t=this.columns[t];if(t){t=t.indexOf(e,o);if(-1!==t)return t}},v.prototype.getRowObject=function(t,e){return this.getRowObjects(t,1,e)[0]},v.prototype.getRowObjects=function(t,e,o){void 0===t&&(t=0),void 0===e&&(e=this.rowCount-t);var r=this.aliases,n=this.columns,i=new Array(e);o=o||Object.keys(n);for(var s=t,a=0,u=Math.min(this.rowCount,t+e),l=void 0;s<u;++s,++a)for(var l=i[a]={},c=0,f=o;c<f.length;c++){var p=f[c],m=n[r[p]||p];l[p]=m?m[s]:void 0}return i},v.prototype.getRows=function(t,e,o){void 0===t&&(t=0),void 0===e&&(e=this.rowCount-t);var r=this.aliases,n=this.columns,i=new Array(e);o=o||Object.keys(n);for(var s=t,a=0,u=Math.min(this.rowCount,t+e),l=void 0;s<u;++s,++a)for(var l=i[a]=[],c=0,f=o;c<f.length;c++){var p=f[c],p=n[r[p]||p];l.push(p?p[s]:void 0)}return i},v.prototype.getVersionTag=function(){return this.versionTag},v.prototype.hasColumns=function(t){for(var e,o=this.aliases,r=this.columns,n=0,i=t.length;n<i;++n)if(!r[e=t[n]]&&!o[e])return!1;return!0},v.prototype.hasRowWith=function(t,e){t=this.aliases[t]||t;t=this.columns[t];return!!t&&-1!==t.indexOf(e)},v.prototype.on=function(t,e){return o(this,t,e)},v.prototype.renameColumn=function(t,e){var o,r=this.columns;return!!r[t]&&(t!==e&&((o=this.aliases)[e]&&delete o[e],r[e]=r[t],delete r[t]),!0)},v.prototype.setCell=function(t,e,o,r){var n=this,i=n.columns,s=n.modifier,a=i[t=n.aliases[t]||t];a&&a[e]===o||(n.emit({type:"setCell",cellValue:o,columnName:t,detail:r,rowIndex:e}),a=a||(i[t]=new Array(n.rowCount)),e>=n.rowCount&&(n.rowCount=e+1),a[e]=o,s&&s.modifyCell(n,t,e,o),n.emit({type:"afterSetCell",cellValue:o,columnName:t,detail:r,rowIndex:e}))},v.prototype.setColumn=function(t,e,o,r){var n;void 0===o&&(o=0),this.setColumns(((n={})[t]=e=void 0===e?[]:e,n),o,r)},v.prototype.setColumns=function(t,e,o){var r=this,n=r.columns,i=r.modifier,s=(r.rowCount,void 0===e),a=Object.keys(t);r.emit({type:"setColumns",columns:t,columnNames:a,detail:o,rowIndex:e});for(var u=0,l=a.length,c=void 0,f=void 0;u<l;++u)if(c=t[f=a[u]],f=r.aliases[f]||f,s)n[f]=c.slice(),r.rowCount=c.length;else{for(var p=n[f]||(n[f]=new Array(r.rowCount)),m=e||0,h=c.length;m<h;++m)p[m]=c[m];r.rowCount=Math.max(r.rowCount,p.length)}for(var d=Object.keys(n),u=0,l=d.length;u<l;++u)n[d[u]].length=r.rowCount;i&&i.modifyColumns(r,t,e||0),r.emit({type:"afterSetColumns",columns:t,columnNames:a,detail:o,rowIndex:e})},v.prototype.setModifier=function(e,o){var r=this;return r.emit({type:"setModifier",detail:o,modifier:e,modified:r.modified}),(((r.modified=r).modifier=e)?e.modify(r):Promise.resolve(r)).then(function(t){return t.emit({type:"afterSetModifier",detail:o,modifier:e,modified:t.modified}),t}).catch(function(t){throw r.emit({type:"setModifierError",error:t,modifier:e,modified:r.modified}),t})},v.prototype.setRow=function(t,e,o){this.setRows([t],e,o)},v.prototype.setRows=function(t,e,o){void 0===e&&(e=this.rowCount);var r=this,n=r.aliases,i=r.columns,s=Object.keys(i),a=r.modifier,u=t.length;r.emit({type:"setRows",detail:o,rowCount:u,rowIndex:e,rows:t});for(var l,c=0,f=e;c<u;++c,++f)if((l=t[c])===v.NULL)for(var p=0,m=s.length;p<m;++p)i[s[p]][f]=null;else if(l instanceof Array)for(p=0,m=s.length;p<m;++p)i[s[p]][f]=l[p];else for(var h=Object.keys(l),p=0,m=h.length,d=void 0;p<m;++p)i[d=n[d=h[p]]||d]||(i[d]=new Array(f+1)),i[d][f]=l[d];var g=e+u;if(g>r.rowCount){r.rowCount=g;for(var c=0,y=s.length;c<y;++c)i[s[c]].length=g}a&&a.modifyRows(r,t,e),r.emit({type:"afterSetRows",detail:o,rowCount:u,rowIndex:e,rows:t})},v.NULL={},v.version="1.0.0",v}),e(t,"Data/Connectors/DataConnector.js",[t["Data/Modifiers/DataModifier.js"],t["Data/DataTable.js"],t["Core/Utilities.js"]],function(r,e,t){var o,n=t.addEvent,i=t.fireEvent,s=t.merge,a=t.pick,t=(Object.defineProperty(u.prototype,"polling",{get:function(){return!!this.polling},enumerable:!1,configurable:!0}),u.prototype.describeColumn=function(t,e){var o=this.metadata.columns;o[t]=s(o[t]||{},e)},u.prototype.describeColumns=function(t){for(var e,o=Object.keys(t);"string"==typeof(e=o.pop());)this.describeColumn(e,t[e])},u.prototype.emit=function(t){i(this,t.type,t)},u.prototype.getColumnOrder=function(t){var o=this.metadata.columns,e=Object.keys(o||{});if(e.length)return e.sort(function(t,e){return a(o[t].index,0)-a(o[e].index,0)})},u.prototype.getSortedColumns=function(t){return this.table.getColumns(this.getColumnOrder(t))},u.prototype.load=function(){return i(this,"afterLoad",{table:this.table}),Promise.resolve(this)},u.prototype.on=function(t,e){return n(this,t,e)},u.prototype.save=function(){return i(this,"saveError",{table:this.table}),Promise.reject(new Error("Not implemented"))},u.prototype.setColumnOrder=function(t){for(var e=0,o=t.length;e<o;++e)this.describeColumn(t[e],{index:e})},u.prototype.setModifierOptions=function(t){var e=this,o=t&&r.types[t.type];return this.table.setModifier(o?new o(t):void 0).then(function(){return e})},u.prototype.startPolling=function(t){void 0===t&&(t=1e3);var e=this;window.clearTimeout(e._polling),e._polling=window.setTimeout(function(){return e.load().catch(function(t){return e.emit({type:"loadError",error:t,table:e.table})}).then(function(){e._polling&&e.startPolling(t)})},t)},u.prototype.stopPolling=function(){window.clearTimeout(this._polling),delete this._polling},u.prototype.whatIs=function(t){return this.metadata.columns[t]},u);function u(t){this.table=new e((t=void 0===t?{}:t).dataTable),this.metadata=t.metadata||{columns:{}}}return(o=t=u||{}).types={},o.registerType=function(t,e){return!!t&&!o.types[t]&&!!(o.types[t]=e)},t}),e(t,"Data/Converters/DataConverter.js",[t["Data/DataTable.js"],t["Core/Utilities.js"]],function(i,t){var o=t.addEvent,e=t.fireEvent,l=t.isNumber,r=t.merge,t=(n.prototype.asBoolean=function(t){return"boolean"==typeof t?t:"string"==typeof t?""!==t&&"0"!==t&&"false"!==t:!!this.asNumber(t)},n.prototype.asDate=function(t){var e;if("string"==typeof t)e=this.parseDate(t);else if("number"==typeof t)e=t;else{if(t instanceof Date)return t;e=this.parseDate(this.asString(t))}return new Date(e)},n.prototype.asGuessedType=function(t){var e=this;return{number:e.asNumber,Date:e.asDate,string:e.asString}[e.guessType(t)].call(e,t)},n.prototype.asNumber=function(t){if("number"==typeof t)return t;if("boolean"==typeof t)return t?1:0;if("string"!=typeof t)return t instanceof Date?t.getDate():t?t.getRowCount():NaN;var e=this.decimalRegExp;if(-1<t.indexOf(" ")&&(t=t.replace(/\s+/g,"")),e){if(!e.test(t))return NaN;t=t.replace(e,"$1.$2")}return parseFloat(t)},n.prototype.asString=function(t){return""+t},n.prototype.deduceDateFormat=function(t,e,o){var r,n,i,s=[],a=[],u="YYYY/mm/dd",l=[],c=0,f=!1;for((!e||e>t.length)&&(e=t.length);c<e;c++)if(void 0!==t[c]&&t[c]&&t[c].length)for(r=t[c].trim().replace(/[-\.\/]/g," ").split(" "),l=["","",""],i=0;i<r.length;i++)i<l.length&&(n=parseInt(r[i],10))&&(a[i]=!a[i]||a[i]<n?n:a[i],void 0!==s[i]?s[i]!==n&&(s[i]=!1):s[i]=n,31<n?l[i]=n<100?"YY":"YYYY":12<n&&n<=31?(l[i]="dd",f=!0):l[i].length||(l[i]="mm"));if(f){for(i=0;i<s.length;i++)!1!==s[i]?12<a[i]&&"YY"!==l[i]&&"YYYY"!==l[i]&&(l[i]="YY"):12<a[i]&&"mm"===l[i]&&(l[i]="dd");3===l.length&&"dd"===l[1]&&"dd"===l[2]&&(l[2]="YY"),u=l.join("/")}return o&&(this.options.dateFormat=u),u},n.prototype.emit=function(t){e(this,t.type,t)},n.prototype.export=function(t,e){throw this.emit({type:"exportError",columns:[],headers:[]}),new Error("Not implemented")},n.prototype.getTable=function(){throw new Error("Not implemented")},n.prototype.guessType=function(t){var e,o,r="string";return"string"==typeof t&&(o=this.trim("".concat(t)),e=this.decimalRegExp,o=this.trim(o,!0),+(o=e?e.test(o)?o.replace(e,"$1.$2"):"":o)===(e=parseFloat(o))?t=e:(o=this.parseDate(t),r=l(o)?"Date":"string")),r="number"==typeof t?31536e6<t?"Date":"number":r},n.prototype.on=function(t,e){return o(this,t,e)},n.prototype.parse=function(t){throw this.emit({type:"parseError",columns:[],headers:[]}),new Error("Not implemented")},n.prototype.parseDate=function(t,e){var o,r,n,i=this,s=i.options,a=e||s.dateFormat,u=NaN;if(s.parseDate)u=s.parseDate(t);else{if(a)r=(r=i.dateFormats[a])||i.dateFormats["YYYY/mm/dd"],(n=t.match(r.regex))&&(u=r.parser(n));else for(o in i.dateFormats)if(r=i.dateFormats[o],n=t.match(r.regex)){a=o,u=r.parser(n);break}n||("object"==typeof(n=Date.parse(t))&&null!==n&&n.getTime?u=n.getTime()-6e4*n.getTimezoneOffset():l(n)&&(u=n-6e4*new Date(n).getTimezoneOffset(),-1===t.indexOf("2001")&&2001===new Date(u).getFullYear()&&(u=NaN)))}return u},n.prototype.trim=function(t,e){return"string"==typeof t&&(t=t.replace(/^\s+|\s+$/g,""),e&&/^[0-9\s]+$/.test(t)&&(t=t.replace(/\s/g,""))),t},n.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},n);function n(t){this.dateFormats={"YYYY/mm/dd":{regex:/^([0-9]{4})([\-\.\/])([0-9]{1,2})\2([0-9]{1,2})$/,parser:function(t){return t?Date.UTC(+t[1],t[3]-1,+t[4]):NaN}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(t){return t?Date.UTC(+t[4],t[3]-1,+t[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(t){return t?Date.UTC(+t[4],t[1]-1,+t[3]):NaN}},"dd/mm/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(t){var e=new Date;if(!t)return NaN;var o=+t[4];return o>e.getFullYear()-2e3?o+=1900:o+=2e3,Date.UTC(o,t[3]-1,+t[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(t){return t?Date.UTC(+t[4]+2e3,t[1]-1,+t[3]):NaN}}};var t=r(n.defaultOptions,t),e=t.decimalPoint;"."!==e&&","!==e||(e="."===e?"\\.":",",this.decimalRegExp=new RegExp("^(-?[0-9]+)"+e+"([0-9]+)$")),this.options=t}return(n||(t={})).getTableFromColumns=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]);for(var o=new i,r=0,n=Math.max(e.length,t.length);r<n;++r)o.setColumn(e[r]||"".concat(r),t[r]);return o},t}),e(t,"Data/DataCursor.js",[],function(){p.prototype.addListener=function(t,e,o){t=this.listenerMap[t]=this.listenerMap[t]||{};return(t[e]=t[e]||[]).push(o),this},p.prototype.buildEmittingTag=function(t){return("position"===t.cursor.type?[t.table.id,t.cursor.column,t.cursor.row,t.cursor.state,t.cursor.type]:[t.table.id,t.cursor.columns,t.cursor.firstRow,t.cursor.lastRow,t.cursor.state,t.cursor.type]).join("\0")},p.prototype.emitCursor=function(t,e,o,r,n){var i="object"==typeof e?e:o,o="object"==typeof r?r:o,e="string"==typeof e?e:void 0,s=t.id,a=i.state,u=this.listenerMap[s]&&this.listenerMap[s][a];if(n=n||!0===r,u){var a=this.stateMap[s]=this.stateMap[s]||{},r=a[i.state]||[],l=(n&&(r.length||(a[i.state]=r),-1===p.getIndex(i,r)&&r.push(i)),{cursor:i,cursors:r,table:t}),s=(o&&(l.event=o),e&&(l.group=e),this.emittingRegister),n=this.buildEmittingTag(l);if(0<=s.indexOf(n))return this;try{this.emittingRegister.push(n);for(var c=0,f=u.length;c<f;++c)u[c].call(this,l)}finally{a=this.emittingRegister.indexOf(n);0<=a&&this.emittingRegister.splice(a,1)}}return this},p.prototype.remitCursor=function(t,e){t=this.stateMap[t]&&this.stateMap[t][e.state];return t&&0<=(e=p.getIndex(e,t))&&t.splice(e,1),this},p.prototype.removeListener=function(t,e,o){t=this.listenerMap[t]&&this.listenerMap[t][e];return t&&(e=t.indexOf(o))&&t.splice(e,1),this},p.version="1.0.0";var t,e=p;function p(t){void 0===t&&(t={}),this.emittingRegister=[],this.listenerMap={},this.stateMap=t}function n(t,e){var o;if("range"===t.type)return t;e={type:"range",firstRow:null!=(o=null!=(o=t.row)?o:e&&e.firstRow)?o:0,lastRow:null!=(o=null!=(o=t.row)?o:e&&e.lastRow)?o:Number.MAX_VALUE,state:t.state};return void 0!==t.column&&(e.columns=[t.column]),e}return(t=e=p||{}).getIndex=function(t,e){if("position"===t.type){for(var o=void 0,r=0,n=e.length;r<n;++r)if("position"===(o=e[r]).type&&o.state===t.state&&o.column===t.column&&o.row===t.row)return r}else for(var i=JSON.stringify(t.columns),o=void 0,r=0,n=e.length;r<n;++r)if("range"===(o=e[r]).type&&o.state===t.state&&o.firstRow===t.firstRow&&o.lastRow===t.lastRow&&JSON.stringify(o.columns)===i)return r;return-1},t.isEqual=function(t,e){return"position"===t.type&&"position"===e.type?t.column===e.column&&t.row===e.row&&t.state===e.state:"range"===t.type&&"range"===e.type&&(t.firstRow===e.firstRow&&t.lastRow===e.lastRow&&JSON.stringify(t.columns)===JSON.stringify(e.columns))},t.isInRange=function(t,e){"position"===e.type&&(e=n(e));var o=(t="position"===t.type?n(t,e):t).columns,r=e.columns;return t.firstRow>=e.firstRow&&t.lastRow<=e.lastRow&&(!o||!r||o.every(function(t){return 0<=r.indexOf(t)}))},t.toPositions=function(t){if("position"===t.type)return[t];for(var e=t.columns||[],o=[],r=t.state,n=t.firstRow,i=t.lastRow;n<i;++n)if(e.length)for(var s=0,a=e.length;s<a;++s)o.push({type:"position",column:e[s],row:n,state:r});else o.push({type:"position",row:n,state:r});return o},t.toRange=n,e}),e(t,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}}),e(t,"Data/DataPool.js",[t["Data/Connectors/DataConnector.js"],t["Data/DataPoolDefaults.js"],t["Core/Utilities.js"]],function(i,e,o){function t(t){(t=void 0===t?e:t).connectors=t.connectors||[],this.connectors={},this.options=t,this.waiting={}}return t.prototype.emit=function(t){o.fireEvent(this,t.type,t)},t.prototype.getConnector=function(r){var n=this,t=this.connectors[r];if(t)return Promise.resolve(t);if(!(i=this.waiting[r])){var i=this.waiting[r]=[],t=this.getConnectorOptions(r);if(!t)throw new Error("Connector not found. (".concat(r,")"));this.loadConnector(t).then(function(t){delete n.waiting[r];for(var e=0,o=i.length;e<o;++e)i[e][0](t)}).catch(function(t){delete n.waiting[r];for(var e=0,o=i.length;e<o;++e)i[e][1](t)})}return new Promise(function(t,e){i.push([t,e])})},t.prototype.getConnectorIds=function(){for(var t=this.options.connectors,e=[],o=0,r=t.length;o<r;++o)e.push(t[o].id);return e},t.prototype.getConnectorOptions=function(t){for(var e=this.options.connectors,o=0,r=e.length;o<r;++o)if(e[o].id===t)return e[o]},t.prototype.getConnectorTable=function(t){return this.getConnector(t).then(function(t){return t.table})},t.prototype.loadConnector=function(r){var n=this;return new Promise(function(e,t){n.emit({type:"load",options:r});var o=i.types[r.type];if(!o)throw new Error("Connector type not found. (".concat(r.type,")"));new o(r.options).load().then(function(t){n.connectors[r.id]=t,n.emit({type:"afterLoad",options:r}),e(t)}).catch(t)})},t.prototype.on=function(t,e){return o.addEvent(this,t,e)},t.prototype.setConnectorOptions=function(t){var e=this.options.connectors;this.emit({type:"setConnectorOptions",options:t});for(var o=0,r=e.length;o<r;++o)if(e[o].id===t.id){e.splice(o,1);break}e.push(t),this.emit({type:"afterSetConnectorOptions",options:t})},t.version="1.0.0",t}),e(t,"Data/Formula/FormulaParser.js",[],function(){var f=/^(?:FALSE|TRUE)/,p=/^[+-]?\d+(?:\.\d+)?(?:e[+-]\d+)?/,m=/^[+-]?\d+(?:,\d+)?(?:e[+-]\d+)?/,h=/^([A-Z][A-Z\d\.]*)\(/,d=/^(?:[+\-*\/^<=>]|<=|=>)/,u=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,l=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,g=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,y=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function v(t){for(var e,o,r=0,n=0,i=t.length,s=1;n<i;++n)if("("===(e=t[n]))r||(s=n+1),++r;else if(")"===e&&!--r)return t.substring(s,n);if(0<r)throw(o=new Error("Incomplete parantheses.")).name="FormulaParseError",o;return""}function b(t){for(var e,o=-1,r=0,n=t.length,i=!1;r<n;++r)if("\\"===(e=t[r]))i=!i;else if(i)i=!1;else if('"'===e){if(!(o<0))return t.substring(o+1,r);o=r}var s=new Error("Incomplete string.");throw s.name="FormulaParseError",s}function C(t,e){var o,r,n,i,s,a=t.match(l);if(a)return o=""===a[2]||"["===a[2][0],r=""===a[1]||"["===a[1][0],n=""===a[4]||"["===a[4][0],i=""===a[3]||"["===a[3][0],s={type:"range",beginColumn:o?parseInt(a[2].substring(1,-1)||"0",10):parseInt(a[2],10)-1,beginRow:r?parseInt(a[1].substring(1,-1)||"0",10):parseInt(a[1],10)-1,endColumn:n?parseInt(a[4].substring(1,-1)||"0",10):parseInt(a[4],10)-1,endRow:i?parseInt(a[3].substring(1,-1)||"0",10):parseInt(a[3],10)-1},o&&(s.beginColumnRelative=!0),r&&(s.beginRowRelative=!0),n&&(s.endColumnRelative=!0),i&&(s.endRowRelative=!0),s;if(a=t.match(u))return o="$"!==a[1][0],r="$"!==a[2][0],n="$"!==a[3][0],i="$"!==a[4][0],s={type:"range",beginColumn:j(o?a[1]:a[1].substring(1))-1,beginRow:parseInt(r?a[2]:a[2].substring(1),10)-1,endColumn:j(n?a[3]:a[3].substring(1))-1,endRow:parseInt(i?a[4]:a[4].substring(1),10)-1},o&&(s.beginColumnRelative=!0),r&&(s.beginRowRelative=!0),n&&(s.endColumnRelative=!0),i&&(s.endRowRelative=!0),s;a=w(t,e);return 1===a.length&&"string"!=typeof a[0]?a[0]:a}function w(t,e){for(var o,r=e?m:p,n=[],i=("="===t[0]?t.substring(1):t).trim();i;)if(o=i.match(y)){var s=""===o[2]||"["===o[2][0],a=""===o[1]||"["===o[1][0],u={type:"reference",column:s?parseInt(o[2].substring(1,-1)||"0",10):parseInt(o[2],10)-1,row:a?parseInt(o[1].substring(1,-1)||"0",10):parseInt(o[1],10)-1};s&&(u.columnRelative=!0),a&&(u.rowRelative=!0),n.push(u),i=i.substring(o[0].length).trim()}else if(o=i.match(g)){s="$"!==o[1][0],a="$"!==o[2][0],u={type:"reference",column:j(s?o[1]:o[1].substring(1))-1,row:parseInt(a?o[2]:o[2].substring(1),10)-1};s&&(u.columnRelative=!0),a&&(u.rowRelative=!0),n.push(u),i=i.substring(o[0].length).trim()}else if(o=i.match(d))n.push(o[0]),i=i.substring(o[0].length).trim();else if(o=i.match(f))n.push("TRUE"===o[0]),i=i.substring(o[0].length).trim();else if(o=i.match(r))n.push(parseFloat(o[0])),i=i.substring(o[0].length).trim();else if('"'===i[0]){var l=b(i);n.push(l.substring(1,-1)),i=i.substring(l.length+2).trim()}else{if(!(o=i.match(h))){if("("===i[0]){l=v(i);if(l){n.push(w(l,e)),i=i.substring(l.length+2).trim();continue}}var c=t.length-i.length,c=new Error("Unexpected character `"+t.substring(c,1+c)+"` at position "+(1+c)+". (`..."+t.substring(c-5,6+c)+"...`)");throw c.name="FormulaParseError",c}c=v(i=i.substring(o[1].length).trim());n.push({type:"function",name:o[1],args:function(t,e){for(var o,r=[],n=e?";":",",i=0,s="",a=0,u=t.length;a<u;++a)(o=t[a])===n&&!i&&s?(r.push(C(s,e)),s=""):'"'!==o||i||s?" "!==o&&(s+=o,"("===o?++i:")"===o&&--i):(o=b(t.substring(a)),r.push(o),a+=o.length+1);return!i&&s&&r.push(C(s,e)),r}(c,e)}),i=i.substring(c.length+2).trim()}return n}function j(t){for(var e,o=0,r=0,n=t.length,i=t.length-1;r<n;++r)65<=(e=t.charCodeAt(r))&&e<=90&&(o+=(e-64)*Math.pow(26,i)),--i;return o}return{parseFormula:w}}),e(t,"Data/Formula/FormulaTypes.js",[],function(){var e=["+","-","*","/","^","=","<","<=",">",">="];return{isFormula:function(t){return t instanceof Array},isFunction:function(t){return"object"==typeof t&&!(t instanceof Array)&&"function"===t.type},isOperator:function(t){return"string"==typeof t&&0<=e.indexOf(t)},isRange:function(t){return"object"==typeof t&&!(t instanceof Array)&&"range"===t.type},isReference:function(t){return"object"==typeof t&&!(t instanceof Array)&&"reference"===t.type},isValue:function(t){return"boolean"==typeof t||"number"==typeof t||"string"==typeof t}}}),e(t,"Data/Formula/FormulaProcessor.js",[t["Data/Formula/FormulaTypes.js"]],function(t){var l=t.isFormula,c=t.isFunction,f=t.isOperator,a=t.isRange,p=t.isReference,m=t.isValue,e=/ */,o=Number.MAX_VALUE/1.000000000001,r=Number.MAX_VALUE/1.000000000002,n=Number.MAX_VALUE,h={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},i={},s=/^[A-Z][A-Z\.]*$/;function u(t){switch(typeof t){case"boolean":return t?n:o;case"string":return r;case"number":return t;default:return NaN}}function d(t){return"string"==typeof t?t.toLowerCase().replace(e,"\0"):t}function g(t){switch(typeof t){case"boolean":return t?1:0;case"string":return parseFloat(t.replace(",","."));case"number":return t;default:return NaN}}function y(t,e,o){switch(t){case"=":return d(e)===d(o);case"<":return typeof e==typeof o?d(e)<d(o):u(e)<u(o);case"<=":return typeof e==typeof o?d(e)<=d(o):u(e)<=u(o);case">":return typeof e==typeof o?d(e)>d(o):u(e)>u(o);case">=":return typeof e==typeof o?d(e)>=d(o):u(e)>=u(o)}var r;switch(e=g(e),o=g(o),t){case"+":r=e+o;break;case"-":r=e-o;break;case"*":r=e*o;break;case"/":r=e/o;break;case"^":r=Math.pow(e,o);break;default:return NaN}return r%1?Math.round(1e9*r)/1e9:r}function v(t,e){return m(t)?t:a(t)?e&&b(t,e)||[]:c(t)?j(t,e):w(l(t)?t:[t],e)}function b(t,e){for(var o=e.getColumnNames().slice(t.beginColumn,t.endColumn+1),r=[],n=0,i=o.length,s=void 0;n<i;++n)for(var a=e.getColumn(o[n],!0)||[],u=t.beginRow,l=t.endRow+1;u<l;++u)"string"==typeof(s=a[u])&&"="===s[0]&&e!==e.modified&&(s=e.modified.getCell(o[n],u)),r.push(m(s)?s:NaN);return r}function C(t,e){var o,r=e.getColumnNames()[t.column];return r?"string"==typeof(o=e.getCell(r,t.row))&&"="===o[0]&&e!==e.modified?(e=e.modified.getCell(r,t.row),m(e)?e:NaN):m(o)?o:NaN:NaN}function w(t,e){for(var o,r,n=0,i=t.length,s=void 0,a=void 0;n<i;++n)if(r=t[n],f(r))s=r;else if(m(r)?a=r:l(r)?a=w(t,e):c(r)?(u=j(r,e),a=m(u)?u:NaN):p(r)&&(a=e&&C(r,e)),void 0!==a){if(void 0===o)o=s?y(s,0,a):a;else{if(!s)return NaN;var u=t[n+1];f(u)&&h[u]>h[s]&&(a=y(u,a,w(t.slice(n+2))),n=i),o=y(s,o,a)}a=s=void 0}return m(o)?o:NaN}function j(t,e){var o=i[t.name];if(o)try{return o(t.args,e)}catch(t){return NaN}o=new Error('Function "'.concat(t.name,'" not found.'));throw o.name="FormulaProcessError",o}return{asNumber:g,getArgumentValue:v,getArgumentsValues:function(t,e){for(var o=[],r=0,n=t.length;r<n;++r)o.push(v(t[r],e));return o},getRangeValues:b,getReferenceValue:C,processFormula:w,processorFunctions:i,registerProcessorFunction:function(t,e){return s.test(t)&&!i[t]&&!!(i[t]=e)},translateReferences:function t(e,o,r){void 0===o&&(o=0),void 0===r&&(r=0);for(var n=0,i=e.length,s=void 0;n<i;++n)(s=e[n])instanceof Array?t(s,o,r):c(s)?t(s.args,o,r):a(s)?(s.beginColumnRelative&&(s.beginColumn+=o),s.beginRowRelative&&(s.beginRow+=r),s.endColumnRelative&&(s.endColumn+=o),s.endRowRelative&&(s.endRow+=r)):p(s)&&(s.columnRelative&&(s.column+=o),s.rowRelative&&(s.row+=r));return e}}}),e(t,"Data/Formula/Functions/ABS.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var a=t.getArgumentValue;function e(t,e){var o=a(t[0],e);switch(typeof o){case"number":return Math.abs(o);case"object":for(var r,n=[],i=0,s=o.length;i<s;++i){if("number"!=typeof(r=o[i]))return NaN;n.push(Math.abs(r))}return n;default:return NaN}}return t.registerProcessorFunction("ABS",e),e}),e(t,"Data/Formula/Functions/AND.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var i=t.getArgumentValue;function s(t,e){for(var o,r=0,n=t.length;r<n;++r)if(!(o=i(t[r],e))||"object"==typeof o&&!s(o,e))return!1;return!0}return t.registerProcessorFunction("AND",s),s}),e(t,"Data/Formula/Functions/AVERAGE.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var f=t.getArgumentsValues;function e(t,e){for(var o,r=f(t,e),n=0,i=0,s=0,a=r.length;s<a;++s)switch(typeof(o=r[s])){case"number":isNaN(o)||(++n,i+=o);break;case"object":for(var u,l=0,c=o.length;l<c;++l)"number"!=typeof(u=o[l])||isNaN(u)||(++n,i+=u)}return n?i/n:0}return t.registerProcessorFunction("AVERAGE",e),e}),e(t,"Data/Formula/Functions/AVERAGEA.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var c=t.getArgumentValue;function e(t,e){for(var o,r=0,n=0,i=0,s=t.length;i<s;++i)switch(typeof(o=c(t[i],e))){case"boolean":++r,n+=o?1:0;continue;case"number":isNaN(o)||(++r,n+=o);continue;case"string":++r;continue;default:for(var a,u=0,l=o.length;u<l;++u)switch(typeof(a=o[u])){case"boolean":++r,n+=a?1:0;continue;case"number":isNaN(a)||(++r,n+=a);continue;case"string":++r;continue}continue}return r?n/r:0}return t.registerProcessorFunction("AVERAGEA",e),e}),e(t,"Data/Formula/Functions/COUNT.js",[t["Data/Formula/FormulaProcessor.js"]],function(a){function u(t,e){for(var o,r=a.getArgumentsValues(t,e),n=0,i=0,s=r.length;i<s;++i)switch(typeof(o=r[i])){case"number":isNaN(o)||++n;break;case"object":n+=u(o,e)}return n}return a.registerProcessorFunction("COUNT",u),u}),e(t,"Data/Formula/Functions/COUNTA.js",[t["Data/Formula/FormulaProcessor.js"]],function(a){function u(t,e){for(var o,r=a.getArgumentsValues(t,e),n=0,i=0,s=r.length;i<s;++i){switch(typeof(o=r[i])){case"number":if(isNaN(o))continue;break;case"object":n+=u(o,e);continue;case"string":if(o)break;continue}++n}return n}return a.registerProcessorFunction("COUNTA",u),u}),e(t,"Data/Formula/Functions/IF.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var o=t.getArgumentValue;function e(t,e){return o(t[0],e)?o(t[1],e):o(t[2],e)}return t.registerProcessorFunction("IF",e),e}),e(t,"Data/Formula/Functions/ISNA.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var o=t.getArgumentValue;function e(t,e){t=o(t[0],e);return"number"!=typeof t||isNaN(t)}return t.registerProcessorFunction("ISNA",e),e}),e(t,"Data/Formula/Functions/MAX.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var a=t.getArgumentsValues;function u(t,e){for(var o=a(t,e),r=Number.NEGATIVE_INFINITY,n=0,i=o.length,s=void 0;n<i;++n)switch(typeof(s=o[n])){case"number":r<s&&(r=s);break;case"object":r<(s=u(s))&&(r=s)}return isFinite(r)?r:0}return t.registerProcessorFunction("MAX",u),u}),e(t,"Data/Formula/Functions/MEDIAN.js",[t["Data/Formula/FormulaProcessor.js"]],function(c){function t(t,e){for(var o,r=[],n=c.getArgumentsValues(t,e),i=0,s=n.length;i<s;++i)switch(typeof(o=n[i])){case"number":isNaN(o)||r.push(o);break;case"object":for(var a,u=0,l=o.length;u<l;++u)"number"!=typeof(a=o[u])||isNaN(a)||r.push(a)}t=r.length;if(!t)return NaN;e=Math.floor(t/2);return t%2?r[e]:(r[e-1]+r[e])/2}return c.registerProcessorFunction("MEDIAN",t),t}),e(t,"Data/Formula/Functions/MIN.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var a=t.getArgumentsValues;function u(t,e){for(var o=a(t,e),r=Number.POSITIVE_INFINITY,n=0,i=o.length,s=void 0;n<i;++n)switch(typeof(s=o[n])){case"number":s<r&&(r=s);break;case"object":(s=u(s))<r&&(r=s)}return isFinite(r)?r:0}return t.registerProcessorFunction("MIN",u),u}),e(t,"Data/Formula/Functions/MOD.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var r=t.getArgumentValue;function e(t,e){var o=r(t[0],e),t=r(t[1],e);return"object"==typeof o&&(o=o[0]),"object"==typeof t&&(t=t[0]),"number"!=typeof o||"number"!=typeof t||0===t?NaN:o%t}return t.registerProcessorFunction("MOD",e),e}),e(t,"Data/Formula/Functions/MODE.js",[t["Data/Formula/FormulaProcessor.js"]],function(c){function f(t,e){for(var o,r={},n=c.getArgumentsValues(t,e),i=0,s=n.length;i<s;++i)switch(typeof(o=n[i])){case"number":isNaN(o)||(r[o]=(r[o]||0)+1);break;case"object":for(var a,u=0,l=o.length;u<l;++u)"number"!=typeof(a=o[u])||isNaN(a)||(r[a]=(r[a]||0)+1)}return r}function t(t,e){var o=f(t,e),r=Object.keys(o);if(!r.length)return NaN;for(var n,i,s=[parseFloat(r[0])],a=o[r[0]],u=1,l=r.length;u<l;++u)a<(i=o[n=r[u]])?(s=[parseFloat(n)],a=i):a===i&&s.push(parseFloat(n));return 1<a?s:NaN}function e(t,e){var o=f(t,e),r=Object.keys(o);if(!r.length)return NaN;for(var n,i,s=parseFloat(r[0]),a=o[r[0]],u=1,l=r.length;u<l;++u)a<(i=o[n=r[u]])?(s=parseFloat(n),a=i):a===i&&(n=parseFloat(n))<s&&(s=n,a=i);return 1<a?s:NaN}return c.registerProcessorFunction("MODE",e),c.registerProcessorFunction("MODE.MULT",t),c.registerProcessorFunction("MODE.SNGL",e),{MULT:t,SNGL:e}}),e(t,"Data/Formula/Functions/NOT.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var r=t.getArgumentValue;function e(t,e){var o=r(t[0],e);switch(typeof(o="object"==typeof o?o[0]:o)){case"boolean":case"number":return!o}return NaN}return t.registerProcessorFunction("NOT",e),e}),e(t,"Data/Formula/Functions/OR.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var i=t.getArgumentValue;function s(t,e){for(var o,r=0,n=t.length;r<n;++r)if("object"==typeof(o=i(t[r],e))){if(s(o,e))return!0}else if(o)return!0;return!1}return t.registerProcessorFunction("OR",s),s}),e(t,"Data/Formula/Functions/PRODUCT.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var u=t.getArgumentsValues;function l(t,e){for(var o,r=u(t,e),n=1,i=!1,s=0,a=r.length;s<a;++s)switch(typeof(o=r[s])){case"number":isNaN(o)||(i=!0,n*=o);break;case"object":i=!0,n*=l(o,e)}return i?n:0}return t.registerProcessorFunction("PRODUCT",l),l}),e(t,"Data/Formula/Functions/SUM.js",[t["Data/Formula/FormulaProcessor.js"]],function(a){function u(t,e){for(var o,r=a.getArgumentsValues(t,e),n=0,i=0,s=r.length;i<s;++i)switch(typeof(o=r[i])){case"number":isNaN(o)||(n+=o);break;case"object":n+=u(o,e)}return n}return a.registerProcessorFunction("SUM",u),u}),e(t,"Data/Formula/Functions/XOR.js",[t["Data/Formula/FormulaProcessor.js"]],function(t){var l=t.getArgumentValue;function e(t,e){for(var o,r=0,n=t.length,i=void 0;r<n;++r)switch(typeof(o=l(t[r],e))){case"boolean":case"number":if(void 0===i)i=!!o;else if(!!o!==i)return!0;break;case"object":for(var s,a=0,u=o.length;a<u;++a)switch(typeof(s=o[a])){case"boolean":case"number":if(void 0===i)i=!!s;else if(!!s!==i)return!0}}return!1}return t.registerProcessorFunction("XOR",e),e}),e(t,"Data/Formula/Formula.js",[t["Data/Formula/FormulaParser.js"],t["Data/Formula/FormulaProcessor.js"],t["Data/Formula/FormulaTypes.js"]],function(t,e,o){var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};return r(r(r({},t),e),o)}),e(t,"Data/Converters/CSVConverter.js",[t["Data/Converters/DataConverter.js"],t["Core/Utilities.js"]],function(t,e){var r,o,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},w=e.merge;function s(t){var e=this,t=w(s.defaultOptions,t);return(e=o.call(this,t)||this).columns=[],e.headers=[],e.dataTypes=[],e.options=t,e}return n(s,o=t),s.prototype.export=function(t,e){var o=(e=void 0===e?this.options:e).useLocalDecimalPoint,r=e.lineDelimiter,n=!1!==this.options.firstRowAsNames,i=e.decimalPoint,s=e.itemDelimiter,i=i||(","!==s&&o?1.1.toLocaleString()[1]:"."),s=s||(","===i?";":","),a=t.getSortedColumns(e.usePresentationOrder),u=Object.keys(a),l=[],c=u.length,f=[];n&&l.push(u.map(function(t){return'"'.concat(t,'"')}).join(s));for(var p=0;p<c;p++){var m=u[p],h=a[m],d=h.length,m=t.whatIs(m),g=void 0;m&&(g=m.dataType);for(var y=0;y<d;y++){var v=h[y];if(f[y]||(f[y]=[]),"string"===g?v='"'+v+'"':"number"==typeof v?v=String(v).replace(".",i):"string"==typeof v&&(v='"'.concat(v,'"')),f[y][p]=v,p===c-1){for(var b=p;2<f[y].length;){if(void 0!==f[y][b])break;f[y].pop(),b--}l.push(f[y].join(s))}}}return l.join(r)},s.prototype.parse=function(t,e){var o,r=this,n=r.dataTypes,t=w(this.options,t),i=t.beforeParse,s=t.lineDelimiter,a=t.firstRowAsNames,u=t.itemDelimiter,l=0,c=t.csv,f=t.startRow,p=t.endRow;if(r.columns=[],r.emit({type:"parse",columns:r.columns,detail:e,headers:r.headers}),c=c&&i?i(c):c){if(o=c.replace(/\r\n|\r/g,"\n").split(s||"\n"),(!f||f<0)&&(f=0),(!p||p>=o.length)&&(p=o.length-1),u||(r.guessedItemDelimiter=r.guessDelimiter(o)),a){for(var m=o[0].split(u||r.guessedItemDelimiter||","),h=0;h<m.length;h++)m[h]=m[h].trim().replace(/^["']|["']$/g,"");r.headers=m,f++}for(var d=0,l=f;l<=p;l++)"#"===o[l][0]?d++:r.parseCSVRow(o[l],l-f-d);n.length&&n[0].length&&"date"===n[0][1]&&!r.options.dateFormat&&r.deduceDateFormat(r.columns[0],null,!0);for(var h=0,g=r.columns.length;h<g;++h)for(var y,v,b=0,C=(y=r.columns[h]).length;b<C;++b)y[b]&&"string"==typeof y[b]&&((v=r.asGuessedType(y[b]))instanceof Date&&(v=v.getTime()),r.columns[h][b]=v)}r.emit({type:"afterParse",columns:r.columns,detail:e,headers:r.headers})},s.prototype.parseCSVRow=function(e,o){function t(t){m=e[t],e[t-1],e[t+1]}function r(){if(d<u||l<d)return++d,h="";var t;"string"==typeof h?!isNaN(parseFloat(h))&&isFinite(h)?(h=parseFloat(h),y("number")):isNaN(Date.parse(h))?y("string"):(h=h.replace(/\//g,"-"),y("date")):y("number"),i.length<g+1&&i.push([]),"number"!=typeof h&&"number"!==n.guessType(h)&&f&&(h=(t=h).replace(f,"."),"number"!==n.guessType(h)&&(h=t)),i[g][o]=h,h="",++g,++d}var n=this,i=n.columns||[],s=n.dataTypes,a=n.options,u=a.startColumn,l=a.endColumn,c=n.options.itemDelimiter||n.guessedItemDelimiter,f=n.options.decimalPoint,p=(f&&f!==c||(f=n.guessedDecimalPoint||"."),0),m="",h="",d=0,g=0,y=function(t){s.length<g+1&&s.push([t]),s[g][s[g].length-1]!==t&&s[g].push(t)};if(e.trim().length&&"#"!==e.trim()[0]){for(;p<e.length;p++){if(t(p),"#"===m&&!/^#[0-F]{3,3}|[0-F]{6,6}/i.test(e.substring(p)))return void r();if('"'===m)for(t(++p);p<e.length&&'"'!==m;)h+=m,t(++p);else m===c?r():h+=m}r()}},s.prototype.guessDelimiter=function(t){for(var e,o=0,r=0,n={",":0,";":0,"\t":0},i=t.length,s=0;s<i;s++){var a,u,l=!1,c=void 0,f="";if(13<s)break;for(var p=t[s],m=0;m<p.length&&(a=p[m],c=p[m+1],u=p[m-1],"#"!==a);m++){if('"'===a)if(l){if('"'!==u&&'"'!==c){for(;" "===c&&m<p.length;)c=p[++m];void 0!==n[c]&&n[c]++,l=!1}}else l=!0;else void 0!==n[a]?(f=f.trim(),isNaN(Date.parse(f))&&!isNaN(Number(f))&&isFinite(Number(f))||n[a]++,f=""):f+=a;","===a&&r++,"."===a&&o++}}return e=n[";"]>n[","]?";":(n[","],n[";"],","),this.guessedDecimalPoint=r<o?".":",",e},s.prototype.getTable=function(){return t.getTableFromColumns(this.columns,this.headers)},s.defaultOptions=i(i({},t.defaultOptions),{lineDelimiter:"\n"}),s}),e(t,"Data/Connectors/CSVConnector.js",[t["Data/Converters/CSVConverter.js"],t["Data/Connectors/DataConnector.js"],t["Core/Utilities.js"]],function(o,t,e){var r,n,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=e.merge,e=(i(a,n=t),a.prototype.load=function(e){var o=this,r=o.converter,n=o.table,t=o.options,i=t.csv,s=t.csvURL,a=t.dataModifier;return o.emit({type:"load",csv:i,detail:e,table:n}),n.deleteRows(),Promise.resolve(s?fetch(s).then(function(t){return t.text()}):i||"").then(function(t){return t&&(r.parse({csv:t}),n.setColumns(r.getTable().getColumns())),o.setModifierOptions(a).then(function(){return t})}).then(function(t){return o.emit({type:"afterLoad",csv:t,detail:e,table:n}),o}).catch(function(t){throw o.emit({type:"loadError",detail:e,error:t,table:n}),t})},a.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},a);function a(t){var e=this,t=s(a.defaultOptions,t);return(e=n.call(this,t)||this).converter=new o(t),(e.options=t).enablePolling&&e.startPolling(1e3*Math.max(t.dataRefreshRate||0,1)),e}return t.registerType("CSV",e),e}),e(t,"Data/Converters/JSONConverter.js",[t["Data/Converters/DataConverter.js"],t["Data/DataTable.js"],t["Core/Utilities.js"]],function(t,o,e){var r,n,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},d=e.merge,g=e.isArray;function a(t){var e=this,t=d(a.defaultOptions,t);return(e=n.call(this,t)||this).columns=[],e.headers=[],e.dataTypes=[],e.options=t,e.table=new o,e}return i(a,n=t),a.prototype.parse=function(t,e){var o=this,r=(t=d(o.options,t)).beforeParse,n=t.orientation,i=t.firstRowAsNames,s=t.columnNames,a=t.data;if(a)if(a=(a=r?r(a):a).slice(),"columns"===n)for(var u=0,l=a.length;u<l;u++){var c=a[u];if(!(c instanceof Array))return;i?o.headers.push("".concat(c.shift())):s&&o.headers.push(s[u]),o.table.setColumn(o.headers[u]||u.toString(),c)}else if("rows"===n){i?o.headers=a.shift():s&&(o.headers=s);for(var f=0,l=a.length;f<l;f++){var p=a[f];if(g(p))for(var m=0,h=p.length;m<h;m++)o.columns.length<m+1&&o.columns.push([]),o.columns[m].push(p[m]),this.table.setCell(o.headers[m]||f.toString(),f,p[m]);else this.table.setRows([p],f)}}},a.prototype.getTable=function(){return this.table},a.defaultOptions=s(s({},t.defaultOptions),{data:[],orientation:"columns"}),a}),e(t,"Data/Connectors/JSONConnector.js",[t["Data/Connectors/DataConnector.js"],t["Core/Utilities.js"],t["Data/Converters/JSONConverter.js"]],function(t,e,o){var r,n,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=e.merge,e=(i(a,n=t),a.prototype.load=function(e){var o=this,r=o.converter,n=o.table,t=o.options,i=t.data,s=t.dataUrl,a=t.dataModifier;return o.emit({type:"load",data:i,detail:e,table:n}),n.deleteRows(),Promise.resolve(s?fetch(s).then(function(t){return t.json()}):i||[]).then(function(t){return t&&(r.parse({data:t}),n.setColumns(r.getTable().getColumns())),o.setModifierOptions(a).then(function(){return t})}).then(function(t){return o.emit({type:"afterLoad",data:t,detail:e,table:n}),o}).catch(function(t){throw o.emit({type:"loadError",detail:e,error:t,table:n}),t})},a.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},a);function a(t){var e=this,t=s(a.defaultOptions,t);return(e=n.call(this,t)||this).converter=new o(t),(e.options=t).enablePolling&&e.startPolling(1e3*Math.max(t.dataRefreshRate||0,1)),e}return t.registerType("JSON",e),e}),e(t,"Data/Converters/GoogleSheetsConverter.js",[t["Data/Converters/DataConverter.js"],t["Core/Utilities.js"]],function(t,e){var r,o,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},f=e.merge,p=e.uniqueKey;function s(t){var e=this,t=f(s.defaultOptions,t);return(e=o.call(this,t)||this).columns=[],e.header=[],e.options=t,e}return n(s,o=t),s.prototype.parse=function(t,e){var o,r=this,n=f(r.options,t),i=(n.json&&n.json.values||[]).map(function(t){return t.slice()});if(0===i.length)return!1;r.header=[],r.columns=[],r.emit({type:"parse",columns:r.columns,detail:e,headers:r.header});for(var s=0,a=(r.columns=i).length;s<a;s++){o=i[s],r.header[s]=n.firstRowAsNames?"".concat(o.shift()):p();for(var u,l=0,c=o.length;l<c;++l)o[l]&&"string"==typeof o[l]&&((u=r.asGuessedType(o[l]))instanceof Date&&(u=u.getTime()),r.columns[s][l]=u)}r.emit({type:"afterParse",columns:r.columns,detail:e,headers:r.header})},s.prototype.getTable=function(){return t.getTableFromColumns(this.columns,this.header)},s.defaultOptions=i({},t.defaultOptions),s}),e(t,"Data/Connectors/GoogleSheetsConnector.js",[t["Data/Connectors/DataConnector.js"],t["Data/Converters/GoogleSheetsConverter.js"],t["Core/Utilities.js"]],function(t,o,e){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=e.merge,s=e.pick;n(f,a=t),f.prototype.load=function(e){var o=this,r=o.converter,n=o.table,t=o.options,i=t.dataModifier,s=t.dataRefreshRate,a=t.enablePolling,u=t.firstRowAsNames,l=t.googleAPIKey,t=t.googleSpreadsheetKey,c=f.buildFetchURL(l,t,o.options);return o.emit({type:"load",detail:e,table:n,url:c}),n.deleteColumns(),fetch(c).then(function(t){return t.json()}).then(function(t){if("object"==typeof(e=t)&&e&&"object"==typeof e.error&&e.error&&"number"==typeof e.error.code&&"string"==typeof e.error.message&&"string"==typeof e.error.status)throw new Error(t.error.message);var e;return r.parse({firstRowAsNames:u,json:t}),n.setColumns(r.getTable().getColumns()),o.setModifierOptions(i)}).then(function(){return o.emit({type:"afterLoad",detail:e,table:n,url:c}),a&&setTimeout(function(){return o.load()},1e3*Math.max(s||0,1)),o}).catch(function(t){throw o.emit({type:"loadError",detail:e,error:t,table:n}),t})},f.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};var a,u,e=f;function f(t){var e=this,t=i(f.defaultOptions,t);return(e=a.call(this,t)||this).converter=new o(t),e.options=t,e}function l(t){var e=(t=void 0===t?{}:t).endColumn,o=t.endRow,r=t.googleSpreadsheetRange,n=t.startColumn,t=t.startRow;return r||(u[n||0]||"A")+(Math.max(t||0,0)+1)+":"+(u[s(e,25)]||"Z")+(o?Math.max(o,0):"Z")}return n=e=e||{},u="ABCDEFGHIJKLMNOPQRSTUVWXYZ",n.buildFetchURL=function(t,e,o){return void 0===o&&(o={}),"https://sheets.googleapis.com/v4/spreadsheets/".concat(e,"/values/")+(o.onlyColumnNames?"A1:Z1":l(o))+"?alt=json"+(o.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+"&prettyPrint=false"+"&key=".concat(t)},n.buildQueryRange=l,t.registerType("GoogleSheets",e),e}),e(t,"Data/Converters/HTMLTableConverter.js",[t["Data/Converters/DataConverter.js"],t["Core/Utilities.js"]],function(t,e){var r,o,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},N=e.merge;function s(t){var e=this,t=N(s.defaultOptions,t);return(e=o.call(this,t)||this).columns=[],e.headers=[],(e.options=t).tableElement&&(e.tableElement=t.tableElement,e.tableElementID=t.tableElement.id),e}return n(s,o=t),s.prototype.export=function(t,e){var o=!1!==(e=void 0===e?this.options:e).firstRowAsNames,r=e.useMultiLevelHeaders,n=t.getSortedColumns(e.usePresentationOrder),i=Object.keys(n),s=[],a=i.length,u=[],t="";if(o){var l=[];if(r){for(var c=0,f=i;c<f.length;c++){var p=(n[f[c]].shift()||"").toString();l.push(p)}t=this.getTableHeaderHTML(i,l,e)}else t=this.getTableHeaderHTML(void 0,i,e)}for(var m=0;m<a;m++)for(var h=n[i[m]],d=h.length,g=0;g<d;g++){var y=h[g];u[g]||(u[g]=[]),"string"!=typeof y&&"number"!=typeof y&&void 0!==y&&(y=(y||"").toString()),u[g][m]=this.getCellHTMLFromValue(m?"td":"th",null,m?"":'scope="row"',y),m===a-1&&s.push("<tr>"+u[g].join("")+"</tr>")}o="";return"<table>"+(o=e.tableCaption?'<caption class="highcharts-table-caption">'+e.tableCaption+"</caption>":o)+t+"<tbody>"+s.join("")+"</tbody></table>"},s.prototype.getCellHTMLFromValue=function(t,e,o,r,n){var i=r,e="text"+(e?" "+e:"");return"number"==typeof i?(i=i.toString(),","===n&&(i=i.replace(".",n)),e="number"):r||(i="",e="empty"),"<"+t+(o?" "+o:"")+' class="'+e+'">'+i+"</"+t+">"},s.prototype.getTableHeaderHTML=function(t,e,o){void 0===t&&(t=[]),void 0===e&&(e=[]);var r,n,i=(o=void 0===o?this.options:o).useMultiLevelHeaders,s=o.useRowspanHeaders,a=(o.useLocalDecimalPoint&&1.1.toLocaleString()[1],"<thead>"),u=0,l=e&&e.length,c=0;if(i&&t&&e&&!function(t,e){var o=t.length;if(e.length===o){for(;--o;)if(t[o]!==e[o])return;return 1}}(t,e)){for(a+="<tr>";u<l;++u)(r=t[u])===t[u+1]?++c:c?(a+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(c+1)+'"',r),c=0):(r===e[u]?s?(n=2,delete e[u]):(n=1,e[u]=""):n=1,a+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<n?' valign="top" rowspan="'+n+'"':""),r));a+="</tr>"}if(e){for(a+="<tr>",u=0,l=e.length;u<l;++u)void 0!==e[u]&&(a+=this.getCellHTMLFromValue("th",null,'scope="col"',e[u]));a+="</tr>"}return a+="</thead>"},s.prototype.parse=function(t,e){var o=this,r=[],n=[],t=N(o.options,t),i=t.endRow,s=t.startColumn,a=t.endColumn,u=t.firstRowAsNames,l=t.tableElement||this.tableElement;if(l instanceof HTMLElement){o.tableElement=l,o.tableElementID=l.id,this.emit({type:"parse",columns:o.columns,detail:e,headers:o.headers});var c=l.getElementsByTagName("tr"),f=c.length,p=0,m=t.startRow;if(u&&f){for(var h=c[0].children,d=h.length,g=s;g<d&&!(a<g);g++)"TD"!==(C=h[g]).tagName&&"TH"!==C.tagName||n.push(C.innerHTML);m++}for(;p<f;){if(m<=p&&p<=i)for(var y=c[p].children,v=y.length,b=0;b<v;){var C,w=b-s,j=r[w];if(("TD"===(C=y[b]).tagName||"TH"===C.tagName)&&s<=b&&b<=a){r[w]||(r[w]=[]);for(var D=o.asGuessedType(C.innerHTML),g=(D instanceof Date&&(D=D.getTime()),r[w][p-m]=D,1);g<=p-m&&void 0===j[p-m-g];)j[p-m-g]=null,g++}b++}p++}this.columns=r,this.headers=n,this.emit({type:"afterParse",columns:r,detail:e,headers:n})}else o.emit({type:"parseError",columns:r,detail:e,headers:n,error:"Not a valid HTML Table"})},s.prototype.getTable=function(){return t.getTableFromColumns(this.columns,this.headers)},s.defaultOptions=i(i({},t.defaultOptions),{useRowspanHeaders:!0,useMultiLevelHeaders:!0}),s}),e(t,"Data/Connectors/HTMLTableConnector.js",[t["Data/Connectors/DataConnector.js"],t["Core/Globals.js"],t["Data/Converters/HTMLTableConverter.js"],t["Core/Utilities.js"]],function(t,e,o,r){var n,i,s=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=e.win,u=r.merge,e=(s(l,i=t),l.prototype.load=function(t){var e,o=this,r=o.converter,n=o.table,i=o.options,s=i.dataModifier,i=i.table;return o.emit({type:"load",detail:t,table:n,tableElement:o.tableElement}),n.deleteColumns(),"string"==typeof i?(o.tableID=i,e=a.document.getElementById(i)):o.tableID=(e=i).id,o.tableElement=e||void 0,o.tableElement?(r.parse(u({tableElement:o.tableElement},o.options),t),n.setColumns(r.getTable().getColumns()),o.setModifierOptions(s).then(function(){return o.emit({type:"afterLoad",detail:t,table:n,tableElement:o.tableElement}),o})):(o.emit({type:"loadError",detail:t,error:i="HTML table not provided, or element with ID not found",table:n}),Promise.reject(new Error(i)))},l.defaultOptions={table:""},l);function l(t){var e=this,t=u(l.defaultOptions,t);return(e=i.call(this,t)||this).converter=new o(t),e.options=t,e}return t.registerType("HTMLTable",e),e}),e(t,"Data/Modifiers/ChainModifier.js",[t["Data/Modifiers/DataModifier.js"],t["Core/Utilities.js"]],function(l,t){var r,c,e=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),f=t.merge,t=(e(p,c=l),p.prototype.add=function(t,e){this.emit({type:"addModifier",detail:e,modifier:t}),this.chain.push(t),this.emit({type:"addModifier",detail:e,modifier:t})},p.prototype.clear=function(t){this.emit({type:"clearChain",detail:t}),this.chain.length=0,this.emit({type:"afterClearChain",detail:t})},p.prototype.modify=function(e,o){for(var r=this,n=this.options.reverse?this.chain.slice().reverse():this.chain.slice(),i=(e.modified===e&&(e.modified=e.clone(!1,o)),Promise.resolve(e)),t=0,s=n.length;t<s;++t)!function(t){var e=n[t];i=i.then(function(t){return e.modify(t.modified,o)})}(t);return i=(i=i.then(function(t){return e.modified.deleteColumns(),e.modified.setColumns(t.modified.getColumns()),e})).catch(function(t){throw r.emit({type:"error",detail:o,table:e}),t})},p.prototype.modifyCell=function(t,e,o,r,n){var i=this.options.reverse?this.chain.reverse():this.chain;if(i.length){for(var s=t.clone(),a=0,u=i.length;a<u;++a)i[a].modifyCell(s,e,o,r,n),s=s.modified;t.modified=s}return t},p.prototype.modifyColumns=function(t,e,o,r){var n=this.options.reverse?this.chain.reverse():this.chain.slice();if(n.length){for(var i=t.clone(),s=0,a=n.length;s<a;++s)n[s].modifyColumns(i,e,o,r),i=i.modified;t.modified=i}return t},p.prototype.modifyRows=function(t,e,o,r){var n=this.options.reverse?this.chain.reverse():this.chain.slice();if(n.length){for(var i=t.clone(),s=0,a=n.length;s<a;++s)n[s].modifyRows(i,e,o,r),i=i.modified;t.modified=i}return t},p.prototype.modifyTable=function(t,e){for(var o=this,r=(o.emit({type:"modify",detail:e,table:t}),o.options.reverse?o.chain.reverse():o.chain.slice()),n=t.modified,i=0,s=r.length;i<s;++i)n=r[i].modifyTable(n,e).modified;return t.modified=n,o.emit({type:"afterModify",detail:e,table:t}),t},p.prototype.remove=function(t,e){var o=this.chain;this.emit({type:"removeModifier",detail:e,modifier:t}),o.splice(o.indexOf(t),1),this.emit({type:"afterRemoveModifier",detail:e,modifier:t})},p.defaultOptions={type:"Chain"},p);function p(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];for(var r,n=c.call(this)||this,i=(n.chain=e,n.options=f(p.defaultOptions,t),n.options.chain||[]),s=0,a=i.length,u=void 0;s<a;++s)(r=i[s]).type&&(u=l.types[r.type])&&e.push(new u(r));return n}return l.registerType("Chain",t),t}),e(t,"Data/Modifiers/InvertModifier.js",[t["Data/Modifiers/DataModifier.js"],t["Core/Utilities.js"]],function(t,e){var r,o,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=e.merge,e=(n(s,o=t),s.prototype.modifyCell=function(t,e,o,r,n){var i=t.modified,e=i.getRowIndexBy("columnNames",e);return void 0===e?i.setColumns(this.modifyTable(t.clone()).getColumns(),void 0,n):i.setCell("".concat(o),e,r,n),t},s.prototype.modifyColumns=function(t,e,o,r){var n=t.modified,i=n.getColumn("columnNames")||[],s=t.getColumnNames(),a=t.getRowCount()!==i.length;if(!a)for(var u=0,l=s.length;u<l;++u)if(s[u]!==i[u]){a=!0;break}if(a)return this.modifyTable(t,r);for(u=0,l=(s=Object.keys(e)).length;u<l;++u)for(var c,f=e[c=s[u]],p=n.getRowIndexBy("columnNames",c)||n.getRowCount(),m=0,h=o,d=f.length;m<d;++m,++h)n.setCell("".concat(h),p,f[m],r);return t},s.prototype.modifyRows=function(t,e,o,r){var n=t.getColumnNames(),i=t.modified,s=i.getColumn("columnNames")||[],a=t.getRowCount()!==s.length;if(!a)for(var u=0,l=n.length;u<l;++u)if(n[u]!==s[u]){a=!0;break}if(a)return this.modifyTable(t,r);for(var c,u=0,f=o,l=e.length;u<l;++u,++f)if((c=e[u])instanceof Array)i.setColumn("".concat(f),c);else for(var p=0,m=n.length;p<m;++p)i.setCell("".concat(f),p,c[n[p]],r);return t},s.prototype.modifyTable=function(t,e){this.emit({type:"modify",detail:e,table:t});var o=t.modified;if(t.hasColumns(["columnNames"])){for(var r=((t.deleteColumns(["columnNames"])||{}).columnNames||[]).map(function(t){return"".concat(t)}),n={},i=0,s=t.getRowCount(),a=void 0;i<s;++i)(a=t.getRow(i))&&(n[r[i]]=a);o.deleteColumns(),o.setColumns(n)}else{for(n={},i=0,s=t.getRowCount(),a=void 0;i<s;++i)(a=t.getRow(i))&&(n["".concat(i)]=a);n.columnNames=t.getColumnNames(),o.deleteColumns(),o.setColumns(n)}return this.emit({type:"afterModify",detail:e,table:t}),t},s.defaultOptions={type:"Invert"},s);function s(t){var e=o.call(this)||this;return e.options=i(s.defaultOptions,t),e}return t.registerType("Invert",e),e}),e(t,"Data/Modifiers/MathModifier.js",[t["Data/Modifiers/DataModifier.js"],t["Data/Formula/FormulaParser.js"],t["Data/Formula/FormulaProcessor.js"]],function(t,p,l){var r,o,e=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},e=(e(i,o=t),i.prototype.modifyTable=function(t,e){for(var o,r=this,n=(r.emit({type:"modify",detail:e,table:t}),r.options.alternativeSeparators),i=r.options.formulaColumns||t.getColumnNames(),s=t.modified,a=0,u=i.length;a<u;++a)o=i[a],0<=i.indexOf(o)&&s.setColumn(o,r.processColumn(t,o));for(var l,c,f=r.options.columnFormulas||[],a=0,u=f.length;a<u;++a)l=f[a],c=p.parseFormula(l.formula,n),s.setColumn(l.column,r.processColumnFormula(c,t,l.rowStart,l.rowEnd));return r.emit({type:"afterModify",detail:e,table:t}),t},i.prototype.processColumn=function(t,e,o){void 0===o&&(o=0);for(var r=this.options.alternativeSeparators,n=(t.getColumn(e,!0)||[]).slice(0<o?o:0),i=0,s=n.length,a=[],u=void 0;i<s;++i)if("string"==typeof(u=n[i])&&"="===u[0])try{a=""===u?a:p.parseFormula(u.substring(1),r),n[i]=l.processFormula(a,t)}catch(t){n[i]=NaN}return n},i.prototype.processColumnFormula=function(t,e,o,r){o=0<=(o=void 0===o?0:o)?o:0,r=0<=(r=void 0===r?e.getRowCount():r)?r:e.getRowCount()+r;for(var n=[],i=e.modified,s=0,a=r-o;s<a;++s)try{n[s]=l.processFormula(t,i)}catch(t){n[s]=NaN}finally{t=l.translateReferences(t,0,1)}return n},i.defaultOptions={type:"Math",alternativeSeparators:!1},i);function i(t){var e=o.call(this)||this;return e.options=n(n({},i.defaultOptions),t),e}return t.registerType("Math",e),e}),e(t,"Data/Modifiers/RangeModifier.js",[t["Data/Modifiers/DataModifier.js"],t["Core/Utilities.js"]],function(t,e){var r,o,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=e.merge,e=(n(s,o=t),s.prototype.modifyTable=function(t,e){this.emit({type:"modify",detail:e,table:t});var o=this.options,r=o.additive,n=o.ranges,i=o.strict;if(n.length){for(var s,a=t.modified,u=t.getColumns(),l=[],c=0,f=n.length;c<f;++c)if(s=n[c],!i||typeof s.minValue==typeof s.maxValue){0<c&&!r&&(a.deleteRows(),a.setRows(l),u=a.getColumns(),l=[]);for(var p,m,h=0,d=(p=u[s.column]||[]).length;h<d;++h){switch(typeof(m=p[h])){default:continue;case"boolean":case"number":case"string":}i&&typeof m!=typeof s.minValue||m>=s.minValue&&m<=s.maxValue&&(m=(r?t:a).getRow(h))&&l.push(m)}}a.deleteRows(),a.setRows(l)}return this.emit({type:"afterModify",detail:e,table:t}),t},s.defaultOptions={type:"Range",ranges:[]},s);function s(t){var e=o.call(this)||this;return e.options=i(s.defaultOptions,t),e}return t.registerType("Range",e),e}),e(t,"Data/Modifiers/SortModifier.js",[t["Data/Modifiers/DataModifier.js"],t["Data/DataTable.js"],t["Core/Utilities.js"]],function(t,a,e){var r,o,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=e.merge,e=(n(m,o=t),m.ascending=function(t,e){return(t||0)<(e||0)?-1:(e||0)<(t||0)?1:0},m.descending=function(t,e){return(e||0)<(t||0)?-1:(t||0)<(e||0)?1:0},m.prototype.getRowReferences=function(t){for(var e=t.getRows(),o=[],r=0,n=e.length;r<n;++r)o.push({index:r,row:e[r]});return o},m.prototype.modifyCell=function(t,e,o,r,n){var i=this.options,s=i.orderByColumn,i=i.orderInColumn;return e===s&&(i?(t.modified.setCell(e,o,r),t.modified.setColumn(i,this.modifyTable(new a({columns:t.getColumns([s,i])})).modified.getColumn(i))):this.modifyTable(t,n)),t},m.prototype.modifyColumns=function(t,e,o,r){var n=this.options,i=n.orderByColumn,n=n.orderInColumn,s=Object.keys(e);return-1<s.indexOf(i)&&(n&&e[s[0]].length?(t.modified.setColumns(e,o),t.modified.setColumn(n,this.modifyTable(new a({columns:t.getColumns([i,n])})).modified.getColumn(n))):this.modifyTable(t,r)),t},m.prototype.modifyRows=function(t,e,o,r){var n=this.options,i=n.orderByColumn,n=n.orderInColumn;return n&&e.length?(t.modified.setRows(e,o),t.modified.setColumn(n,this.modifyTable(new a({columns:t.getColumns([i,n])})).modified.getColumn(n))):this.modifyTable(t,r),t},m.prototype.modifyTable=function(t,e){this.emit({type:"modify",detail:e,table:t});var o=t.getColumnNames(),r=t.getRowCount(),n=this.getRowReferences(t),i=this.options,s=i.direction,a=i.orderByColumn,i=i.orderInColumn,u="asc"===s?m.ascending:m.descending,l=o.indexOf(a),s=t.modified;if(-1!==l&&n.sort(function(t,e){return u(t.row[l],e.row[l])}),i){for(var c=[],f=0;f<r;++f)c[n[f].index]=f;s.setColumns(((o={})[i]=c,o))}else{for(var p=[],f=0;f<r;++f)p.push(n[f].row);s.setRows(p,0)}return this.emit({type:"afterModify",detail:e,table:t}),t},m.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},m);function m(t){var e=o.call(this)||this;return e.options=i(m.defaultOptions,t),e}return t.registerType("Sort",e),e}),e(t,"masters/modules/data-tools.src.js",[t["Core/Globals.js"],t["Data/Connectors/DataConnector.js"],t["Data/Converters/DataConverter.js"],t["Data/DataCursor.js"],t["Data/Modifiers/DataModifier.js"],t["Data/DataPool.js"],t["Data/DataTable.js"],t["Data/Formula/Formula.js"]],function(t,e,o,r,n,i,s,a){t.DataConnector=e,t.DataConverter=o,t.DataCursor=r,t.DataModifier=n,t.DataPool=i,t.DataTable=s,t.Formula=a})});