"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/funnel3d",["highcharts","highcharts/highcharts-3d","highcharts/modules/cylinder"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var e=t?t._modules:{};function r(t,e,r,i){t.hasOwnProperty(e)||(t[e]=i.apply(null,r))}r(e,"modules/funnel3d.src.js",[e["parts/Globals.js"],e["parts/Color.js"],e["parts/Utilities.js"]],function(G,t,e){var r,i=t.parse,x=e.error,k=e.extend,m=e.merge,S=e.pick,z=e.relativeLength,n=e.seriesType,b=G.charts,s=G.seriesTypes,o=G.Renderer.prototype,L=o.cuboidPath;n("funnel3d","column",{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,gradientForSides:!0,animation:!1,edgeWidth:0,colorByPoint:!0,showInLegend:!1,dataLabels:{align:"right",crop:!1,inside:!1,overflow:"allow"}},{bindAxes:function(){G.Series.prototype.bindAxes.apply(this,arguments),k(this.xAxis.options,{gridLineWidth:0,lineWidth:0,title:null,tickPositions:[]}),k(this.yAxis.options,{gridLineWidth:0,title:null,labels:{enabled:!1}})},translate3dShapes:G.noop,translate:function(){G.Series.prototype.translate.apply(this,arguments);var e,r,i,n,o,a,d,h,s,l=0,t=this,p=t.chart,c=t.options,g=c.reversed,u=c.ignoreHiddenPoint,f=p.plotWidth,y=p.plotHeight,w=0,x=c.center,m=z(x[0],f),b=z(x[1],y),L=z(c.width,f),U=z(c.height,y),v=z(c.neckWidth,f),C=z(c.neckHeight,y),E=b-U/2+U-C,A=t.data;t.getWidthAt=r=function(t){return E<t||U===C?v:v+(L-v)*(1-(t-(b-U/2))/(U-C))},t.center=[m,b,U],t.centerX=m,A.forEach(function(t){u&&!1===t.visible||(l+=t.y)}),A.forEach(function(t){d=null,i=l?t.y/l:0,e=r(o=b-U/2+w*U),h=(a=o+i*U)-o,s={gradientForSides:S(t.options.gradientForSides,c.gradientForSides),x:m,y:o,height:h,width:e,z:1,top:{width:e}},e=r(a),s.bottom={fraction:i,width:e},E<=o?s.isCylinder=!0:E<a&&(d=a,e=r(E),a=E,s.bottom.width=e,s.middle={fraction:h?(E-o)/h:0,width:e}),g&&(s.y=o=b+U/2-(w+i)*U,s.middle&&(s.middle.fraction=1-(h?s.middle.fraction:0)),e=s.width,s.width=s.bottom.width,s.bottom.width=e),t.shapeArgs=k(t.shapeArgs,s),t.percentage=100*i,t.plotX=m,t.plotY=g?b+U/2-(w+i/2)*U:(o+(d||a))/2,n=G.perspective([{x:m,y:t.plotY,z:g?-(L-r(t.plotY))/2:-r(t.plotY)/2}],p,!0)[0],t.tooltipPos=[n.x,n.y],t.dlBoxRaw={x:m,width:r(t.plotY),y:o,bottom:s.height,fullWidth:L},u&&!1===t.visible||(w+=i)})},alignDataLabel:function(t,e,r){var i=this,n=t.dlBoxRaw,o=i.chart.inverted,a=t.plotY>S(i.translatedThreshold,i.yAxis.len),d=S(r.inside,!!i.options.stacking),h={x:n.x,y:n.y,height:0};r.align=S(r.align,!o||d?"center":a?"right":"left"),r.verticalAlign=S(r.verticalAlign,o||d?"middle":a?"top":"bottom"),"top"!==r.verticalAlign&&(h.y+=n.bottom/("bottom"===r.verticalAlign?1:2)),h.width=i.getWidthAt(h.y),i.options.reversed&&(h.width=n.fullWidth-h.width),d?h.x-=h.width/2:"left"===r.align?(r.align="right",h.x-=1.5*h.width):"right"===r.align?(r.align="left",h.x+=h.width/2):h.x-=h.width/2,t.dlBox=h,s.column.prototype.alignDataLabel.apply(i,arguments)}},{shapeType:"funnel3d",hasNewShapeType:G.seriesTypes.column.prototype.pointClass.prototype.hasNewShapeType}),r=m(o.elements3d.cuboid,{parts:["top","bottom","frontUpper","backUpper","frontLower","backLower","rightUpper","rightLower"],mainParts:["top","bottom"],sideGroups:["upperGroup","lowerGroup"],sideParts:{upperGroup:["frontUpper","backUpper","rightUpper"],lowerGroup:["frontLower","backLower","rightLower"]},pathType:"funnel3d",opacitySetter:function(t){var e=this,r=e.parts,i=G.charts[e.renderer.chartIndex],n="group-opacity-"+t+"-"+i.index;return e.parts=e.mainParts,e.singleSetterForParts("opacity",t),e.parts=r,i.renderer.filterId||(i.renderer.definition({tagName:"filter",id:n,children:[{tagName:"feComponentTransfer",children:[{tagName:"feFuncA",type:"table",tableValues:"0 "+t}]}]}),e.sideGroups.forEach(function(t){e[t].attr({filter:"url(#"+n+")"})}),e.renderer.styledMode&&(i.renderer.definition({tagName:"style",textContent:".highcharts-"+n+" {filter:url(#"+n+")}"}),e.sideGroups.forEach(function(t){t.addClass("highcharts-"+n)}))),e},fillSetter:function(t){var o=this,n=i(t),e=n.rgba[3],a={top:i(t).brighten(.1).get(),bottom:i(t).brighten(-.2).get()};return e<1?(n.rgba[3]=1,n=n.get("rgb"),o.attr({opacity:e})):n=t,n.linearGradient||n.radialGradient||!o.gradientForSides||(n={linearGradient:{x1:0,x2:1,y1:1,y2:1},stops:[[0,i(t).brighten(-.2).get()],[.5,t],[1,i(t).brighten(-.2).get()]]}),n.linearGradient?o.sideGroups.forEach(function(t){var e=o[t].gradientBox,r=n.linearGradient,i=m(n,{linearGradient:{x1:e.x+r.x1*e.width,y1:e.y+r.y1*e.height,x2:e.x+r.x2*e.width,y2:e.y+r.y2*e.height}});o.sideParts[t].forEach(function(t){a[t]=i})}):(m(!0,a,{frontUpper:n,backUpper:n,rightUpper:n,frontLower:n,backLower:n,rightLower:n}),n.radialGradient&&o.sideGroups.forEach(function(t){var e=o[t].gradientBox,r=e.x+e.width/2,i=e.y+e.height/2,n=Math.min(e.width,e.height);o.sideParts[t].forEach(function(t){o[t].setRadialReference([r,i,n])})})),o.singleSetterForParts("fill",null,a),o.color=o.fill=t,n.linearGradient&&[o.frontLower,o.frontUpper].forEach(function(t){var e=t.element,r=e&&o.renderer.gradients[e.gradient];r&&"userSpaceOnUse"!==r.attr("gradientUnits")&&r.attr({gradientUnits:"userSpaceOnUse"})}),o},adjustForGradient:function(){var n,o=this;o.sideGroups.forEach(function(t){var r={x:Number.MAX_VALUE,y:Number.MAX_VALUE},i={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE};o.sideParts[t].forEach(function(t){var e=o[t];n=e.getBBox(!0),r={x:Math.min(r.x,n.x),y:Math.min(r.y,n.y)},i={x:Math.max(i.x,n.x+n.width),y:Math.max(i.y,n.y+n.height)}}),o[t].gradientBox={x:r.x,width:i.x-r.x,y:r.y,height:i.y-r.y}})},zIndexSetter:function(){return this.finishedOnAdd&&this.adjustForGradient(),this.renderer.Element.prototype.zIndexSetter.apply(this,arguments)},onAdd:function(){this.adjustForGradient(),this.finishedOnAdd=!0}}),o.elements3d.funnel3d=r,o.funnel3d=function(t){var e=this.element3d("funnel3d",t),r=this.styledMode,i={"stroke-width":1,stroke:"none"};return e.upperGroup=this.g("funnel3d-upper-group").attr({zIndex:e.frontUpper.zIndex}).add(e),[e.frontUpper,e.backUpper,e.rightUpper].forEach(function(t){r||t.attr(i),t.add(e.upperGroup)}),e.lowerGroup=this.g("funnel3d-lower-group").attr({zIndex:e.frontLower.zIndex}).add(e),[e.frontLower,e.backLower,e.rightLower].forEach(function(t){r||t.attr(i),t.add(e.lowerGroup)}),e.gradientForSides=t.gradientForSides,e},o.funnel3dPath=function(t){this.getCylinderEnd||x("A required Highcharts module is missing: cylinder.js",!0,b[this.chartIndex]);var e,r,i=this,n=b[i.chartIndex],o=t.alphaCorrection=90-Math.abs(n.options.chart.options3d.alpha%180-90),a=L.call(i,m(t,{depth:t.width,width:(t.width+t.bottom.width)/2})),d=a.isTop,h=!a.isFront,s=!!t.middle,l=i.getCylinderEnd(n,m(t,{x:t.x-t.width/2,z:t.z-t.width/2,alphaCorrection:o})),p=t.bottom.width,c=m(t,{width:p,x:t.x-p/2,z:t.z-p/2,alphaCorrection:o}),g=i.getCylinderEnd(n,c,!0),u=p,f=c,y=g,w=g;return s&&(u=t.middle.width,f=m(t,{y:t.y+t.middle.fraction*t.height,width:u,x:t.x-u/2,z:t.z-u/2}),y=i.getCylinderEnd(n,f,!1),w=i.getCylinderEnd(n,f,!1)),(e={top:l,bottom:g,frontUpper:i.getCylinderFront(l,y),zIndexes:{group:a.zIndexes.group,top:0!==d?0:3,bottom:1!==d?0:3,frontUpper:h?2:1,backUpper:h?1:2,rightUpper:h?2:1}}).backUpper=i.getCylinderBack(l,y),r=Math.min(u,t.width)/Math.max(u,t.width)!=1,e.rightUpper=i.getCylinderFront(i.getCylinderEnd(n,m(t,{x:t.x-t.width/2,z:t.z-t.width/2,alphaCorrection:r?-o:0}),!1),i.getCylinderEnd(n,m(f,{alphaCorrection:r?-o:0}),!s)),s&&(r=Math.min(u,p)/Math.max(u,p)!=1,m(!0,e,{frontLower:i.getCylinderFront(w,g),backLower:i.getCylinderBack(w,g),rightLower:i.getCylinderFront(i.getCylinderEnd(n,m(c,{alphaCorrection:r?-o:0}),!0),i.getCylinderEnd(n,m(f,{alphaCorrection:r?-o:0}),!1)),zIndexes:{frontLower:h?2:1,backLower:h?1:2,rightLower:h?1:2}})),e}}),r(e,"masters/modules/funnel3d.src.js",[],function(){})});