!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/tiledwebmap",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,o,i){e.hasOwnProperty(t)||(e[t]=i.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Maps/TilesProviders/OpenStreetMap.js",[],function(){return class{constructor(){this.defaultCredits='Map data &copy2023 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',this.initialProjectionName="WebMercator",this.subdomains=["a","b","c"],this.themes={Standard:{url:"https://tile.openstreetmap.org/{zoom}/{x}/{y}.png",minZoom:0,maxZoom:19},Hot:{url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",minZoom:0,maxZoom:19},OpenTopoMap:{url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",minZoom:0,maxZoom:17,credits:`Map data: &copy; <a href="https://www.openstreetmap.org/copyright">
                        OpenStreetMap</a> contributors, <a href="https://viewfinderpanoramas.org">SRTM</a> 
                        | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> 
                        (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)`}}}}}),t(e,"Maps/TilesProviders/Stamen.js",[],function(){return class{constructor(){this.defaultCredits='&copy; Map tiles by <a href="https://stamen.com">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="https://openstreetmap.org">OpenStreetMap</a>, under <a href="https://www.openstreetmap.org/copyright">ODbL</a>',this.initialProjectionName="WebMercator",this.subdomains=["a","b","c","d"],this.themes={Toner:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png",minZoom:0,maxZoom:20},TonerBackground:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}.png",minZoom:0,maxZoom:20},TonerLite:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png",minZoom:0,maxZoom:20},Terrain:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png",minZoom:0,maxZoom:18},TerrainBackground:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/terrain-background/{z}/{x}/{y}.png",minZoom:0,maxZoom:18},Watercolor:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png",minZoom:1,maxZoom:16,credits:'&copy Map tiles by <a href="https://stamen.com">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="https://openstreetmap.org">OpenStreetMap</a>, under <a href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'}}}}}),t(e,"Maps/TilesProviders/LimaLabs.js",[],function(){return class{constructor(){this.defaultCredits='Map data &copy;2023 <a href="https://maps.lima-labs.com/">LimaLabs</a>',this.initialProjectionName="WebMercator",this.requiresApiKey=!0,this.themes={Standard:{url:"https://cdn.lima-labs.com/{zoom}/{x}/{y}.png?api={apikey}",minZoom:0,maxZoom:20}}}}}),t(e,"Maps/TilesProviders/Thunderforest.js",[],function(){return class{constructor(){this.defaultCredits='Maps &copy <a href="https://www.thunderforest.com">Thunderforest</a>, Data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>',this.initialProjectionName="WebMercator",this.requiresApiKey=!0,this.subdomains=["a","b","c"],this.themes={OpenCycleMap:{url:"https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey={apikey}",minZoom:0,maxZoom:22},Transport:{url:"https://{s}.tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey={apikey}",minZoom:0,maxZoom:22},TransportDark:{url:"https://{s}.tile.thunderforest.com/transport-dark/{z}/{x}/{y}.png?apikey={apikey}",minZoom:0,maxZoom:22},SpinalMap:{url:"https://{s}.tile.thunderforest.com/spinal-map/{z}/{x}/{y}.png?apikey={apikey}",minZoom:0,maxZoom:22},Landscape:{url:"https://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png?apikey={apikey}",minZoom:0,maxZoom:22},Outdoors:{url:"https://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey={apikey}",minZoom:0,maxZoom:22},Pioneer:{url:"https://{s}.tile.thunderforest.com/pioneer/{z}/{x}/{y}.png?apikey={apikey}",minZoom:0,maxZoom:22},MobileAtlas:{url:"https://{s}.tile.thunderforest.com/mobile-atlas/{z}/{x}/{y}.png?apikey={apikey}",minZoom:0,maxZoom:22},Neighbourhood:{url:"https://{s}.tile.thunderforest.com/neighbourhood/{z}/{x}/{y}.png?apikey={apikey}",minZoom:0,maxZoom:22}}}}}),t(e,"Maps/TilesProviders/Esri.js",[],function(){return class{constructor(){this.defaultCredits="Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS,  Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012",this.initialProjectionName="WebMercator",this.themes={WorldStreetMap:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:20},DeLorme:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/Specialty/DeLorme_World_Base_Map/MapServer/tile/{z}/{y}/{x}",minZoom:1,maxZoom:11,credits:"Tiles &copy; Esri &mdash; Copyright: &copy;2012 DeLorme"},WorldTopoMap:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:20,credits:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community"},WorldImagery:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:20,credits:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"},WorldTerrain:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:13,credits:"Tiles &copy; Esri &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS"},WorldShadedRelief:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:13,credits:"Tiles &copy; Esri &mdash; Source: Esri"},WorldPhysical:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:8,credits:"Tiles &copy; Esri &mdash; Source: US National Park Service"},NatGeoWorldMap:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:16,credits:"Tiles &copy; Esri &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC"},WorldGrayCanvas:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:16,credits:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ"}}}}}),t(e,"Maps/TilesProviders/USGS.js",[],function(){return class{constructor(){this.defaultCredits='Tiles courtesy of the <a href="https://usgs.gov/">U.S. GeologicalSurvey</a>',this.initialProjectionName="WebMercator",this.themes={USTopo:{url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:20},USImagery:{url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:20},USImageryTopo:{url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}",minZoom:0,maxZoom:20}}}}}),t(e,"Maps/TilesProviders/TilesProviderRegistry.js",[e["Maps/TilesProviders/OpenStreetMap.js"],e["Maps/TilesProviders/Stamen.js"],e["Maps/TilesProviders/LimaLabs.js"],e["Maps/TilesProviders/Thunderforest.js"],e["Maps/TilesProviders/Esri.js"],e["Maps/TilesProviders/USGS.js"]],function(e,t,o,i,r,s){return{Esri:r,LimaLabs:o,OpenStreetMap:e,Stamen:t,Thunderforest:i,USGS:s}}),t(e,"Series/TiledWebMap/TiledWebMapSeriesDefaults.js",[],function(){return{states:{inactive:{enabled:!1}}}}),t(e,"Series/TiledWebMap/TiledWebMapSeries.js",[e["Core/Series/SeriesRegistry.js"],e["Maps/TilesProviders/TilesProviderRegistry.js"],e["Series/TiledWebMap/TiledWebMapSeriesDefaults.js"],e["Core/Utilities.js"]],function(e,n,t,o){let i=e.seriesTypes["map"],{addEvent:r,defined:Z,error:w,merge:s,pick:j,pushUnique:a}=o,p=[];function l(t){var o,i,r,s=(this.options.series||[]).filter(e=>"tiledwebmap"===e.type)[0],t=t["geoBounds"];if(s&&s.provider&&s.provider.type&&!s.provider.url){let e=n[s.provider.type];if(Z(e))return s=(new e)["initialProjectionName"],this.options.mapView&&(t?({x1:t,y1:o,x2:i,y2:r}=t,this.options.mapView.recommendedMapView={projection:{name:s,parallels:[o,r],rotation:[-(t+i)/2]}}):this.options.mapView.recommendedMapView={projection:{name:s},minZoom:0}),!1;w("Highcharts warning: Tiles Provider not defined in the Provider Registry.",!1)}return!0}class m extends i{constructor(){super(...arguments),this.options=void 0,this.redrawTiles=!1,this.isAnimating=!1}static compose(e){a(p,e)&&r(e,"beforeMapViewInit",l)}lonLatToTile(e,t){var{lon:e,lat:o}=e;return{x:Math.floor((e+180)/360*Math.pow(2,t)),y:Math.floor((1-Math.log(Math.tan(o*Math.PI/180)+1/Math.cos(o*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}}tileToLonLat(e,t,o){t=Math.PI-2*Math.PI*t/Math.pow(2,o);return{lon:e/Math.pow(2,o)*360-180,lat:180/Math.PI*Math.atan(.5*(Math.exp(t)-Math.exp(-t)))}}drawPoints(){let T=this.chart,x=T.mapView;if(x){let c=this.tiles=this.tiles||{},p=this.transformGroups=this.transformGroups||[],u=this,e=this.options,l=e.provider,t=x["zoom"],y=j(x.projection.options.rotation&&x.projection.options.rotation[0],0),f=T.renderer.forExport?0:200,g=i=>{for(let o of Object.keys(c))parseFloat(o)===(x.zoom<0?0:Math.floor(x.zoom))||u.minZoom&&(x.zoom<0?0:Math.floor(x.zoom))<u.minZoom&&parseFloat(o)===u.minZoom||u.maxZoom&&(x.zoom<0?0:Math.floor(x.zoom))>u.maxZoom&&parseFloat(o)===u.maxZoom?Object.keys(c[o].tiles).forEach((e,t)=>{c[o].tiles[e].animate({opacity:1},{duration:i},()=>{t===Object.keys(c[o].tiles).length-1&&(c[o].isActive=!0)})}):Object.keys(c[o].tiles).forEach((e,t)=>{c[o].tiles[e].animate({opacity:0},{duration:i,defer:i/2},()=>{c[o].tiles[e].destroy(),delete c[o].tiles[e],t===Object.keys(c[o].tiles).length-1&&(c[o].isActive=!1,c[o].loaded=!1)})})},M=t<0?0:Math.floor(t),m=Math.pow(2,M),o=.638436911716859*Math.pow(2,t)/(.638436911716859*Math.pow(2,M)),h=256*o;if(l&&(l.type||l.url)){if(l.type&&!l.url){let e=n[l.type];if(!Z(e))return void w("Highcharts warning: Tiles Provider '"+l.type+"' not defined in the ProviderRegistry.",!1);let t=new e,o=t.initialProjectionName,i,r="";l.theme&&Z(t.themes[l.theme])?i=t.themes[l.theme]:(a=Object.keys(t.themes)[0],i=t.themes[a],w("Highcharts warning: The Tiles Provider's Theme '"+l.theme+"' is not defined in the Provider definition - falling back to '"+a+"'.",!1)),l.subdomain&&t.subdomains&&-1!==t.subdomains.indexOf(l.subdomain)?r=l.subdomain:Z(t.subdomains)&&-1!==i.url.indexOf("{s}")&&(r=j(t.subdomains&&t.subdomains[0],""),w("Highcharts warning: The Tiles Provider's Subdomain '"+l.subdomain+"' is not defined in the Provider definition - falling back to '"+r+"'.",!1)),t.requiresApiKey&&(l.apiKey?i.url=i.url.replace("{apikey}",l.apiKey):(w("Highcharts warning: The Tiles Provider requires API Key to use tiles, use provider.apiKey to provide a token.",!1),i.url=i.url.replace("?apikey={apikey}",""))),l.url=i.url.replace("{s}",r),this.minZoom=i.minZoom,this.maxZoom=i.maxZoom;var a=j(T.userOptions.credits&&T.userOptions.credits.text,"Highcharts.com "+j(i.credits,t.defaultCredits));T.credits?T.credits.update({text:a}):T.addCredits({text:a,style:j(T.options.credits?.style,{})}),x.projection.options.name!==o&&w("Highcharts warning: The set projection is different than supported by Tiles Provider.",!1)}else x.projection.options.name||w("Highcharts warning: The set projection is different than supported by Tiles Provider.",!1);if(Z(this.minZoom)&&M<this.minZoom?(m=Math.pow(2,M=this.minZoom),h=256*(o=.638436911716859*Math.pow(2,t)/(.638436911716859*Math.pow(2,M)))):Z(this.maxZoom)&&M>this.maxZoom&&(m=Math.pow(2,M=this.maxZoom),h=256*(o=.638436911716859*Math.pow(2,t)/(.638436911716859*Math.pow(2,M)))),x.projection&&x.projection.def){x.projection.hasCoordinates=!0,p[M]||(p[M]=T.renderer.g().add(this.group));let n=(e,t,o,i)=>e.replace("{x}",t.toString()).replace("{y}",o.toString()).replace("{zoom}",i.toString()).replace("{z}",i.toString()),e=x.pixelsToProjectedUnits({x:0,y:0}),t=x.projection.def.inverse([e.x,e.y]),o={lon:t[0]-y,lat:t[1]},i=x.pixelsToProjectedUnits({x:T.plotWidth,y:T.plotHeight}),r=x.projection.def.inverse([i.x,i.y]),s={lon:r[0]-y,lat:r[1]};(o.lat>x.projection.maxLatitude||s.lat<-1*x.projection.maxLatitude)&&(o.lat=x.projection.maxLatitude,s.lat=-1*x.projection.maxLatitude);var d=this.lonLatToTile(o,M),v=this.lonLatToTile(s,M),a=this.tileToLonLat(d.x,d.y,M),a=x.projection.def.forward([a.lon+y,a.lat]),a=x.projectedUnitsToPixels({x:a[0],y:a[1]}),S=d.x*h-a.x,b=d.y*h-a.y;c[""+M]||(c[""+M]={tiles:{},isActive:!1,howManyTiles:0,actualTilesCount:0,loaded:!1}),c[""+M].howManyTiles=(v.x-d.x+1)*(v.y-d.y+1),c[""+M].actualTilesCount=0;for(let t=d.x;t<=v.x;t++)for(let e=d.y;e<=v.y;e++)((e,t,o,i,r)=>{var s=e%m,a=t%m,s=s<0?s+m:s,a=a<0?a+m:a;!c[""+o].tiles[e+","+t]&&l.url&&(s=n(l.url,s,a,o),c[o].loaded=!1,c[""+o].tiles[e+","+t]=T.renderer.image(s,e*h-i,t*h-r,h,h).attr({zIndex:2,opacity:0}).on("load",function(){l.onload&&l.onload.apply(this),o!==(x.zoom<0?0:Math.floor(x.zoom))&&o!==u.minZoom||(c[""+o].actualTilesCount++,c[""+o].howManyTiles===c[""+o].actualTilesCount&&(c[o].loaded=!0,u.isAnimating?u.redrawTiles=!0:(u.redrawTiles=!1,g(f)),c[""+o].actualTilesCount=0))}).add(p[o]),c[""+o].tiles[e+","+t].posX=e,c[""+o].tiles[e+","+t].posY=t,c[""+o].tiles[e+","+t].originalURL=s)})(t,e,M,S,b)}for(let d of Object.keys(c))for(let h of Object.keys(c[d].tiles))if(x.projection&&x.projection.def){let e=.638436911716859*Math.pow(2,t)/(.638436911716859*Math.pow(2,parseFloat(d))),p=256*e,i=c[d].tiles[Object.keys(c[d].tiles)[0]],{posX:l,posY:m}=c[d].tiles[h];if(Z(l)&&Z(m)&&Z(i.posX)&&Z(i.posY)){let e=this.tileToLonLat(i.posX,i.posY,parseFloat(d)),t=x.projection.def.forward([e.lon+y,e.lat]),o=x.projectedUnitsToPixels({x:t[0],y:t[1]}),a=i.posX*p-o.x,n=i.posY*p-o.y;if(T.renderer.globalAnimation&&T.hasRendered){let o=Number(c[d].tiles[h].attr("x")),i=Number(c[d].tiles[h].attr("y")),r=Number(c[d].tiles[h].attr("width")),s=Number(c[d].tiles[h].attr("height")),e=(e,t)=>{c[d].tiles[h].attr({x:o+(l*p-a-o)*t.pos,y:i+(m*p-n-i)*t.pos,width:r+(Math.ceil(p)+1-r)*t.pos,height:s+(Math.ceil(p)+1-s)*t.pos})};u.isAnimating=!0,c[d].tiles[h].attr({animator:0}).animate({animator:1},{step:e},function(){u.isAnimating=!1,u.redrawTiles&&(u.redrawTiles=!1,g(f))})}else(u.redrawTiles||parseFloat(d)!==M||(c[d].isActive||parseFloat(d)===M)&&Object.keys(c[d].tiles).map(e=>c[d].tiles[e]).some(e=>0===e.opacity))&&(u.redrawTiles=!1,g(f)),c[d].tiles[h].attr({x:l*p-a,y:m*p-n,width:Math.ceil(p)+1,height:Math.ceil(p)+1})}}}else w("Highcharts warning: Tiles Provider not defined in the Provider Registry.",!1)}}update(){let e=this["transformGroups"],t=this.chart,o=t.mapView,i=arguments[0],r=i["provider"];if(e&&(e.forEach(e=>{0!==Object.keys(e).length&&e.destroy()}),this.transformGroups=[]),o&&!Z(o.options.projection)&&r&&r.type){let e=n[r.type];var s;e&&(s=(new e)["initialProjectionName"],o.update({projection:{name:s}}))}super.update.apply(this,arguments)}}return m.defaultOptions=s(i.defaultOptions,t),e.registerSeriesType("tiledwebmap",m),m}),t(e,"masters/modules/tiledwebmap.src.js",[e["Core/Globals.js"],e["Series/TiledWebMap/TiledWebMapSeries.js"],e["Maps/TilesProviders/TilesProviderRegistry.js"]],function(e,t,o){e.TilesProviderRegistry=o,t.compose(e.Chart)})});