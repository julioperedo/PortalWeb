!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/funnel3d",["highcharts","highcharts/highcharts-3d","highcharts/modules/cylinder"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,i,r){t.hasOwnProperty(e)||(t[e]=r.apply(null,i))}e(t=t?t._modules:{},"modules/funnel3d.src.js",[t["parts/Globals.js"],t["parts/Color.js"],t["parts/Utilities.js"]],function(v,t,e){var i=t.parse,f=e.error,A=e.extend,y=e.merge,G=e.pick,k=e.relativeLength;e=e.seriesType;var w=v.charts,h=v.seriesTypes,x=(t=v.Renderer.prototype).cuboidPath;e("funnel3d","column",{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,gradientForSides:!0,animation:!1,edgeWidth:0,colorByPoint:!0,showInLegend:!1,dataLabels:{align:"right",crop:!1,inside:!1,overflow:"allow"}},{bindAxes:function(){v.Series.prototype.bindAxes.apply(this,arguments),A(this.xAxis.options,{gridLineWidth:0,lineWidth:0,title:null,tickPositions:[]}),A(this.yAxis.options,{gridLineWidth:0,title:null,labels:{enabled:!1}})},translate3dShapes:v.noop,translate:function(){v.Series.prototype.translate.apply(this,arguments);var e,i,r,n,o,d,a,h,s,l=0,p=this.chart,c=this.options,g=c.reversed,u=c.ignoreHiddenPoint,t=p.plotWidth,f=p.plotHeight,y=0,w=c.center,x=k(w[0],t),m=k(w[1],f),b=k(c.width,t),L=k(c.height,f),U=k(c.neckWidth,t),C=k(c.neckHeight,f),E=m-L/2+L-C,t=this.data;this.getWidthAt=i=function(t){return E<t||L===C?U:U+(b-U)*(1-(t-(m-L/2))/(L-C))},this.center=[x,m,L],this.centerX=x,t.forEach(function(t){u&&!1===t.visible||(l+=t.y)}),t.forEach(function(t){a=null,r=l?t.y/l:0,e=i(o=m-L/2+y*L),h=(d=o+r*L)-o,s={gradientForSides:G(t.options.gradientForSides,c.gradientForSides),x:x,y:o,height:h,width:e,z:1,top:{width:e}},e=i(d),s.bottom={fraction:r,width:e},E<=o?s.isCylinder=!0:E<d&&(a=d,e=i(E),d=E,s.bottom.width=e,s.middle={fraction:h?(E-o)/h:0,width:e}),g&&(s.y=o=m+L/2-(y+r)*L,s.middle&&(s.middle.fraction=1-(h?s.middle.fraction:0)),e=s.width,s.width=s.bottom.width,s.bottom.width=e),t.shapeArgs=A(t.shapeArgs,s),t.percentage=100*r,t.plotX=x,t.plotY=g?m+L/2-(y+r/2)*L:(o+(a||d))/2,n=v.perspective([{x:x,y:t.plotY,z:g?-(b-i(t.plotY))/2:-i(t.plotY)/2}],p,!0)[0],t.tooltipPos=[n.x,n.y],t.dlBoxRaw={x:x,width:i(t.plotY),y:o,bottom:s.height,fullWidth:b},u&&!1===t.visible||(y+=r)})},alignDataLabel:function(t,e,i){var r=t.dlBoxRaw,n=this.chart.inverted,o=t.plotY>G(this.translatedThreshold,this.yAxis.len),d=G(i.inside,!!this.options.stacking),a={x:r.x,y:r.y,height:0};i.align=G(i.align,!n||d?"center":o?"right":"left"),i.verticalAlign=G(i.verticalAlign,n||d?"middle":o?"top":"bottom"),"top"!==i.verticalAlign&&(a.y+=r.bottom/("bottom"===i.verticalAlign?1:2)),a.width=this.getWidthAt(a.y),this.options.reversed&&(a.width=r.fullWidth-a.width),d?a.x-=a.width/2:"left"===i.align?(i.align="right",a.x-=1.5*a.width):"right"===i.align?(i.align="left",a.x+=a.width/2):a.x-=a.width/2,t.dlBox=a,h.column.prototype.alignDataLabel.apply(this,arguments)}},{shapeType:"funnel3d",hasNewShapeType:v.seriesTypes.column.prototype.pointClass.prototype.hasNewShapeType}),e=y(t.elements3d.cuboid,{parts:"top bottom frontUpper backUpper frontLower backLower rightUpper rightLower".split(" "),mainParts:["top","bottom"],sideGroups:["upperGroup","lowerGroup"],sideParts:{upperGroup:["frontUpper","backUpper","rightUpper"],lowerGroup:["frontLower","backLower","rightLower"]},pathType:"funnel3d",opacitySetter:function(t){var e=this,i=e.parts,r=v.charts[e.renderer.chartIndex],n="group-opacity-"+t+"-"+r.index;return e.parts=e.mainParts,e.singleSetterForParts("opacity",t),e.parts=i,r.renderer.filterId||(r.renderer.definition({tagName:"filter",id:n,children:[{tagName:"feComponentTransfer",children:[{tagName:"feFuncA",type:"table",tableValues:"0 "+t}]}]}),e.sideGroups.forEach(function(t){e[t].attr({filter:"url(#"+n+")"})}),e.renderer.styledMode&&(r.renderer.definition({tagName:"style",textContent:".highcharts-"+n+" {filter:url(#"+n+")}"}),e.sideGroups.forEach(function(t){t.addClass("highcharts-"+n)}))),e},fillSetter:function(t){var o=this,n=i(t),e=n.rgba[3],d={top:i(t).brighten(.1).get(),bottom:i(t).brighten(-.2).get()};return e<1?(n.rgba[3]=1,n=n.get("rgb"),o.attr({opacity:e})):n=t,n.linearGradient||n.radialGradient||!o.gradientForSides||(n={linearGradient:{x1:0,x2:1,y1:1,y2:1},stops:[[0,i(t).brighten(-.2).get()],[.5,t],[1,i(t).brighten(-.2).get()]]}),n.linearGradient?o.sideGroups.forEach(function(t){var e=o[t].gradientBox,i=n.linearGradient,r=y(n,{linearGradient:{x1:e.x+i.x1*e.width,y1:e.y+i.y1*e.height,x2:e.x+i.x2*e.width,y2:e.y+i.y2*e.height}});o.sideParts[t].forEach(function(t){d[t]=r})}):(y(!0,d,{frontUpper:n,backUpper:n,rightUpper:n,frontLower:n,backLower:n,rightLower:n}),n.radialGradient&&o.sideGroups.forEach(function(t){var e=o[t].gradientBox,i=e.x+e.width/2,r=e.y+e.height/2,n=Math.min(e.width,e.height);o.sideParts[t].forEach(function(t){o[t].setRadialReference([i,r,n])})})),o.singleSetterForParts("fill",null,d),o.color=o.fill=t,n.linearGradient&&[o.frontLower,o.frontUpper].forEach(function(t){(t=(t=t.element)&&o.renderer.gradients[t.gradient])&&"userSpaceOnUse"!==t.attr("gradientUnits")&&t.attr({gradientUnits:"userSpaceOnUse"})}),o},adjustForGradient:function(){var r,n=this;n.sideGroups.forEach(function(t){var e={x:Number.MAX_VALUE,y:Number.MAX_VALUE},i={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE};n.sideParts[t].forEach(function(t){r=n[t].getBBox(!0),e={x:Math.min(e.x,r.x),y:Math.min(e.y,r.y)},i={x:Math.max(i.x,r.x+r.width),y:Math.max(i.y,r.y+r.height)}}),n[t].gradientBox={x:e.x,width:i.x-e.x,y:e.y,height:i.y-e.y}})},zIndexSetter:function(){return this.finishedOnAdd&&this.adjustForGradient(),this.renderer.Element.prototype.zIndexSetter.apply(this,arguments)},onAdd:function(){this.adjustForGradient(),this.finishedOnAdd=!0}}),t.elements3d.funnel3d=e,t.funnel3d=function(t){var e=this.element3d("funnel3d",t),i=this.styledMode,r={"stroke-width":1,stroke:"none"};return e.upperGroup=this.g("funnel3d-upper-group").attr({zIndex:e.frontUpper.zIndex}).add(e),[e.frontUpper,e.backUpper,e.rightUpper].forEach(function(t){i||t.attr(r),t.add(e.upperGroup)}),e.lowerGroup=this.g("funnel3d-lower-group").attr({zIndex:e.frontLower.zIndex}).add(e),[e.frontLower,e.backLower,e.rightLower].forEach(function(t){i||t.attr(r),t.add(e.lowerGroup)}),e.gradientForSides=t.gradientForSides,e},t.funnel3dPath=function(t){this.getCylinderEnd||f("A required Highcharts module is missing: cylinder.js",!0,w[this.chartIndex]);var e=w[this.chartIndex],i=t.alphaCorrection=90-Math.abs(e.options.chart.options3d.alpha%180-90),r=x.call(this,y(t,{depth:t.width,width:(t.width+t.bottom.width)/2})),n=r.isTop,o=!r.isFront,d=!!t.middle,a=this.getCylinderEnd(e,y(t,{x:t.x-t.width/2,z:t.z-t.width/2,alphaCorrection:i})),h=t.bottom.width,s=y(t,{width:h,x:t.x-h/2,z:t.z-h/2,alphaCorrection:i}),l=this.getCylinderEnd(e,s,!0),p=h,c=s,g=l,u=l;return d&&(p=t.middle.width,c=y(t,{y:t.y+t.middle.fraction*t.height,width:p,x:t.x-p/2,z:t.z-p/2}),g=this.getCylinderEnd(e,c,!1),u=this.getCylinderEnd(e,c,!1)),(r={top:a,bottom:l,frontUpper:this.getCylinderFront(a,g),zIndexes:{group:r.zIndexes.group,top:0!==n?0:3,bottom:1!==n?0:3,frontUpper:o?2:1,backUpper:o?1:2,rightUpper:o?2:1}}).backUpper=this.getCylinderBack(a,g),a=1!=Math.min(p,t.width)/Math.max(p,t.width),r.rightUpper=this.getCylinderFront(this.getCylinderEnd(e,y(t,{x:t.x-t.width/2,z:t.z-t.width/2,alphaCorrection:a?-i:0}),!1),this.getCylinderEnd(e,y(c,{alphaCorrection:a?-i:0}),!d)),d&&(a=1!=Math.min(p,h)/Math.max(p,h),y(!0,r,{frontLower:this.getCylinderFront(u,l),backLower:this.getCylinderBack(u,l),rightLower:this.getCylinderFront(this.getCylinderEnd(e,y(s,{alphaCorrection:a?-i:0}),!0),this.getCylinderEnd(e,y(c,{alphaCorrection:a?-i:0}),!1)),zIndexes:{frontLower:o?2:1,backLower:o?1:2,rightLower:o?1:2}})),r}}),e(t,"masters/modules/funnel3d.src.js",[],function(){})});