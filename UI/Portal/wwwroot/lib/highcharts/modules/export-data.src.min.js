"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){var e=t?t._modules:{};function a(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a))}a(e,"mixins/ajax.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(a,t){var r=t.merge,i=t.objectEach;a.ajax=function(t){var a=r(!0,{url:!1,type:"get",dataType:"json",success:!1,error:!1,data:!1,headers:{}},t),e={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"},o=new XMLHttpRequest;function n(t,e){a.error&&a.error(t,e)}if(!a.url)return!1;o.open(a.type.toUpperCase(),a.url,!0),a.headers["Content-Type"]||o.setRequestHeader("Content-Type",e[a.dataType]||e.text),i(a.headers,function(t,e){o.setRequestHeader(e,t)}),o.onreadystatechange=function(){var t;if(4===o.readyState){if(200===o.status){if(t=o.responseText,"json"===a.dataType)try{t=JSON.parse(t)}catch(t){return n(o,t)}return a.success&&a.success(t)}n(o,o.responseText)}};try{a.data=JSON.stringify(a.data)}catch(t){}o.send(a.data||!0)},a.getJSON=function(t,e){a.ajax({url:t,success:e,dataType:"json",headers:{"Content-Type":"text/plain"}})}}),a(e,"mixins/download-url.js",[e["parts/Globals.js"]],function(o){var s=o.win,n=s.navigator,r=s.document,l=s.URL||s.webkitURL||s,i=/Edge\/\d+/.test(n.userAgent);o.dataURLtoBlob=function(t){var e=t.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(e&&3<e.length&&s.atob&&s.ArrayBuffer&&s.Uint8Array&&s.Blob&&l.createObjectURL){for(var a,o=s.atob(e[3]),n=new s.ArrayBuffer(o.length),r=new s.Uint8Array(n),i=0;i<r.length;++i)r[i]=o.charCodeAt(i);return a=new s.Blob([r],{type:e[1]}),l.createObjectURL(a)}},o.downloadURL=function(e,t){var a=r.createElement("a");if("string"==typeof e||e instanceof String||!n.msSaveOrOpenBlob){if((i||2e6<e.length)&&!(e=o.dataURLtoBlob(e)))throw new Error("Failed to convert to blob");if(void 0!==a.download)a.href=e,a.download=t,r.body.appendChild(a),a.click(),r.body.removeChild(a);else try{if(null==s.open(e,"chart"))throw new Error("Failed to open window")}catch(t){s.location.href=e}}else n.msSaveOrOpenBlob(e,t)}}),a(e,"modules/export-data.src.js",[e["parts/Axis.js"],e["parts/Chart.js"],e["parts/Globals.js"],e["parts/Utilities.js"]],function(u,t,e,a){var o=e.doc,n=e.seriesTypes,i=e.win,r=a.addEvent,f=a.defined,s=a.extend,C=a.find,m=a.fireEvent,l=a.getOptions,j=a.isNumber,L=a.pick,p=a.setOptions,c=e.downloadURL;function d(t,e){var a=i.navigator,o=-1<a.userAgent.indexOf("WebKit")&&a.userAgent.indexOf("Chrome")<0,n=i.URL||i.webkitURL||i;try{if(a.msSaveOrOpenBlob&&i.MSBlobBuilder){var r=new i.MSBlobBuilder;return r.append(t),r.getBlob("image/svg+xml")}if(!o)return n.createObjectURL(new i.Blob(["\ufeff"+t],{type:e}))}catch(t){}}p({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table"}}),r(t,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}),t.prototype.setUpKeyToAxis=function(){n.arearange&&(n.arearange.prototype.keyToAxis={low:"y",high:"y"}),n.gantt&&(n.gantt.prototype.keyToAxis={start:"x",end:"x"})},t.prototype.getDataRows=function(n){function e(t,e,a){if(b.columnHeaderFormatter){var o=b.columnHeaderFormatter(t,e,a);if(!1!==o)return o}return t?t instanceof u?t.options.title&&t.options.title.text||(t.dateTime?h:d):n?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):d}function x(o,t,n){var r={},i={};return t.forEach(function(t){var e=(o.keyToAxis&&o.keyToAxis[t]||t)+"Axis",a=j(n)?o.chart[e][n]:o[e];r[t]=a&&a.categories||[],i[t]=a&&a.dateTime}),{categoryMap:r,dateTimeValueAxisMap:i}}var a,t,o,r,i,s,l,g=this.hasParallelCoordinates,y=this.time,b=this.options.exporting&&this.options.exporting.csv||{},v=this.xAxis,w={},p=[],T=[],D=[],c=this.options.lang.exportData,d=c.categoryHeader,h=c.categoryDatetimeHeader,S=[],A=0;for(r in this.setUpKeyToAxis(),this.series.forEach(function(s){var l,p,t=s.options.keys,c=s.xAxis,d=t||function(t,e){if(!t.data.filter(function(t){return t.name}).length||!e||e.categories||t.keyToAxis)return t.pointArrayMap||["y"];if(t.pointArrayMap&&t.pointArrayMap.filter(function(t){return"x"===t}).length)return t.pointArrayMap.unshift("x"),t.pointArrayMap;return["x","y"]}(s,c),h=d.length,u=!s.requireSorting&&{},f=v.indexOf(c),m=x(s,d);if(!1!==s.options.includeInDataExport&&!s.options.isInternal&&!1!==s.visible){for(C(S,function(t){return t[0]===f})||S.push([f,A]),p=0;p<h;)o=e(s,d[p],d.length),D.push(o.columnTitle||o),n&&T.push(o.topLevelColumnTitle||o),p++;l={chart:s.chart,autoIncrement:s.autoIncrement,options:s.options,pointArrayMap:s.pointArrayMap},s.options.data.forEach(function(t,e){var a,o,n,r,i;for(g&&(m=x(s,d,e)),i={series:l},s.pointClass.prototype.applyOptions.apply(i,[t]),a=i.x,r=s.data[e]&&s.data[e].name,p=0,(!c||"name"===s.exportKey||!g&&c&&c.hasNames&&r)&&(a=r),u&&(u[a]&&(a+="|"+e),u[a]=!0),w[a]||(w[a]=[],w[a].xValues=[]),w[a].x=i.x,w[a].name=r,w[a].xValues[f]=i.x;p<h;)n=i[o=d[p]],w[a][A+p]=L(m.categoryMap[o][n],m.dateTimeValueAxisMap[o]?y.dateFormat(b.dateFormat,n):null,n),p++}),A+=p}}),w)Object.hasOwnProperty.call(w,r)&&p.push(w[r]);for(t=n?[T,D]:[D],A=S.length;A--;)s=S[A][0],l=S[A][1],a=v[s],p.sort(function(t,e){return t.xValues[s]-e.xValues[s]}),i=e(a),t[0].splice(l,0,i),n&&t[1]&&t[1].splice(l,0,i),p.forEach(function(t){var e=t.name;a&&!f(e)&&(e=a.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),y.dateFormat(b.dateFormat,t.x)):a.categories?L(a.names[t.x],a.categories[t.x],t.x):t.x),t.splice(l,0,e)});return t=t.concat(p),m(this,"exportData",{dataRows:t}),t},t.prototype.getCSV=function(t){var n="",r=this.getDataRows(),e=this.options.exporting.csv,i=L(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=L(e.itemDelimiter,","===i?";":","),l=e.lineDelimiter;return r.forEach(function(t,e){for(var a="",o=t.length;o--;)"string"==typeof(a=t[o])&&(a='"'+a+'"'),"number"==typeof a&&"."!==i&&(a=a.toString().replace(".",i)),t[o]=a;n+=t.join(s),e<r.length-1&&(n+=l)}),n},t.prototype.getTable=function(t){function p(t,e,a,o){var n=L(o,""),r="text"+(e?" "+e:"");return"number"==typeof n?(n=n.toString(),","===i&&(n=n.replace(".",i)),r="number"):o||(r="empty"),"<"+t+(a?" "+a:"")+' class="'+r+'">'+n+"</"+t+">"}var a='<table id="highcharts-data-table-'+this.index+'">',c=this.options,i=t?1.1.toLocaleString()[1]:".",d=L(c.exporting.useMultiLevelHeaders,!0),e=this.getDataRows(d),o=0,n=d?e.shift():null,r=e.shift();!1!==c.exporting.tableCaption&&(a+='<caption class="highcharts-table-caption">'+L(c.exporting.tableCaption,c.title.text?c.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var s=0,l=e.length;s<l;++s)e[s].length>o&&(o=e[s].length);a+=function(t,e,a){var o,n,r="<thead>",i=0,s=a||e&&e.length,l=0;if(d&&t&&e&&!function(t,e){var a=t.length;if(e.length!==a)return!1;for(;a--;)if(t[a]!==e[a])return!1;return!0}(t,e)){for(r+="<tr>";i<s;++i)(o=t[i])===t[i+1]?++l:l?(r+=p("th","highcharts-table-topheading",'scope="col" colspan="'+(l+1)+'"',o),l=0):(o===e[i]?c.exporting.useRowspanHeaders?(n=2,delete e[i]):(n=1,e[i]=""):n=1,r+=p("th","highcharts-table-topheading",'scope="col"'+(1<n?' valign="top" rowspan="'+n+'"':""),o));r+="</tr>"}if(e){for(r+="<tr>",i=0,s=e.length;i<s;++i)void 0!==e[i]&&(r+=p("th",null,'scope="col"',e[i]));r+="</tr>"}return r+="</thead>"}(n,r,Math.max(o,r.length)),a+="<tbody>",e.forEach(function(t){a+="<tr>";for(var e=0;e<o;e++)a+=p(e?"td":"th",null,e?"":'scope="row"',t[e]);a+="</tr>"});var h={html:a+="</tbody></table>"};return m(this,"afterGetTable",h),h.html},t.prototype.downloadCSV=function(){var t=this.getCSV(!0);c(d(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},t.prototype.downloadXLS=function(){var t,e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";c(d(e,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+(t=e,i.btoa(unescape(encodeURIComponent(t)))),this.getFilename()+".xls")},t.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=o.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv.innerHTML=this.getTable(),m(this,"afterViewData",this.dataTableDiv)};var h=l().exporting;h&&(s(h.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}}}),h.buttons&&h.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),n.map&&(n.map.prototype.exportKey="name"),n.mapbubble&&(n.mapbubble.prototype.exportKey="name"),n.treemap&&(n.treemap.prototype.exportKey="name")}),a(e,"masters/modules/export-data.src.js",[],function(){})});