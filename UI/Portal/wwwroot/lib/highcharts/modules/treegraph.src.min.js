!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/treegraph",["highcharts","highcharts/modules/treemap"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,i,s){e.hasOwnProperty(t)||(e[t]=s.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Series/PathUtilities.js",[],function(){function h(t,i){const s=[];for(let e=0;e<t.length;e++){var o,r,n,a,l,h,d=t[e][1],p=t[e][2];"number"==typeof d&&"number"==typeof p&&(0===e?s.push(["M",d,p]):e!==t.length-1&&i?(r=t[e-1],a=t[e+1],r&&a&&(o=r[1],r=r[2],n=a[1],a=a[2],"number"==typeof o&&"number"==typeof n&&"number"==typeof r&&"number"==typeof a&&o!==n&&r!==a&&(l=o<n?1:-1,h=r<a?1:-1,s.push(["L",d-l*Math.min(Math.abs(d-o),i),p-h*Math.min(Math.abs(p-r),i)],["C",d,p,d,p,d+l*Math.min(Math.abs(d-n),i),p+h*Math.min(Math.abs(p-a),i)])))):s.push(["L",d,p]))}return s}return{applyRadius:h,getLinkPath:{default:function(e){var{x1:e,y1:t,x2:i,y2:s,width:o=0,inverted:r=!1,radius:n,parentVisible:a}=e,l=[["M",e,t],["L",e,t],["C",e,t,e,s,e,s],["L",e,s],["C",e,t,e,s,e,s],["L",e,s]];return a?h([["M",e,t],["L",e+o*(r?-.5:.5),t],["L",e+o*(r?-.5:.5),s],["L",i,s]],n):l},straight:function(e){var{x1:e,y1:t,x2:i,y2:s,width:o=0,inverted:r=!1,parentVisible:n}=e;return n?[["M",e,t],["L",e+o*(r?-1:1),s],["L",i,s]]:[["M",e,t],["L",e,s],["L",e,s]]},curved:function(e){var{x1:e,y1:t,x2:i,y2:s,offset:o=0,width:r=0,inverted:n=!1,parentVisible:a}=e;return a?[["M",e,t],["C",e+o,t,e-o+r*(n?-1:1),s,e+r*(n?-1:1),s],["L",i,s]]:[["M",e,t],["C",e,t,e,s,e,s],["L",i,s]]}}}}),t(e,"Series/Treegraph/TreegraphNode.js",[e["Core/Series/SeriesRegistry.js"]],function(e){var{prototype:{NodeClass:e}}=e["seriesTypes"]["treemap"];class t extends e{constructor(){super(...arguments),this.mod=0,this.shift=0,this.change=0,this.children=[],this.preX=0,this.hidden=!1,this.wasVisited=!1,this.collapsed=!1}nextLeft(){return this.getLeftMostChild()||this.thread}nextRight(){return this.getRightMostChild()||this.thread}getAncestor(e,t){return e.ancestor.children[0]===this.children[0]?e.ancestor:t}getLeftMostSibling(){var e=this.getParent();if(e)for(const t of e.children)if(t&&t.point.visible)return t}hasChildren(){var t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return!0;return!1}getLeftSibling(){var e=this.getParent();if(e){var t=e.children;for(let e=this.relativeXPosition-1;0<=e;e--)if(t[e]&&t[e].point.visible)return t[e]}}getLeftMostChild(){var t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return t[e]}getRightMostChild(){var t=this.children;for(let e=t.length-1;0<=e;e--)if(t[e].point.visible)return t[e]}getParent(){return this.parentNode}getFirstChild(){var t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return t[e]}}return t}),t(e,"Series/Treegraph/TreegraphPoint.js",[e["Core/Series/Point.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(e,t,i){var{prototype:{pointClass:t}}=t["seriesTypes"]["treemap"];const{addEvent:s,fireEvent:o,merge:g,pick:r}=i;class n extends t{constructor(){super(...arguments),this.options=void 0,this.isLink=!1,this.series=void 0,this.node=void 0,this.setState=e.prototype.setState}draw(){super.draw.apply(this,arguments);let e=this.graphic;e&&e.animate({visibility:this.visible?"inherit":"hidden"}),this.renderCollapseButton()}renderCollapseButton(){const e=this,t=e.series,i=e.graphic&&e.graphic.parentGroup,s=t.mapOptionsToLevel[e.node.level||0]||{},o=g(t.options.collapseButton,s.collapseButton,e.options.collapseButton),{width:r,height:n,shape:a,style:l}=o,h=this.series.chart,d=!e.visible||!e.collapsed&&o.onlyOnHover&&"hover"!==e.state?0:1;var p,c,u;e.shapeArgs&&(this.collapseButtonOptions=o,e.collapseButton?e.node.children.length&&o.enabled?({x:p,y:c}=this.getCollapseBtnPosition(o),e.collapseButton.attr({text:e.collapsed?"+":"-",rotation:h.inverted?90:0,rotationOriginX:r/2,rotationOriginY:n/2,visibility:e.visible?"inherit":"hidden"}).animate({x:p,y:c,opacity:d})):(e.collapseButton.destroy(),delete e.collapseButton):e.node.children.length&&o.enabled&&({x:p,y:c}=this.getCollapseBtnPosition(o),u=o.fillColor||e.color||"#cccccc",e.collapseButton=h.renderer.label(e.collapsed?"+":"-",p,c,a).attr({height:n-4,width:r-4,padding:2,fill:u,rotation:h.inverted?90:0,rotationOriginX:r/2,rotationOriginY:n/2,stroke:o.lineColor||"#ffffff","stroke-width":o.lineWidth,"text-align":"center",align:"center",zIndex:1,opacity:d,visibility:e.visible?"inherit":"hidden"}).addClass("highcharts-tracker").addClass("highcharts-collapse-button").removeClass("highcharts-no-tooltip").css(g({color:"string"==typeof u?h.renderer.getContrast(u):"#333333"},l)).add(i),e.collapseButton.element.point=e))}toggleCollapse(e){this.collapsed=r(e,!this.collapsed),o(this.series,"toggleCollapse"),this.series.redraw()}destroy(){this.collapseButton&&(this.collapseButton.destroy(),delete this.collapseButton,this.collapseButton=void 0),this.linkToParent&&(this.linkToParent.destroy(),delete this.linkToParent),super.destroy.apply(this,arguments)}getCollapseBtnPosition(e){var t=this.series.chart.inverted,i=e.width,s=e.height,{x:o=0,y:r=0,width:n=0,height:a=0}=this.shapeArgs||{};return{x:o+e.x+(t?.3*-s:n+-.3*i),y:r+a/2-s/2+e.y}}}return s(n,"mouseOut",function(){const e=this.collapseButton,t=this.collapseButtonOptions;e&&t&&t.onlyOnHover&&!this.collapsed&&e.animate({opacity:0})}),s(n,"mouseOver",function(){this.collapseButton&&this.visible&&this.collapseButton.animate({opacity:1},this.series.options.states&&this.series.options.states.hover&&this.series.options.states.hover.animation)}),s(n,"click",function(){this.toggleCollapse()}),n}),t(e,"Series/Treegraph/TreegraphLink.js",[e["Core/Series/Point.js"],e["Core/Utilities.js"],e["Core/Series/SeriesRegistry.js"]],function(r,e,t){const{pick:n,extend:a}=e;var{prototype:{pointClass:e}}=t["seriesTypes"]["column"];class i extends e{constructor(){super(...arguments),this.isLink=!0,this.node={},this.formatPrefix="link",this.dataLabelOnNull=!0}init(e,t,i,s){const o=super.init.apply(this,arguments);return this.formatPrefix="link",this.dataLabelOnNull=!0,s&&(o.fromNode=s.node.parentNode.point,o.visible=s.visible,o.toNode=s,this.id=o.toNode.id+"-"+o.fromNode.id),o}update(e,t,i,s){var o={id:this.id,formatPrefix:this.formatPrefix};r.prototype.update.call(this,e,!this.isLink&&t,i,s),this.visible=this.toNode.visible,a(this,o),n(t,!0)&&this.series.chart.redraw(i)}}return i}),t(e,"Series/Treegraph/TreegraphLayout.js",[e["Series/Treegraph/TreegraphNode.js"]],function(r){class o{static createDummyNode(e,t,i,s){const o=new r;return o.id=e.id+"-"+i,o.ancestor=e,o.children.push(t),o.parent=e.id,o.parentNode=e,o.point=t.point,o.level=t.level-i,o.relativeXPosition=t.relativeXPosition,o.visible=t.visible,e.children[t.relativeXPosition]=o,t.oldParentNode=e,t.relativeXPosition=0,t.parentNode=o,t.parent=o.id,o}calculatePositions(e){var t=this,i=e.nodeList,e=(this.resetValues(i),e.tree);e&&(t.calculateRelativeX(e,0),t.beforeLayout(i),t.firstWalk(e),t.secondWalk(e,-e.preX),t.afterLayout(i))}beforeLayout(e){for(const s of e){let t=0;for(var i of s.children){if(i&&1<i.level-s.level){let e=i.level-s.level-1;for(;0<e;)i=o.createDummyNode(s,i,e,t),e--}++t}}}resetValues(e){for(const t of e)t.mod=0,(t.ancestor=t).shift=0,t.thread=void 0,t.change=0,t.preX=0}calculateRelativeX(e,t){var i=e.children;for(let e=0,t=i.length;e<t;++e)this.calculateRelativeX(i[e],e);e.relativeXPosition=t}firstWalk(t){let i;if(t.hasChildren()){let e=t.getLeftMostChild();for(const r of t.children)this.firstWalk(r),e=this.apportion(r,e);this.executeShifts(t);var s=t.getLeftMostChild(),o=t.getRightMostChild(),s=(s.preX+o.preX)/2;(i=t.getLeftSibling())?(t.preX=i.preX+1,t.mod=t.preX-s):t.preX=s}else(i=t.getLeftSibling())?(t.preX=i.preX+1,t.mod=t.preX):t.preX=0}secondWalk(e,t){e.yPosition=e.preX+t,e.xPosition=e.level;for(const i of e.children)this.secondWalk(i,t+e.mod)}executeShifts(t){let i=0,s=0;for(let e=t.children.length-1;0<=e;e--){const o=t.children[e];o.preX+=i,o.mod+=i,s+=o.change,i+=o.shift+s}}apportion(l,h){var d=l.getLeftSibling();if(d){let e=l,t=l,i=d,s=e.getLeftMostSibling(),o=e.mod,r=t.mod,n=i.mod,a=s.mod;for(;i&&i.nextRight()&&e&&e.nextLeft();){i=i.nextRight(),s=s.nextLeft(),e=e.nextLeft(),(t=t.nextRight()).ancestor=l;var p=i.preX+n-(e.preX+o)+1;0<p&&(this.moveSubtree(l.getAncestor(i,h),l,p),o+=p,r+=p),n+=i.mod,o+=e.mod,a+=s.mod,r+=t.mod}i&&i.nextRight()&&!t.nextRight()&&(t.thread=i.nextRight(),t.mod+=n-r),e&&e.nextLeft()&&!s.nextLeft()&&(s.thread=e.nextLeft(),s.mod+=o-a),h=l}return h}moveSubtree(e,t,i){var s=t.relativeXPosition-e.relativeXPosition;t.change-=i/s,t.shift+=i,t.preX+=i,t.mod+=i,e.change+=i/s}afterLayout(e){for(const t of e)t.oldParentNode&&(t.relativeXPosition=t.parentNode.relativeXPosition,t.parent=t.oldParentNode.parent,t.parentNode=t.oldParentNode,delete t.oldParentNode.children[t.relativeXPosition],(t.oldParentNode.children[t.relativeXPosition]=t).oldParentNode=void 0)}}return o}),t(e,"Series/Treegraph/TreegraphSeriesDefaults.js",[],function(){return{reversed:!1,marker:{radius:10,lineWidth:0,symbol:"circle",fillOpacity:1,states:{}},link:{color:"#666666",lineWidth:1,radius:10,cursor:"default",type:"curved"},collapseButton:{onlyOnHover:!0,enabled:!0,lineWidth:1,x:0,y:0,height:18,width:18,shape:"circle",style:{cursor:"pointer",fontWeight:"bold",fontSize:"1em"}},fillSpace:!1,tooltip:{linkFormat:"{point.fromNode.id} â†’ {point.toNode.id}",pointFormat:"{point.id}"},dataLabels:{defer:!0,linkTextPath:{attributes:{startOffset:"50%"}},enabled:!0,linkFormatter:()=>"",style:{textOverflow:"none"}}}}),t(e,"Series/Treegraph/TreegraphSeries.js",[e["Series/PathUtilities.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Renderer/SVG/SVGRenderer.js"],e["Series/Treegraph/TreegraphNode.js"],e["Series/Treegraph/TreegraphPoint.js"],e["Series/TreeUtilities.js"],e["Core/Utilities.js"],e["Series/Treegraph/TreegraphLink.js"],e["Series/Treegraph/TreegraphLayout.js"],e["Series/Treegraph/TreegraphSeriesDefaults.js"]],function(e,t,i,s,o,r,n,a,l,h){const g=e["getLinkPath"],{series:{prototype:d},seriesTypes:{treemap:p,column:c}}=t,{symbols:P}=i["prototype"],u=r["getLevelOptions"],{extend:T,merge:S,pick:C,relativeLength:k,splat:f}=n;class v extends p{constructor(){super(...arguments),this.data=void 0,this.options=void 0,this.points=void 0,this.layoutModifier=void 0,this.nodeMap=void 0,this.tree=void 0,this.nodeList=[],this.layoutAlgorythm=void 0,this.links=[],this.mapOptionsToLevel=void 0}init(){super.init.apply(this,arguments),this.layoutAlgorythm=new l}getLayoutModifiers(){const e=this.chart,h=this,d=e.plotSizeX,p=e.plotSizeY;let c=1/0,u=-1/0,g=1/0,f=-1/0,v=0,y=0,m=0,b=0;this.points.forEach(t=>{if(!this.options.fillSpace||t.visible){const i=t.node,s=h.mapOptionsToLevel[t.node.level]||{},o=S(this.options.marker,s.marker,t.options.marker),r=k(o.radius||0,Math.min(d,p)),n=o.symbol,a="circle"!==n&&o.height?k(o.height,p):2*r,l="circle"!==n&&o.width?k(o.width,d):2*r;i.nodeSizeX=l,i.nodeSizeY=a;let e;i.xPosition<=c&&(c=i.xPosition,e=o.lineWidth||0,y=Math.max(l+e,y)),i.xPosition>=u&&(u=i.xPosition,e=o.lineWidth||0,v=Math.max(l+e,v)),i.yPosition<=g&&(g=i.yPosition,e=o.lineWidth||0,b=Math.max(a+e,b)),i.yPosition>=f&&(f=i.yPosition,e=o.lineWidth||0,m=Math.max(a+e,m))}});var t=f===g?1:(p-(b+m)/2)/(f-g),i=f===g?p/2:-t*g+b/2,s=u===c?1:(d-(v+v)/2)/(u-c);return{ax:s,bx:u===c?d/2:-s*c+y/2,ay:t,by:i}}getLinks(){const s=this,o=[];return this.data.forEach((e,t)=>{var i=s.mapOptionsToLevel[e.node.level||0]||{};e.node.parent?(i=S(i,e.options),!e.linkToParent||e.linkToParent.destroyed?(i=(new s.LinkClass).init(s,i,void 0,e),e.linkToParent=i):(e.collapsed=C(e.collapsed,(this.mapOptionsToLevel[e.node.level]||{}).collapsed),e.linkToParent.visible=e.linkToParent.toNode.visible),e.linkToParent.index=o.push(e.linkToParent)-1):e.linkToParent&&(s.links.splice(e.linkToParent.index),e.linkToParent.destroy(),delete e.linkToParent)}),o}buildTree(e,t,i,s,o){var r=this.points[t];return i=r&&r.level||i,super.buildTree.call(this,e,t,i,s,o)}markerAttribs(){return{}}setCollapsedStatus(e,t){const i=e.point;i&&(i.collapsed=C(i.collapsed,(this.mapOptionsToLevel[e.level]||{}).collapsed),t=!1!==(i.visible=t)&&!i.collapsed),e.children.forEach(e=>{this.setCollapsedStatus(e,t)})}drawTracker(){c.prototype.drawTracker.apply(this,arguments),c.prototype.drawTracker.call(this,this.links)}translate(){var e=this,t=e.options;let i=r.updateRootId(e),s;d.translate.call(e);var o=e.tree=e.getTree();s=e.nodeMap[i],""===i||s&&s.children.length||(e.setRootNode("",!1),i=e.rootNode,s=e.nodeMap[i]),e.mapOptionsToLevel=u({from:s.level+1,levels:t.levels,to:o.height,defaults:{levelIsConstant:e.options.levelIsConstant,colorByPoint:t.colorByPoint}}),this.setCollapsedStatus(o,!0),e.links=e.getLinks(),e.setTreeValues(o),this.layoutAlgorythm.calculatePositions(e),e.layoutModifier=this.getLayoutModifiers(),this.points.forEach(e=>{this.translateNode(e)}),this.points.forEach(e=>{e.linkToParent&&this.translateLink(e.linkToParent)}),t.colorByPoint||e.setColorRecursive(e.tree)}translateLink(i){var s=i.fromNode,o=i.toNode,r=this.options.link.lineWidth,n=Math.round(r)%2/2,a=C(this.options.link.curveFactor,.5),l=C(i.options.link&&i.options.link.type,this.options.link.type);if(s.shapeArgs&&o.shapeArgs){var h=s.shapeArgs.width||0,d=this.chart.inverted,p=Math.floor((s.shapeArgs.y||0)+(s.shapeArgs.height||0)/2)+n,c=Math.floor((o.shapeArgs.y||0)+(o.shapeArgs.height||0)/2)+n;let e=Math.floor((s.shapeArgs.x||0)+h)+n,t=Math.floor(o.shapeArgs.x||0)+n;d&&(e-=h,t+=o.shapeArgs.width||0);var s=o.node.xPosition-s.node.xPosition,u=(i.shapeType="path",Math.abs(t-e)+h),u=u/s-h,s=u*a*(d?-1:1),h=Math.floor((t+e)/2)+n;i.plotX=h,i.plotY=c,i.shapeArgs={d:g[l]({x1:e,y1:p,x2:t,y2:c,width:u,offset:s,inverted:d,parentVisible:o.visible,radius:this.options.link.radius})},i.dlBox={x:(e+t)/2,y:(p+c)/2,height:r,width:0},i.tooltipPos=d?[(this.chart.plotSizeY||0)-i.dlBox.y,(this.chart.plotSizeX||0)-i.dlBox.x]:[i.dlBox.x,i.dlBox.y]}}drawNodeLabels(e){var t=this.mapOptionsToLevel;let i,s;for(const o of e)s=t[o.node.level],i={style:{}},s&&s.dataLabels&&(i=S(i,s.dataLabels),this.hasDataLabels=()=>!0),o.shapeArgs&&!f(this.options.dataLabels)[0].style.width&&(i.style.width=o.shapeArgs.width,o.dataLabel&&o.dataLabel.css({width:o.shapeArgs.width+"px"})),o.dlOptions=S(i,o.options.dataLabels);d.drawDataLabels.call(this,e)}alignDataLabel(e,t){const i=e.visible;e.visible=!0,super.alignDataLabel.apply(this,arguments),t.animate({opacity:!1===i?0:1},void 0,function(){i||t.hide()}),e.visible=i}drawDataLabels(){this.options.dataLabels&&(this.options.dataLabels=f(this.options.dataLabels),this.drawNodeLabels(this.points),d.drawDataLabels.call(this,this.links))}destroy(){if(this.links){for(const e of this.links)e.destroy();this.links.length=0}return d.destroy.apply(this,arguments)}pointAttribs(e,t){var i=this,s=e&&i.mapOptionsToLevel[e.node.level||0]||{},o=e&&e.options,r=s.states&&s.states[t]||{};e&&(e.options.marker=S(i.options.marker,s.marker,e.options.marker));const n=C(r&&r.link&&r.link.color,o&&o.link&&o.link.color,s&&s.link&&s.link.color,i.options.link&&i.options.link.color),a=C(r&&r.link&&r.link.lineWidth,o&&o.link&&o.link.lineWidth,s&&s.link&&s.link.lineWidth,i.options.link&&i.options.link.lineWidth),l=d.pointAttribs.call(i,e,t);return e&&(e.isLink&&(l.stroke=n,l["stroke-width"]=a,delete l.fill),e.visible||(l.opacity=0)),l}drawPoints(){p.prototype.drawPoints.apply(this,arguments),c.prototype.drawPoints.call(this,this.links)}translateNode(e){const t=this.chart,i=e.node,s=t.plotSizeY,o=t.plotSizeX,{ax:r,bx:n,ay:a,by:l}=this.layoutModifier,h=r*i.xPosition+n,d=a*i.yPosition+l,p=this.mapOptionsToLevel[i.level]||{},c=S(this.options.marker,p.marker,e.options.marker),u=c.symbol,g=i.nodeSizeY,f=i.nodeSizeX,v=this.options.reversed,y=i.x=t.inverted?o-f/2-h:h-f/2,m=i.y=v?d-g/2:s-d-g/2,b=C(e.options.borderRadius,p.borderRadius,this.options.borderRadius),k=P[u||"circle"];if(void 0===k?(e.hasImage=!0,e.shapeType="image",e.imageUrl=u.match(/^url\((.*?)\)$/)[1]):e.shapeType="path",!e.visible&&e.linkToParent){var L=e.linkToParent.fromNode;if(L){const x=L.shapeArgs||{},{x:h=0,y:d=0,width:f=0,height:g=0}=x;e.shapeArgs||(e.shapeArgs={}),e.hasImage||T(e.shapeArgs,{d:k(h,d,f,g,b?{r:b}:void 0)}),T(e.shapeArgs,{x:h,y:d}),e.plotX=L.plotX,e.plotY=L.plotY}}else e.plotX=y,e.plotY=m,e.shapeArgs={x:y,y:m,width:f,height:g,cursor:e.node.isLeaf?"default":"pointer"},e.hasImage||(e.shapeArgs.d=k(y,m,f,g,b?{r:b}:void 0));e.tooltipPos=t.inverted?[s-m-g/2,o-y-f/2]:[y+f/2,m]}}return v.defaultOptions=S(p.defaultOptions,h),T(v.prototype,{pointClass:o,NodeClass:s,LinkClass:a}),t.registerSeriesType("treegraph",v),v}),t(e,"masters/modules/treegraph.src.js",[],function(){})});