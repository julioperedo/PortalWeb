!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){function t(e,t,a,o){e.hasOwnProperty(t)||(e[t]=o.apply(null,a))}t(e=e?e._modules:{},"mixins/ajax.js",[e["parts/Globals.js"],e["parts/Utilities.js"]],function(a,e){var o=e.merge,n=e.objectEach;a.ajax=function(e){var t=o(!0,{url:!1,type:"get",dataType:"json",success:!1,error:!1,data:!1,headers:{}},e);e={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"};var a=new XMLHttpRequest;if(!t.url)return!1;a.open(t.type.toUpperCase(),t.url,!0),t.headers["Content-Type"]||a.setRequestHeader("Content-Type",e[t.dataType]||e.text),n(t.headers,function(e,t){a.setRequestHeader(t,e)}),a.onreadystatechange=function(){if(4===a.readyState){if(200===a.status){var e=a.responseText;if("json"===t.dataType)try{e=JSON.parse(e)}catch(e){return void(t.error&&t.error(a,e))}return t.success&&t.success(e)}t.error&&t.error(a,a.responseText)}};try{t.data=JSON.stringify(t.data)}catch(e){}a.send(t.data||!0)},a.getJSON=function(e,t){a.ajax({url:e,success:t,dataType:"json",headers:{"Content-Type":"text/plain"}})}}),t(e,"mixins/download-url.js",[e["parts/Globals.js"]],function(n){var r=n.win,i=r.navigator,s=r.document,l=r.URL||r.webkitURL||r,p=/Edge\/\d+/.test(i.userAgent);n.dataURLtoBlob=function(e){if((e=e.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<e.length&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&l.createObjectURL){for(var t=r.atob(e[3]),a=new r.ArrayBuffer(t.length),a=new r.Uint8Array(a),o=0;o<a.length;++o)a[o]=t.charCodeAt(o);return e=new r.Blob([a],{type:e[1]}),l.createObjectURL(e)}},n.downloadURL=function(t,e){var a=s.createElement("a");if("string"==typeof t||t instanceof String||!i.msSaveOrOpenBlob){if((p||2e6<t.length)&&!(t=n.dataURLtoBlob(t)))throw Error("Failed to convert to blob");if(void 0!==a.download)a.href=t,a.download=e,s.body.appendChild(a),a.click(),s.body.removeChild(a);else try{var o=r.open(t,"chart");if(null==o)throw Error("Failed to open window")}catch(e){r.location.href=t}}else i.msSaveOrOpenBlob(t,e)}}),t(e,"modules/export-data.src.js",[e["parts/Axis.js"],e["parts/Chart.js"],e["parts/Globals.js"],e["parts/Utilities.js"]],function(c,e,t,a){function o(e,t){var a=i.navigator,o=-1<a.userAgent.indexOf("WebKit")&&a.userAgent.indexOf("Chrome")<0,n=i.URL||i.webkitURL||i;try{if(a.msSaveOrOpenBlob&&i.MSBlobBuilder){var r=new i.MSBlobBuilder;return r.append(e),r.getBlob("image/svg+xml")}if(!o)return n.createObjectURL(new i.Blob(["\ufeff"+e],{type:t}))}catch(e){}}var n=t.doc,r=t.seriesTypes,i=t.win,s=a.addEvent,d=a.defined,l=a.extend,S=a.find,h=a.fireEvent,p=a.getOptions,A=a.isNumber,C=a.pick;a=a.setOptions;var u=t.downloadURL;a({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table"}}),s(e,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}),e.prototype.setUpKeyToAxis=function(){r.arearange&&(r.arearange.prototype.keyToAxis={low:"y",high:"y"}),r.gantt&&(r.gantt.prototype.keyToAxis={start:"x",end:"x"})},e.prototype.getDataRows=function(u){function a(e,t,a){if(g.columnHeaderFormatter){var o=g.columnHeaderFormatter(e,t,a);if(!1!==o)return o}return e?e instanceof c?e.options.title&&e.options.title.text||(e.dateTime?r:n):u?{columnTitle:1<a?t:e.name,topLevelColumnTitle:e.name}:e.name+(1<a?" ("+t+")":""):n}function f(a,e,o){var n={},r={};return e.forEach(function(e){var t=(a.keyToAxis&&a.keyToAxis[e]||e)+"Axis",t=A(o)?a.chart[t][o]:a[t];n[e]=t&&t.categories||[],r[e]=t&&t.dateTime}),{categoryMap:n,dateTimeValueAxisMap:r}}var o,m=this.hasParallelCoordinates,x=this.time,g=this.options.exporting&&this.options.exporting.csv||{},y=this.xAxis,b={},e=[],v=[],w=[],t=this.options.lang.exportData,n=t.categoryHeader,r=t.categoryDatetimeHeader,T=[],D=0;for(i in this.setUpKeyToAxis(),this.series.forEach(function(n){var r,e,t,i=n.xAxis,s=n.options.keys||(t=i,(e=n).data.filter(function(e){return e.name}).length&&t&&!t.categories&&!e.keyToAxis?e.pointArrayMap&&e.pointArrayMap.filter(function(e){return"x"===e}).length?(e.pointArrayMap.unshift("x"),e.pointArrayMap):["x","y"]:e.pointArrayMap||["y"]),l=s.length,p=!n.requireSorting&&{},c=y.indexOf(i),d=f(n,s);if(!1!==n.options.includeInDataExport&&!n.options.isInternal&&!1!==n.visible){for(S(T,function(e){return e[0]===c})||T.push([c,D]),r=0;r<l;)o=a(n,s[r],s.length),w.push(o.columnTitle||o),u&&v.push(o.topLevelColumnTitle||o),r++;var h={chart:n.chart,autoIncrement:n.autoIncrement,options:n.options,pointArrayMap:n.pointArrayMap};n.options.data.forEach(function(e,t){m&&(d=f(n,s,t));var a={series:h};n.pointClass.prototype.applyOptions.apply(a,[e]),e=a.x;var o=n.data[t]&&n.data[t].name;for(r=0,(!i||"name"===n.exportKey||!m&&i&&i.hasNames&&o)&&(e=o),p&&(p[e]&&(e+="|"+t),p[e]=!0),b[e]||(b[e]=[],b[e].xValues=[]),b[e].x=a.x,b[e].name=o,b[e].xValues[c]=a.x;r<l;)o=a[t=s[r]],b[e][D+r]=C(d.categoryMap[t][o],d.dateTimeValueAxisMap[t]?x.dateFormat(g.dateFormat,o):null,o),r++}),D+=r}}),b)Object.hasOwnProperty.call(b,i)&&e.push(b[i]);for(var i=u?[v,w]:[w],D=T.length;D--;){var s=T[D][0],l=T[D][1],p=y[s];e.sort(function(e,t){return e.xValues[s]-t.xValues[s]}),t=a(p),i[0].splice(l,0,t),u&&i[1]&&i[1].splice(l,0,t),e.forEach(function(e){var t=e.name;p&&!d(t)&&(t=p.dateTime?(e.x instanceof Date&&(e.x=e.x.getTime()),x.dateFormat(g.dateFormat,e.x)):p.categories?C(p.names[e.x],p.categories[e.x],e.x):e.x),e.splice(l,0,t)})}return i=i.concat(e),h(this,"exportData",{dataRows:i}),i},e.prototype.getCSV=function(e){var n="",r=this.getDataRows(),t=this.options.exporting.csv,i=C(t.decimalPoint,","!==t.itemDelimiter&&e?1.1.toLocaleString()[1]:"."),s=C(t.itemDelimiter,","===i?";":","),l=t.lineDelimiter;return r.forEach(function(e,t){for(var a,o=e.length;o--;)"string"==typeof(a=e[o])&&(a='"'+a+'"'),"number"==typeof a&&"."!==i&&(a=a.toString().replace(".",i)),e[o]=a;n+=e.join(s),t<r.length-1&&(n+=l)}),n},e.prototype.getTable=function(e){var a='<table id="highcharts-data-table-'+this.index+'">',l=this.options,r=e?1.1.toLocaleString()[1]:".",p=C(l.exporting.useMultiLevelHeaders,!0);e=this.getDataRows(p);function c(e,t,a,o){var n=C(o,"");return t="text"+(t?" "+t:""),"number"==typeof n?(n=n.toString(),","===r&&(n=n.replace(".",r)),t="number"):o||(t="empty"),"<"+e+(a?" "+a:"")+' class="'+t+'">'+n+"</"+e+">"}var o=0,t=p?e.shift():null,n=e.shift();!1!==l.exporting.tableCaption&&(a+='<caption class="highcharts-table-caption">'+C(l.exporting.tableCaption,l.title.text?l.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var i=0,s=e.length;i<s;++i)e[i].length>o&&(o=e[i].length);return a+=function(e,t,a){var o="<thead>",n=0;a=a||t&&t.length;var r,i=0;if(r=p&&e&&t){e:if(r=e.length,t.length===r){for(;r--;)if(e[r]!==t[r]){r=!1;break e}r=!0}else r=!1;r=!r}if(r){for(o+="<tr>";n<a;++n){r=e[n];var s=e[n+1];r===s?++i:i?(o+=c("th","highcharts-table-topheading",'scope="col" colspan="'+(i+1)+'"',r),i=0):(r===t[n]?l.exporting.useRowspanHeaders?(s=2,delete t[n]):(s=1,t[n]=""):s=1,o+=c("th","highcharts-table-topheading",'scope="col"'+(1<s?' valign="top" rowspan="'+s+'"':""),r))}o+="</tr>"}if(t){for(o+="<tr>",n=0,a=t.length;n<a;++n)void 0!==t[n]&&(o+=c("th",null,'scope="col"',t[n]));o+="</tr>"}return o+"</thead>"}(t,n,Math.max(o,n.length)),a+="<tbody>",e.forEach(function(e){a+="<tr>";for(var t=0;t<o;t++)a+=c(t?"td":"th",null,t?"":'scope="row"',e[t]);a+="</tr>"}),h(this,"afterGetTable",e={html:a+="</tbody></table>"}),e.html},e.prototype.downloadCSV=function(){var e=this.getCSV(!0);u(o(e,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(e),this.getFilename()+".csv")},e.prototype.downloadXLS=function(){var e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";u(o(e,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+i.btoa(unescape(encodeURIComponent(e))),this.getFilename()+".xls")},e.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=n.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv.innerHTML=this.getTable(),h(this,"afterViewData",this.dataTableDiv)},(e=p().exporting)&&(l(e.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}}}),e.buttons&&e.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),r.map&&(r.map.prototype.exportKey="name"),r.mapbubble&&(r.mapbubble.prototype.exportKey="name"),r.treemap&&(r.treemap.prototype.exportKey="name")}),t(e,"masters/modules/export-data.src.js",[],function(){})});