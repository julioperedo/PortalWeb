!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/series-label",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,r,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,r))}e(t=t?t._modules:{},"modules/series-label.src.js",[t["parts/Chart.js"],t["parts/Globals.js"],t["parts/SVGRenderer.js"],t["parts/Utilities.js"]],function(t,e,r,o){function s(t,e,r,o,a,i){return 0<(t=(i-e)*(r-t)-(o-e)*(a-t))||!(t<0)}function l(t,e,r,o,a,i,h,n){return s(t,e,a,i,h,n)!==s(r,o,a,i,h,n)&&s(t,e,r,o,a,i)!==s(t,e,r,o,h,n)}function g(t,e,r,o,a,i,h,n){return l(t,e,t+r,e,a,i,h,n)||l(t+r,e,t+r,e+o,a,i,h,n)||l(t,e+o,t+r,e+o,a,i,h,n)||l(t,e,t,e+o,a,i,h,n)}function a(a){var i,h;this.renderer&&(h=Y((i=this).renderer.globalAnimation).duration,i.labelSeries=[],i.labelSeriesMaxSum=0,o.clearTimeout(i.seriesLabelTimer),i.series.forEach(function(t){var e=t.options.label,r=t.labelBySeries,o=r&&r.closest;e.enabled&&t.visible&&(t.graph||t.area)&&!t.isSeriesBoosting&&(i.labelSeries.push(t),e.minFontSize&&e.maxFontSize&&(t.sum=t.yData.reduce(function(t,e){return(t||0)+(e||0)},0),i.labelSeriesMaxSum=Math.max(i.labelSeriesMaxSum,t.sum)),"load"===a.type&&(h=Math.max(h,Y(t.options.animation).duration)),o&&(void 0!==o[0].plotX?r.animate({x:o[0].plotX+o[1],y:o[0].plotY+o[2]}):r.attr({opacity:0})))}),i.seriesLabelTimer=c(function(){i.series&&i.labelSeries&&i.drawSeriesLabels()},i.renderer.forExport||!h?0:h))}var i=o.addEvent,Y=o.animObject,X=o.extend,h=o.fireEvent,w=o.format,f=o.isNumber,M=o.pick,n=o.setOptions,c=o.syncTimeout;e=e.Series,n({plotOptions:{series:{label:{enabled:!0,connectorAllowed:!1,connectorNeighbourDistance:24,format:void 0,formatter:void 0,minFontSize:null,maxFontSize:null,onArea:null,style:{fontWeight:"bold"},boxesToAvoid:[]}}}}),r.prototype.symbols.connector=function(t,e,r,o,a){var i=a&&a.anchorX;a=a&&a.anchorY;var h,n,s=r/2;return f(i)&&f(a)&&(h=[["M",i,a]],(n=e-a)<0&&(n=-o-n),n<r&&(s=i<t+r/2?n:r-n),e+o<a?h.push(["L",t+s,e+o]):a<e?h.push(["L",t+s,e]):i<t?h.push(["L",t,e+o/2]):t+r<i&&h.push(["L",t+r,e+o/2])),h||[]},e.prototype.getPointsOnGraph=function(){function t(t){var e=Math.round(t.plotX/8)+","+Math.round(t.plotY/8);p[e]||(p[e]=1,o.push(t))}if(this.xAxis||this.yAxis){var e,r=this.points,o=[],a=this.graph||this.area,i=a.element,h=this.chart.inverted,n=this.xAxis,s=this.yAxis,l=h?s.pos:n.pos,h=h?n.pos:s.pos,n=M(this.options.label.onArea,!!this.area),c=s.getThreshold(this.options.threshold),p={};if(this.getPointSpline&&i.getPointAtLength&&!n&&r.length<this.chart.plotSizeX/16){a.toD&&(e=a.attr("d"),a.attr({d:a.toD}));for(var d=i.getTotalLength(),u=0;u<d;u+=16)t({chartX:l+(s=i.getPointAtLength(u)).x,chartY:h+s.y,plotX:s.x,plotY:s.y});e&&a.attr({d:e}),(s=r[r.length-1]).chartX=l+s.plotX,s.chartY=h+s.plotY,t(s)}else for(d=r.length,u=0;u<d;u+=1){if(s=r[u],e=r[u-1],s.chartX=l+s.plotX,s.chartY=h+s.plotY,n&&(s.chartCenterY=h+(s.plotY+M(s.yBottom,c))/2),0<u&&(a=Math.abs(s.chartX-e.chartX),i=Math.abs(s.chartY-e.chartY),16<(a=Math.max(a,i))))for(a=Math.ceil(a/16),i=1;i<a;i+=1)t({chartX:e.chartX+i/a*(s.chartX-e.chartX),chartY:e.chartY+i/a*(s.chartY-e.chartY),chartCenterY:e.chartCenterY+i/a*(s.chartCenterY-e.chartCenterY),plotX:e.plotX+i/a*(s.plotX-e.plotX),plotY:e.plotY+i/a*(s.plotY-e.plotY)});f(s.plotY)&&t(s)}return o}},e.prototype.labelFontSize=function(t,e){return t+this.sum/this.chart.labelSeriesMaxSum*(e-t)+"px"},e.prototype.checkClearPoint=function(t,e,r,o){for(var a,i,h,n=Number.MAX_VALUE,s=Number.MAX_VALUE,l=M(this.options.label.onArea,!!this.area),c=l||this.options.label.connectorAllowed,p=this.chart,d=0;d<p.boxesToAvoid.length;d+=1){var u=p.boxesToAvoid[d],f=t+r.width,x=e,b=e+r.height;if(!(t>u.right||f<u.left||x>u.bottom||b<u.top))return!1}for(d=0;d<p.series.length;d+=1)if(u=(x=p.series[d]).interpolatedPoints,x.visible&&u){for(f=1;f<u.length;f+=1){if(u[f].chartX>=t-16&&u[f-1].chartX<=t+r.width+16){if(g(t,e,r.width,r.height,u[f-1].chartX,u[f-1].chartY,u[f].chartX,u[f].chartY))return!1;this===x&&!h&&o&&(h=g(t-16,e-16,r.width+32,r.height+32,u[f-1].chartX,u[f-1].chartY,u[f].chartX,u[f].chartY))}!c&&!h||this===x&&!l||(b=t+r.width/2-u[f].chartX,a=e+r.height/2-u[f].chartY,n=Math.min(n,b*b+a*a))}if(!l&&c&&this===x&&(o&&!h||n<Math.pow(this.options.label.connectorNeighbourDistance,2))){for(f=1;f<u.length;f+=1){(h=Math.min(Math.pow(t+r.width/2-u[f].chartX,2)+Math.pow(e+r.height/2-u[f].chartY,2),Math.pow(t-u[f].chartX,2)+Math.pow(e-u[f].chartY,2),Math.pow(t+r.width-u[f].chartX,2)+Math.pow(e-u[f].chartY,2),Math.pow(t+r.width-u[f].chartX,2)+Math.pow(e+r.height-u[f].chartY,2),Math.pow(t-u[f].chartX,2)+Math.pow(e+r.height-u[f].chartY,2)))<s&&(s=h,i=u[f])}h=!0}}return!(o&&!h)&&{x:t,y:e,weight:n-(i?s:0),connectorPoint:i}},t.prototype.drawSeriesLabels=function(){var y=this,t=this.labelSeries;y.boxesToAvoid=[],t.forEach(function(t){t.interpolatedPoints=t.getPointsOnGraph(),(t.options.label.boxesToAvoid||[]).forEach(function(t){y.boxesToAvoid.push(t)})}),y.series.forEach(function(t){function e(t,e,r){var o=Math.max(s,M(i,-1/0)),a=Math.min(s+c,M(h,1/0));return o<t&&t<=a-r.width&&l<=e&&e<=l+p-r.height}var r=t.options.label;if(r&&(t.xAxis||t.yAxis)){var o,a,i,h,n=[],s=(a=y.inverted)?t.yAxis.pos:t.xAxis.pos,l=a?t.xAxis.pos:t.yAxis.pos,c=y.inverted?t.yAxis.len:t.xAxis.len,p=y.inverted?t.xAxis.len:t.yAxis.len,d=t.interpolatedPoints,u=M(r.onArea,!!t.area),f=t.labelBySeries,x=!f,b=r.minFontSize,g=r.maxFontSize,m="highcharts-color-"+M(t.colorIndex,"none");if(u&&!a&&(a=[t.xAxis.toPixels(t.xData[0]),t.xAxis.toPixels(t.xData[t.xData.length-1])],i=Math.min.apply(Math,a),h=Math.max.apply(Math,a)),t.visible&&!t.isSeriesBoosting&&d){for(f||(f=t.name,"string"==typeof r.format?f=w(r.format,t,y):r.formatter&&(f=r.formatter.call(t)),t.labelBySeries=f=y.renderer.label(f,0,-9999,"connector").addClass("highcharts-series-label highcharts-series-label-"+t.index+" "+(t.options.className||"")+" "+m),y.renderer.styledMode||(f.css(X({color:u?y.renderer.getContrast(t.color):t.color},r.style||{})),f.attr({opacity:y.renderer.forExport?1:0,stroke:t.color,"stroke-width":1})),b&&g&&f.css({fontSize:t.labelFontSize(b,g)}),f.attr({padding:0,zIndex:3}).add()),(b=f.getBBox()).width=Math.round(b.width),a=d.length-1;0<a;--a)u?e(g=d[a].chartX-b.width/2,m=d[a].chartCenterY-b.height/2,b)&&(o=t.checkClearPoint(g,m,b)):(e(g=d[a].chartX+3,m=d[a].chartY-b.height-3,b)&&(o=t.checkClearPoint(g,m,b,!0)),o&&n.push(o),e(g=d[a].chartX+3,m=d[a].chartY+3,b)&&(o=t.checkClearPoint(g,m,b,!0)),o&&n.push(o),e(g=d[a].chartX-b.width-3,m=d[a].chartY+3,b)&&(o=t.checkClearPoint(g,m,b,!0)),o&&n.push(o),e(g=d[a].chartX-b.width-3,m=d[a].chartY-b.height-3,b)&&(o=t.checkClearPoint(g,m,b,!0))),o&&n.push(o);if(r.connectorAllowed&&!n.length&&!u)for(g=s+c-b.width;s<=g;g-=16)for(m=l;m<l+p-b.height;m+=16)(o=t.checkClearPoint(g,m,b,!0))&&n.push(o);n.length?(n.sort(function(t,e){return e.weight-t.weight}),o=n[0],y.boxesToAvoid.push({left:o.x,right:o.x+b.width,top:o.y,bottom:o.y+b.height}),(d=Math.sqrt(Math.pow(Math.abs(o.x-(f.x||0)),2)+Math.pow(Math.abs(o.y-(f.y||0)),2)))&&t.labelBySeries&&(n={opacity:y.renderer.forExport?1:0,x:o.x,y:o.y},r={opacity:1},d<=10&&(r={x:n.x,y:n.y},n={}),d=void 0,x&&((d=Y(t.options.animation)).duration*=.2),t.labelBySeries.attr(X(n,{anchorX:o.connectorPoint&&o.connectorPoint.plotX+s,anchorY:o.connectorPoint&&o.connectorPoint.plotY+l})).animate(r,d),t.options.kdNow=!0,t.buildKDTree(),t=t.searchPoint({chartX:o.x,chartY:o.y},!0))&&(f.closest=[t,o.x-(t.plotX||0),o.y-(t.plotY||0)])):f&&(t.labelBySeries=f.destroy())}else f&&(t.labelBySeries=f.destroy())}}),h(y,"afterDrawSeriesLabels")},i(t,"load",a),i(t,"redraw",a)}),e(t,"masters/modules/series-label.src.js",[],function(){})});