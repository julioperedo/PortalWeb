"use strict";import U from"../Core/Utilities.js";const{addEvent,pick}=U;var FocusBorderComposition;!function(o){const r=[],H=["x","y","transform","width","height","r","d","stroke-width"];function i(){const o=this.focusElement,t=this.options.accessibility.keyboardNavigation.focusBorder;o&&(o.removeFocusBorder(),t.enabled&&o.addFocusBorder(t.margin,{stroke:t.style.color,strokeWidth:t.style.lineWidth,r:t.style.borderRadius}))}function d(o,t){const e=this.options.accessibility.keyboardNavigation.focusBorder,s=t||o.element;s&&s.focus&&(s.hcEvents&&s.hcEvents.focusin||addEvent(s,"focusin",function(){}),s.focus(),e.hideBrowserFocusOutline&&(s.style.outline="none")),this.focusElement&&this.focusElement.removeFocusBorder(),this.focusElement=o,this.renderFocusBorder()}function c(o,t){this.focusBorder&&this.removeFocusBorder();const e=this.getBBox(),s=pick(o,3),r=this.parentGroup,i=this.scaleX||r&&r.scaleX,d=this.scaleY||r&&r.scaleY,c=i?!d:d,n=c?Math.abs(i||d||1):(Math.abs(i||1)+Math.abs(d||1))/2;e.x+=this.translateX||0,e.y+=this.translateY||0;let u=e.x-s,a=e.y-s,h=e.width+2*s,f=e.height+2*s;var l,B,y,p,k,m,v=!!this.text,F=("text"!==this.element.nodeName&&!v||(l=!!this.rotation,B=v?{x:l?1:0,y:0}:function(o){let t=0,e=0;return"middle"===o.attr("text-anchor")?t=e=.5:o.rotation?t=.25:e=.75,{x:t,y:e}}(this),y=+this.attr("x"),p=+this.attr("y"),isNaN(y)||(u=y-e.width*B.x-s),isNaN(p)||(a=p-e.height*B.y-s),v&&l&&(v=h,h=f,f=v,isNaN(y)||(u=y-e.height*B.x-s),isNaN(p)||(a=p-e.width*B.y-s))),this.focusBorder=this.renderer.rect(u,a,h,f,parseInt((t&&t.r||0).toString(),10)/n).addClass("highcharts-focus-border").attr({zIndex:99}).add(r),this.renderer.styledMode||this.focusBorder.attr({stroke:t&&t.stroke,"stroke-width":(t&&t.strokeWidth||0)/n}),m=[o,t],(k=this).focusBorderUpdateHooks||(k.focusBorderUpdateHooks={},H.forEach(o=>{o+="Setter";const t=k[o]||k._defaultSetter;k.focusBorderUpdateHooks[o]=t,k[o]=function(){var o=t.apply(k,arguments);return k.addFocusBorder.apply(k,m),o}})),this);if(!F.focusBorderDestroyHook){const x=F.destroy;F.destroy=function(){return F.focusBorder&&F.focusBorder.destroy&&F.focusBorder.destroy(),x.apply(F,arguments)},F.focusBorderDestroyHook=x}}function n(){var e,o;(e=this).focusBorderUpdateHooks&&(Object.keys(e.focusBorderUpdateHooks).forEach(o=>{var t=e.focusBorderUpdateHooks[o];t===e._defaultSetter?delete e[o]:e[o]=t}),delete e.focusBorderUpdateHooks),(o=this).focusBorderDestroyHook&&(o.destroy=o.focusBorderDestroyHook,delete o.focusBorderDestroyHook),this.focusBorder&&(this.focusBorder.destroy(),delete this.focusBorder)}o.compose=function(o,t){if(U.pushUnique(r,o)){const e=o.prototype;e.renderFocusBorder=i,e.setFocusToElement=d}if(U.pushUnique(r,t)){const s=t.prototype;s.addFocusBorder=c,s.removeFocusBorder=n}}}(FocusBorderComposition=FocusBorderComposition||{});export default FocusBorderComposition;