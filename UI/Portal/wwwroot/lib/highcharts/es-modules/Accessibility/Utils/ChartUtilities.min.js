"use strict";import H from"../../Core/Globals.js";const doc=H["doc"];import HU from"./HTMLUtilities.js";const stripHTMLTags=HU["stripHTMLTagsFromString"];import U from"../../Core/Utilities.js";const{defined,find,fireEvent}=U;function fireEventOnWrappedOrUnwrappedElement(e,t){var i=t.type,n=e.hcEvents;doc.createEvent&&(e.dispatchEvent||e.fireEvent)?e.dispatchEvent?e.dispatchEvent(t):e.fireEvent(i,t):n&&n[i]?fireEvent(e,i,t):e.element&&fireEventOnWrappedOrUnwrappedElement(e.element,t)}function getChartTitle(e){return stripHTMLTags(e.options.title.text||e.langFormat("accessibility.defaultChartTitle",{chart:e}),e.renderer.forExport)}function getAxisDescription(e){return e&&(e.options.accessibility?.description||e.axisTitle?.textStr||e.options.id||e.categories&&"categories"||e.dateTime&&"Time"||"values")}function getAxisRangeDescription(e){var t=e.options||{};return t.accessibility&&void 0!==t.accessibility.rangeDescription?t.accessibility.rangeDescription:(e.categories?getCategoryAxisRangeDesc:!e.dateTime||0!==e.min&&0!==e.dataMin?getAxisFromToDescription:getAxisTimeLengthDesc)(e)}function getCategoryAxisRangeDesc(e){const t=e.chart;return e.dataMax&&e.dataMin?t.langFormat("accessibility.axis.rangeCategories",{chart:t,axis:e,numCategories:e.dataMax-e.dataMin+1}):""}function getAxisTimeLengthDesc(e){const t=e.chart,i={},n=e.dataMin||e.min||0,r=e.dataMax||e.max||0;let o="Seconds";i.Seconds=(r-n)/1e3,i.Minutes=i.Seconds/60,i.Hours=i.Minutes/60,i.Days=i.Hours/24,["Minutes","Hours","Days"].forEach(function(e){2<i[e]&&(o=e)});const a=i[o].toFixed("Seconds"!==o&&"Minutes"!==o?1:0);return t.langFormat("accessibility.axis.timeRange"+o,{chart:t,axis:e,range:a.replace(".0","")})}function getAxisFromToDescription(t){function e(e){return t.dateTime?i.time.dateFormat(r,o[e]):o[e].toString()}const i=t.chart,n=i.options,r=n&&n.accessibility&&n.accessibility.screenReaderSection.axisRangeDateFormat||"",o={min:t.dataMin||t.min||0,max:t.dataMax||t.max||0};return i.langFormat("accessibility.axis.rangeFromTo",{chart:i,axis:t,rangeFrom:e("min"),rangeTo:e("max")})}function getSeriesFirstPointElement(e){if(e.points&&e.points.length)return(e=find(e.points,e=>!!e.graphic))&&e.graphic&&e.graphic.element}function getSeriesA11yElement(e){var t=getSeriesFirstPointElement(e);return t&&t.parentNode||e.graph&&e.graph.element||e.group&&e.group.element}function unhideChartElementFromAT(e,t){t.setAttribute("aria-hidden",!1),t!==e.renderTo&&t.parentNode&&t.parentNode!==doc.body&&(Array.prototype.forEach.call(t.parentNode.childNodes,function(e){e.hasAttribute("aria-hidden")||e.setAttribute("aria-hidden",!0)}),unhideChartElementFromAT(e,t.parentNode))}function hideSeriesFromAT(e){const t=getSeriesA11yElement(e);t&&t.setAttribute("aria-hidden",!0)}function getSeriesFromName(e,t){return t?(e.series||[]).filter(function(e){return e.name===t}):e.series}function getPointFromXY(e,t,i){let n=e.length,r;for(;n--;)if(r=find(e[n].points||[],function(e){return e.x===t&&e.y===i}))return r}function getRelativePointAxisPosition(e,t){if(!defined(e.dataMin)||!defined(e.dataMax))return 0;var i=e.toPixels(e.dataMin),n=e.toPixels(e.dataMax),r="xAxis"===e.coll?"x":"y";return(e.toPixels(t[r]||0)-i)/(n-i)}function scrollAxisToPoint(e){const t=e.series.xAxis,i=e.series.yAxis,n=t&&t.scrollbar?t:i,r=n&&n.scrollbar;var o;r&&defined(r.to)&&defined(r.from)&&(o=r.to-r.from,e=getRelativePointAxisPosition(n,e),r.updatePosition(e-o/2,e+o/2),fireEvent(r,"changed",{from:r.from,to:r.to,trigger:"scrollbar",DOMEvent:null}))}const ChartUtilities={fireEventOnWrappedOrUnwrappedElement:fireEventOnWrappedOrUnwrappedElement,getChartTitle:getChartTitle,getAxisDescription:getAxisDescription,getAxisRangeDescription:getAxisRangeDescription,getPointFromXY:getPointFromXY,getSeriesFirstPointElement:getSeriesFirstPointElement,getSeriesFromName:getSeriesFromName,getSeriesA11yElement:getSeriesA11yElement,unhideChartElementFromAT:unhideChartElementFromAT,hideSeriesFromAT:hideSeriesFromAT,scrollAxisToPoint:scrollAxisToPoint};export default ChartUtilities;