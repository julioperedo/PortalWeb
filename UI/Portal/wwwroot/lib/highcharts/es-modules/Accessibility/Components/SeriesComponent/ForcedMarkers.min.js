"use strict";import U from"../../../Core/Utilities.js";const{addEvent,merge}=U;var ForcedMarkersComposition;!function(e){const r=[];function o(e){merge(!0,e,{marker:{enabled:!0,states:{normal:{opacity:0}}}})}function n(e){return e.marker.states&&e.marker.states.normal&&e.marker.states.normal.opacity}function i(e){let r=e.points.length;for(;r--;){const t=e.points[r];var a=t.options,s=t.hasForcedA11yMarker;delete t.hasForcedA11yMarker,a.marker&&(s=s&&0===n(a),a.marker.enabled&&!s?(s=a,merge(!0,s.marker,{states:{normal:{opacity:n(s)||1}}}),t.hasForcedA11yMarker=!1):!1===a.marker.enabled&&(o(a),t.hasForcedA11yMarker=!0))}}function c(e){return e._hasPointMarkers&&e.points&&e.points.length}function a(){var e=this;e.chart.styledMode&&(e.markerGroup&&e.markerGroup[e.a11yMarkersForced?"addClass":"removeClass"]("highcharts-a11y-markers-hidden"),c(e)&&e.points.forEach(e=>{e.graphic&&(e.graphic[e.hasForcedA11yMarker?"addClass":"removeClass"]("highcharts-a11y-marker-hidden"),e.graphic[!1===e.hasForcedA11yMarker?"addClass":"removeClass"]("highcharts-a11y-marker-visible"))}))}function s(e){this.resetA11yMarkerOptions=merge(e.options.marker||{},this.userOptions.marker||{})}function t(){var e,r,a,s=this,t=s.options;r=(r=(e=s).chart).options.accessibility.enabled,a=!1!==(e.options.accessibility&&e.options.accessibility.enabled),r&&a&&function(e){var r=e.chart.options.accessibility;return e.points.length<r.series.pointDescriptionEnabledThreshold||!1===r.series.pointDescriptionEnabledThreshold}(e)?(t.marker&&!1===t.marker.enabled&&(s.a11yMarkersForced=!0,o(s.options)),c(s)&&i(s)):s.a11yMarkersForced&&(delete s.a11yMarkersForced,(a=(r=s).resetA11yMarkerOptions)&&(e=a.states&&a.states.normal&&a.states.normal.opacity,r.userOptions&&r.userOptions.marker&&(r.userOptions.marker.enabled=!0),r.update({marker:{enabled:a.enabled,states:{normal:{opacity:e}}}})),delete s.resetA11yMarkerOptions)}e.compose=function(e){U.pushUnique(r,e)&&(addEvent(e,"afterSetOptions",s),addEvent(e,"render",t),addEvent(e,"afterRender",a))}}(ForcedMarkersComposition=ForcedMarkersComposition||{});export default ForcedMarkersComposition;