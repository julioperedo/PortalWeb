"use strict";import U from"../parts/Utilities.js";var error=U.error,isArray=U.isArray,seriesType=U.seriesType;function sumArray(e){return e.reduce(function(e,r){return e+r})}function toFixed(e,r){return parseFloat(e.toFixed(r))}function calculateTypicalPrice(e){return(e[1]+e[2]+e[3])/3}function calculateRawMoneyFlow(e,r){return e*r}seriesType("mfi","sma",{params:{period:14,volumeSeriesID:"volume",decimals:4}},{nameBase:"Money Flow Index",getValues:function(e,r){var a,t,i,s,u,l,c=r.period,o=e.xData,n=e.yData,p=n?n.length:0,y=r.decimals,m=1,f=e.chart.get(r.volumeSeriesID),h=f&&f.yData,d=[],D=!1,v=[],F=[],w=[],T=[];if(f){if(!(o.length<=c)&&isArray(n[0])&&4===n[0].length&&h){for(a=calculateTypicalPrice(n[m]);m<c+1;)t=a,D=(a=calculateTypicalPrice(n[m]))>=t,i=calculateRawMoneyFlow(a,h[m]),w.push(D?i:0),T.push(D?0:i),m++;for(l=m-1;l<p;l++)l>m-1&&(w.shift(),T.shift(),t=a,D=(a=calculateTypicalPrice(n[l]))>t,i=calculateRawMoneyFlow(a,h[l]),w.push(D?i:0),T.push(D?0:i)),s=sumArray(T),u=toFixed(100-100/(1+sumArray(w)/s),y),d.push([o[l],u]),v.push(o[l]),F.push(u);return{values:d,xData:v,yData:F}}}else error("Series "+r.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,e.chart)}});