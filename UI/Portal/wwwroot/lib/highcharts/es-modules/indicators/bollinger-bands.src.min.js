"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var isArray=U.isArray,merge=U.merge,seriesType=U.seriesType;import multipleLinesMixin from"../mixins/multipe-lines.js";var SMA=H.seriesTypes.sma;function getStandardDeviation(t,i,e,o){for(var a,r=0,s=t.length,n=0;n<s;n++)r+=(a=(e?t[n][i]:t[n])-o)*a;return r/=s-1,Math.sqrt(r)}seriesType("bb","sma",{params:{period:20,standardDeviation:2,index:3},bottomLine:{styles:{lineWidth:1,lineColor:void 0}},topLine:{styles:{lineWidth:1,lineColor:void 0}},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span><b> {series.name}</b><br/>Top: {point.top}<br/>Middle: {point.middle}<br/>Bottom: {point.bottom}<br/>'},marker:{enabled:!1},dataGrouping:{approximation:"averages"}},merge(multipleLinesMixin,{pointArrayMap:["top","middle","bottom"],pointValKey:"middle",nameComponents:["period","standardDeviation"],linesApiNames:["topLine","bottomLine"],init:function(){SMA.prototype.init.apply(this,arguments),this.options=merge({topLine:{styles:{lineColor:this.color}},bottomLine:{styles:{lineColor:this.color}}},this.options)},getValues:function(t,i){var e,o,a,r,s,n,p,l,m,d,y=i.period,u=i.standardDeviation,b=t.xData,h=t.yData,g=h?h.length:0,v=[],D=[],c=[];if(!(b.length<y)){for(l=isArray(h[0]),d=y;d<=g;d++)s=b.slice(d-y,d),n=h.slice(d-y,d),r=(m=SMA.prototype.getValues.call(this,{xData:s,yData:n},i)).xData[0],o=(e=m.yData[0])+u*(p=getStandardDeviation(n,i.index,l,e)),a=e-u*p,v.push([r,o,e,a]),D.push(r),c.push([o,e,a]);return{values:v,xData:D,yData:c}}}}));