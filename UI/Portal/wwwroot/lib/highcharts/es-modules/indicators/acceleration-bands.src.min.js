"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var correctFloat=U.correctFloat,merge=U.merge,seriesType=U.seriesType;import multipleLinesMixin from"../mixins/multipe-lines.js";var SMA=H.seriesTypes.sma;function getBaseForBand(e,t,a){return correctFloat(t-e)/(correctFloat(t+e)/2)*1e3*a}function getPointUB(e,t){return e*correctFloat(1+2*t)}function getPointLB(e,t){return e*correctFloat(1-2*t)}seriesType("abands","sma",{params:{period:20,factor:.001,index:3},lineWidth:1,topLine:{styles:{lineWidth:1}},bottomLine:{styles:{lineWidth:1}},dataGrouping:{approximation:"averages"}},merge(multipleLinesMixin,{pointArrayMap:["top","middle","bottom"],pointValKey:"middle",nameBase:"Acceleration Bands",nameComponents:["period","factor"],linesApiNames:["topLine","bottomLine"],getValues:function(e,t){var a,i,o,r,s,n,l,p,c,m,u,d=t.period,y=t.factor,g=t.index,D=e.xData,x=e.yData,f=x?x.length:0,h=[],B=[],F=[],L=[],A=[];if(!(f<d)){for(u=0;u<=f;u++)u<f&&(s=getBaseForBand(x[u][2],x[u][1],y),h.push(getPointUB(x[u][1],s)),B.push(getPointLB(x[u][2],s))),u>=d&&(c=D.slice(u-d,u),m=x.slice(u-d,u),l=SMA.prototype.getValues.call(this,{xData:c,yData:h.slice(u-d,u)},{period:d}),p=SMA.prototype.getValues.call(this,{xData:c,yData:B.slice(u-d,u)},{period:d}),r=(n=SMA.prototype.getValues.call(this,{xData:c,yData:m},{period:d,index:g})).xData[0],i=l.yData[0],o=p.yData[0],a=n.yData[0],F.push([r,i,a,o]),L.push(r),A.push([i,a,o]));return{values:F,xData:L,yData:A}}}}));