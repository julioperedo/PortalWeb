"use strict";import D from"../../Core/Defaults.js";const setOptions=D["setOptions"];import StockToolsDefaults from"./StockToolsDefaults.js";import Toolbar from"./StockToolbar.js";import U from"../../Core/Utilities.js";const{addEvent,getStyle,merge,pick}=U,composedMembers=[];function chartSetStockTools(t){var o=this.options,s=o.lang,o=merge(o.stockTools&&o.stockTools.gui,t&&t.gui),t=s&&s.stockTools&&s.stockTools.gui;this.stockTools=new Toolbar(o,t,this),this.stockTools.guiEnabled&&(this.isDirtyBox=!0)}function compose(t,o){U.pushUnique(composedMembers,t)&&(addEvent(t,"afterGetContainer",onChartAfterGetContainer),addEvent(t,"beforeRedraw",onChartBeforeRedraw),addEvent(t,"beforeRender",onChartBeforeRedraw),addEvent(t,"destroy",onChartDestroy),addEvent(t,"getMargins",onChartGetMargins,{order:0}),addEvent(t,"redraw",onChartRedraw),addEvent(t,"render",onChartRender),t.prototype.setStockTools=chartSetStockTools),U.pushUnique(composedMembers,o)&&(addEvent(o,"deselectButton",onNavigationBindingsDeselectButton),addEvent(o,"selectButton",onNavigationBindingsSelectButton)),U.pushUnique(composedMembers,setOptions)&&setOptions(StockToolsDefaults)}function onChartAfterGetContainer(){this.setStockTools()}function onChartBeforeRedraw(){if(this.stockTools){var o,s=this.options.chart,e=this.stockTools.listWrapper,e=e&&(e.startWidth+getStyle(e,"padding-left")+getStyle(e,"padding-right")||e.offsetWidth);let t=!1;e&&e<this.plotWidth?(o=(s=pick(s.spacingLeft,s.spacing&&s.spacing[3],0)+e)-this.spacingBox.x,this.spacingBox.x=s,this.spacingBox.width-=o,t=!0):0===e&&(t=!0),e!==this.stockTools.prevOffsetWidth&&(this.stockTools.prevOffsetWidth=e,t&&(this.isDirtyLegend=!0))}}function onChartDestroy(){this.stockTools&&this.stockTools.destroy()}function onChartGetMargins(){var t=this.stockTools&&this.stockTools.listWrapper,t=t&&(t.startWidth+getStyle(t,"padding-left")+getStyle(t,"padding-right")||t.offsetWidth);t&&t<this.plotWidth&&(this.plotLeft+=t,this.spacing[3]+=t)}function onChartRedraw(){this.stockTools&&this.stockTools.guiEnabled&&this.stockTools.redraw()}function onChartRender(){const t=this.stockTools,o=t&&t.toolbar&&t.toolbar.querySelector(".highcharts-current-price-indicator");t&&this.navigationBindings&&this.options.series&&o&&(this.navigationBindings.constructor.prototype.utils.isPriceIndicatorEnabled(this.series)?o.firstChild.style["background-image"]='url("'+t.getIconsURL()+'current-price-hide.svg")':o.firstChild.style["background-image"]='url("'+t.getIconsURL()+'current-price-show.svg")')}function onNavigationBindingsDeselectButton(o){const s=this.chart.stockTools;if(s&&s.guiEnabled){let t=o.button;0<=t.parentNode.className.indexOf("highcharts-submenu-wrapper")&&(t=t.parentNode.parentNode),s.toggleButtonActiveClass(t)}}function onNavigationBindingsSelectButton(o){const s=this.chart.stockTools;if(s&&s.guiEnabled){let t=o.button;s.unselectAllButtons(o.button),0<=t.parentNode.className.indexOf("highcharts-submenu-wrapper")&&(t=t.parentNode.parentNode),s.toggleButtonActiveClass(t)}}const StockToolsGui={compose:compose};export default StockToolsGui;