"use strict";import D from"../../Core/Defaults.js";const{defaultOptions,setOptions}=D;import H from"../../Core/Globals.js";const isTouchDevice=H["isTouchDevice"];import NavigatorAxisAdditions from"../../Core/Axis/NavigatorAxisComposition.js";import NavigatorDefaults from"./NavigatorDefaults.js";import NavigatorSymbols from"./NavigatorSymbols.js";import RendererRegistry from"../../Core/Renderer/RendererRegistry.js";const getRendererType=RendererRegistry["getRendererType"];import U from"../../Core/Utilities.js";const{addEvent,extend,merge,pick}=U,composedMembers=[];let NavigatorConstructor;function compose(t,e,o,i){if(NavigatorAxisAdditions.compose(t),NavigatorConstructor=o,U.pushUnique(composedMembers,e)){const r=e.prototype;r.callbacks.push(onChartCallback),addEvent(e,"afterAddSeries",onChartAfterAddSeries),addEvent(e,"afterSetChartSize",onChartAfterSetChartSize),addEvent(e,"afterUpdate",onChartAfterUpdate),addEvent(e,"beforeRender",onChartBeforeRender),addEvent(e,"beforeShowResetZoom",onChartBeforeShowResetZoom),addEvent(e,"update",onChartUpdate)}U.pushUnique(composedMembers,i)&&addEvent(i,"afterUpdate",onSeriesAfterUpdate),U.pushUnique(composedMembers,getRendererType)&&extend(getRendererType().prototype.symbols,NavigatorSymbols),U.pushUnique(composedMembers,setOptions)&&extend(defaultOptions,{navigator:NavigatorDefaults})}function onChartAfterAddSeries(){this.navigator&&this.navigator.setBaseSeries(null,!1)}function onChartAfterSetChartSize(){const t=this.legend,e=this.navigator;let o,i,r;var s,a;e&&(o=t&&t.options,i=e.xAxis,r=e.yAxis,{scrollbarHeight:s,scrollButtonSize:a}=e,this.inverted?(e.left=e.opposite?this.chartWidth-s-e.height:this.spacing[3]+s,e.top=this.plotTop+a):(e.left=pick(i.left,this.plotLeft+a),e.top=e.navigatorOptions.top||this.chartHeight-e.height-s-(this.scrollbar?.options.margin||0)-this.spacing[2]-(this.rangeSelector&&this.extraBottomMargin?this.rangeSelector.getHeight():0)-(o&&"bottom"===o.verticalAlign&&"proximate"!==o.layout&&o.enabled&&!o.floating?t.legendHeight+pick(o.margin,10):0)-(this.titleOffset?this.titleOffset[2]:0)),i&&r&&(this.inverted?i.options.left=r.options.left=e.left:i.options.top=r.options.top=e.top,i.setAxisSize(),r.setAxisSize()))}function onChartAfterUpdate(t){this.navigator||this.scroller||!this.options.navigator.enabled&&!this.options.scrollbar.enabled||(this.scroller=this.navigator=new NavigatorConstructor(this),pick(t.redraw,!0)&&this.redraw(t.animation))}function onChartBeforeRender(){var t=this.options;(t.navigator.enabled||t.scrollbar.enabled)&&(this.scroller=this.navigator=new NavigatorConstructor(this))}function onChartBeforeShowResetZoom(){var t=this.options,e=t.navigator,t=t.rangeSelector;if((e&&e.enabled||t&&t.enabled)&&(!isTouchDevice&&"x"===this.zooming.type||isTouchDevice&&"x"===this.zooming.pinchType))return!1}function onChartCallback(t){const e=t.navigator;e&&t.xAxis[0]&&(t=t.xAxis[0].getExtremes(),e.render(t.min,t.max))}function onChartUpdate(t){var e=t.options.navigator||{},o=t.options.scrollbar||{};this.navigator||this.scroller||!e.enabled&&!o.enabled||(merge(!0,this.options.navigator,e),merge(!0,this.options.scrollbar,o),delete t.options.navigator,delete t.options.scrollbar)}function onSeriesAfterUpdate(){this.chart.navigator&&!this.options.isInternal&&this.chart.navigator.setBaseSeries(null,!1)}const NavigatorComposition={compose:compose};export default NavigatorComposition;