"use strict";import SeriesRegistry from"../../../Core/Series/SeriesRegistry.js";const SMAIndicator=SeriesRegistry.seriesTypes["sma"];import U from"../../../Core/Utilities.js";const merge=U["merge"];class CMFIndicator extends SMAIndicator{constructor(){super(...arguments),this.data=void 0,this.options=void 0,this.points=void 0,this.volumeSeries=void 0,this.linkedParent=void 0,this.yData=void 0,this.nameBase="Chaikin Money Flow"}isValid(){const e=this.chart,t=this.options,i=this.linkedParent,s=this.volumeSeries||(this.volumeSeries=e.get(t.params.volumeSeriesID)),r=i&&i.yData&&4===i.yData[0].length;function o(e){return e.xData&&e.xData.length>=t.params.period}return!!(i&&s&&o(i)&&o(s)&&r)}getValues(e,t){if(this.isValid())return this.getMoneyFlow(e.xData,e.yData,this.volumeSeries.yData,t.period)}getMoneyFlow(e,t,i,s){const r=t.length,o=[],a=[],n=[],l=[];let u,d,h=-1,p=0,m=0;function c(e,t){var i=e[1],s=e[2],e=e[3];return null!==t&&null!==i&&null!==s&&null!==e&&i!==s?(e-s-(i-e))/(i-s)*t:(h=u,null)}if(0<s&&s<=r){for(u=0;u<s;u++)o[u]=c(t[u],i[u]),p+=i[u],m+=o[u];for(a.push(e[u-1]),n.push(u-h>=s&&0!==p?m/p:null),l.push([a[0],n[0]]);u<r;u++)o[u]=c(t[u],i[u]),p=(p-=i[u-s])+i[u],m=(m-=o[u-s])+o[u],d=[e[u],u-h>=s?m/p:null],a.push(d[0]),n.push(d[1]),l.push([d[0],d[1]])}return{values:l,xData:a,yData:n}}}CMFIndicator.defaultOptions=merge(SMAIndicator.defaultOptions,{params:{index:void 0,volumeSeriesID:"volume"}}),SeriesRegistry.registerSeriesType("cmf",CMFIndicator);export default CMFIndicator;