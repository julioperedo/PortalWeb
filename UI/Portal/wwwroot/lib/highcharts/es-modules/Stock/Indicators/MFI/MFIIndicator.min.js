"use strict";import SeriesRegistry from"../../../Core/Series/SeriesRegistry.js";const SMAIndicator=SeriesRegistry.seriesTypes["sma"];import U from"../../../Core/Utilities.js";const{extend,merge,error,isArray}=U;function sumArray(e){return e.reduce(function(e,r){return e+r})}function toFixed(e,r){return parseFloat(e.toFixed(r))}function calculateTypicalPrice(e){return(e[1]+e[2]+e[3])/3}function calculateRawMoneyFlow(e,r){return e*r}class MFIIndicator extends SMAIndicator{constructor(){super(...arguments),this.data=void 0,this.options=void 0,this.points=void 0}getValues(e,r){const t=r.period,i=e.xData,a=e.yData,s=a?a.length:0,o=r.decimals,c=e.chart.get(r.volumeSeriesID),n=c&&c.yData,u=[],l=[],d=[],p=[],y=[];let m,f,h,I,S,F,g=!1,M=1;if(c){if(!(i.length<=t)&&isArray(a[0])&&4===a[0].length&&n){for(m=calculateTypicalPrice(a[M]);M<t+1;)f=m,m=calculateTypicalPrice(a[M]),g=m>=f,h=calculateRawMoneyFlow(m,n[M]),p.push(g?h:0),y.push(g?0:h),M++;for(F=M-1;F<s;F++)F>M-1&&(p.shift(),y.shift(),f=m,m=calculateTypicalPrice(a[F]),g=m>f,h=calculateRawMoneyFlow(m,n[F]),p.push(g?h:0),y.push(g?0:h)),I=sumArray(y),S=toFixed(100-100/(1+sumArray(p)/I),o),u.push([i[F],S]),l.push(i[F]),d.push(S);return{values:u,xData:l,yData:d}}}else error("Series "+r.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,e.chart)}}MFIIndicator.defaultOptions=merge(SMAIndicator.defaultOptions,{params:{index:void 0,volumeSeriesID:"volume",decimals:4}}),extend(MFIIndicator.prototype,{nameBase:"Money Flow Index"}),SeriesRegistry.registerSeriesType("mfi",MFIIndicator);export default MFIIndicator;