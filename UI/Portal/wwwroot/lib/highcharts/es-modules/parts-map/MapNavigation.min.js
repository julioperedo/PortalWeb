"use strict";import Chart from"../parts/Chart.js";import H from"../parts/Globals.js";var doc=H.doc;import U from"../parts/Utilities.js";var addEvent=U.addEvent,extend=U.extend,merge=U.merge,objectEach=U.objectEach,pick=U.pick;function stopEvent(t){t&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)}function MapNavigation(t){this.init(t)}MapNavigation.prototype.init=function(t){this.chart=t,t.mapNavButtons=[]},MapNavigation.prototype.update=function(t){var i,e,n,o,a,s=this.chart,d=s.options.mapNavigation,h=function(t){this.handler.call(s,t),stopEvent(t)},p=s.mapNavButtons;for(t&&(d=s.options.mapNavigation=merge(s.options.mapNavigation,t));p.length;)p.pop().destroy();pick(d.enableButtons,d.enabled)&&!s.renderer.forExport&&objectEach(d.buttons,function(t,r){i=merge(d.buttonOptions,t),s.styledMode||((e=i.theme).style=merge(i.theme.style,i.style),n=e.states,o=n&&n.hover,a=n&&n.select),(t=s.renderer.button(i.text,0,0,h,e,o,a,0,"zoomIn"===r?"topbutton":"bottombutton").addClass("highcharts-map-navigation highcharts-"+{zoomIn:"zoom-in",zoomOut:"zoom-out"}[r]).attr({width:i.width,height:i.height,title:s.options.lang[r],padding:i.padding,zIndex:5}).add()).handler=i.onclick,addEvent(t.element,"dblclick",stopEvent),p.push(t);var l=i,c=addEvent(s,"load",function(){t.align(extend(l,{width:t.width,height:2*t.height}),null,l.alignTo),c()})}),this.updateEvents(d)},MapNavigation.prototype.updateEvents=function(t){var i=this.chart;pick(t.enableDoubleClickZoom,t.enabled)||t.enableDoubleClickZoomTo?this.unbindDblClick=this.unbindDblClick||addEvent(i.container,"dblclick",function(t){i.pointer.onContainerDblClick(t)}):this.unbindDblClick&&(this.unbindDblClick=this.unbindDblClick()),pick(t.enableMouseWheelZoom,t.enabled)?this.unbindMouseWheel=this.unbindMouseWheel||addEvent(i.container,void 0===doc.onmousewheel?"DOMMouseScroll":"mousewheel",function(t){return i.pointer.onContainerMouseWheel(t),stopEvent(t),!1}):this.unbindMouseWheel&&(this.unbindMouseWheel=this.unbindMouseWheel())},extend(Chart.prototype,{fitToBox:function(t,i){return[["x","width"],["y","height"]].forEach(function(e){var n=e[0],o=e[1];t[n]+t[o]>i[n]+i[o]&&(t[o]>i[o]?(t[o]=i[o],t[n]=i[n]):t[n]=i[n]+i[o]-t[o]),t[o]>i[o]&&(t[o]=i[o]),t[n]<i[n]&&(t[n]=i[n])}),t},mapZoom:function(t,i,e,n,o){var a=this.xAxis[0],s=a.max-a.min,d=pick(i,a.min+s/2),h=s*t,p=this.yAxis[0],r=p.max-p.min,l=pick(e,p.min+r/2),c=r*t,u=d-h*(n?(n-a.pos)/a.len:.5),m=l-c*(o?(o-p.pos)/p.len:.5),v=this.fitToBox({x:u,y:m,width:h,height:c},{x:a.dataMin,y:p.dataMin,width:a.dataMax-a.dataMin,height:p.dataMax-p.dataMin}),b=v.x<=a.dataMin&&v.width>=a.dataMax-a.dataMin&&v.y<=p.dataMin&&v.height>=p.dataMax-p.dataMin;n&&a.mapAxis&&(a.mapAxis.fixTo=[n-a.pos,i]),o&&p.mapAxis&&(p.mapAxis.fixTo=[o-p.pos,e]),void 0===t||b?(a.setExtremes(void 0,void 0,!1),p.setExtremes(void 0,void 0,!1)):(a.setExtremes(v.x,v.x+v.width,!1),p.setExtremes(v.y,v.y+v.height,!1)),this.redraw()}}),addEvent(Chart,"beforeRender",function(){this.mapNavigation=new MapNavigation(this),this.mapNavigation.update()}),H.MapNavigation=MapNavigation;