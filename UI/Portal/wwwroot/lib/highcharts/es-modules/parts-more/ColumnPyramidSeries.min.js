"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var clamp=U.clamp,pick=U.pick,seriesType=U.seriesType,seriesTypes=H.seriesTypes,colProto=seriesTypes.column.prototype;seriesType("columnpyramid","column",{},{translate:function(){var t=this,e=t.chart,o=t.options,i=t.dense=t.closestPointRange*t.xAxis.transA<2,s=t.borderWidth=pick(o.borderWidth,i?0:1),p=t.yAxis,r=o.threshold,a=t.translatedThreshold=p.getThreshold(r),l=pick(o.minPointLength,5),n=t.getColumnMetrics(),h=n.width,c=t.barW=Math.max(h,1+2*s),d=t.pointXOffset=n.offset;e.inverted&&(a-=.5),o.pointPadding&&(c=Math.ceil(c)),colProto.translate.apply(t),t.points.forEach(function(i){var s,n,m,y,f,g,T,x,u,M,P,b,k=pick(i.yBottom,a),v=999+Math.abs(k),W=clamp(i.plotY,-v,p.len+v),A=i.plotX+d,L=c/2,U=Math.min(W,k),H=Math.max(W,k)-U;i.barX=A,i.pointWidth=h,i.tooltipPos=e.inverted?[p.len+p.pos-e.plotLeft-W,t.xAxis.len-A-L,H]:[A+L,W+p.pos-e.plotTop,H],s=r+(i.total||i.y),"percent"===o.stacking&&(s=r+(i.y<0)?-100:100),m=p.toPixels(s,!0),T=A-(y=(n=e.plotHeight-m-(e.plotHeight-a))?L*(U-m)/n:0)+L,x=A+y+L,u=A+(f=n?L*(U+H-m)/n:0)+L,M=A-f+L,P=U-l,b=U+H,i.y<0&&(P=U,b=U+H+l),e.inverted&&(x=(T=A+L+(y=L*(m-(g=e.plotWidth-U))/(n=m-(e.plotWidth-a))))-2*y,u=A-(f=L*(m-(g-H))/n)+L,M=A+f+L,P=U,b=U+H-l,i.y<0&&(b=U+H+l)),i.shapeType="path",i.shapeArgs={x:T,y:P,width:x-T,height:H,d:[["M",T,P],["L",x,P],["L",u,b],["L",M,b],["Z"]]}})}});