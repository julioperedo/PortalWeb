"use strict";import Chart from"../parts/Chart.js";import H from"../parts/Globals.js";import Pointer from"../parts/Pointer.js";import U from"../parts/Utilities.js";var addEvent=U.addEvent,extend=U.extend,merge=U.merge,pick=U.pick,splat=U.splat;import"../mixins/centered-series.js";var CenteredSeriesMixin=H.CenteredSeriesMixin;Chart.prototype.collectionsWithUpdate.push("pane");var Pane=function(){function t(t,e){this.background=void 0,this.center=void 0,this.chart=void 0,this.options=void 0,this.coll="pane",this.defaultOptions={center:["50%","50%"],size:"85%",innerSize:"0%",startAngle:0},this.defaultBackgroundOptions={shape:"circle",borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"},this.init(t,e)}return t.prototype.init=function(t,e){this.chart=e,this.background=[],e.pane.push(this),this.setOptions(t)},t.prototype.setOptions=function(t){this.options=t=merge(this.defaultOptions,this.chart.angular?{background:{}}:void 0,t)},t.prototype.render=function(){var t,e,r=this.options,i=this.options.background,n=this.chart.renderer;if(this.group||(this.group=n.g("pane-group").attr({zIndex:r.zIndex||0}).add()),this.updateCenter(),i)for(i=splat(i),t=Math.max(i.length,this.background.length||0),e=0;e<t;e++)i[e]&&this.axis?this.renderBackground(merge(this.defaultBackgroundOptions,i[e]),e):this.background[e]&&(this.background[e]=this.background[e].destroy(),this.background.splice(e,1))},t.prototype.renderBackground=function(t,e){var r="animate",i={class:"highcharts-pane "+(t.className||"")};this.chart.styledMode||extend(i,{fill:t.backgroundColor,stroke:t.borderColor,"stroke-width":t.borderWidth}),this.background[e]||(this.background[e]=this.chart.renderer.path().add(this.group),r="attr"),this.background[e][r]({d:this.axis.getPlotBandPath(t.from,t.to,t)}).attr(i)},t.prototype.updateCenter=function(t){this.center=(t||this.axis||{}).center=CenteredSeriesMixin.getCenter.call(this)},t.prototype.update=function(t,e){merge(!0,this.options,t),merge(!0,this.chart.options.pane,t),this.setOptions(this.options),this.render(),this.chart.axes.forEach(function(t){t.pane===this&&(t.pane=null,t.update({},e))},this)},t}();function isInsidePane(t,e,r){return Math.sqrt(Math.pow(t-r[0],2)+Math.pow(e-r[1],2))<r[2]/2}H.Chart.prototype.getHoverPane=function(t){var e,r=this;return t&&r.pane.forEach(function(i){var n=t.chartX-r.plotLeft,o=t.chartY-r.plotTop;isInsidePane(r.inverted?o:n,r.inverted?n:o,i.center)&&(e=i)}),e},addEvent(Chart,"afterIsInsidePlot",function(t){this.polar&&(t.isInsidePlot=this.pane.some(function(e){return isInsidePane(t.x,t.y,e.center)}))}),addEvent(Pointer,"beforeGetHoverData",function(t){var e=this.chart;e.polar&&(e.hoverPane=e.getHoverPane(t),t.filter=function(r){return r.visible&&!(!t.shared&&r.directTouch)&&pick(r.options.enableMouseTracking,!0)&&(!e.hoverPane||r.xAxis.pane===e.hoverPane)})}),addEvent(Pointer,"afterGetHoverData",function(t){var e=this.chart;t.hoverPoint&&t.hoverPoint.plotX&&t.hoverPoint.plotY&&e.hoverPane&&!isInsidePane(t.hoverPoint.plotX,t.hoverPoint.plotY,e.hoverPane.center)&&(t.hoverPoint=void 0)}),H.Pane=Pane;export default H.Pane;