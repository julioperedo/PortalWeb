import Chart from"../../parts/Chart.js";import H from"../../parts/Globals.js";import U from"../../parts/Utilities.js";var addEvent=U.addEvent;H.dragNodesMixin={onMouseDown:function(o,t){var i=this.chart.pointer.normalize(t);o.fixedPosition={chartX:i.chartX,chartY:i.chartY,plotX:o.plotX,plotY:o.plotY},o.inDragMode=!0},onMouseMove:function(o,t){if(o.fixedPosition&&o.inDragMode){var i,e,a=this.chart,r=a.pointer.normalize(t),n=o.fixedPosition.chartX-r.chartX,s=o.fixedPosition.chartY-r.chartY,d=a.graphLayoutsLookup;(Math.abs(n)>5||Math.abs(s)>5)&&(i=o.fixedPosition.plotX-n,e=o.fixedPosition.plotY-s,a.isInsidePlot(i,e)&&(o.plotX=i,o.plotY=e,o.hasDragged=!0,this.redrawHalo(o),d.forEach(function(o){o.restartSimulation()})))}},onMouseUp:function(o,t){o.fixedPosition&&o.hasDragged&&(this.layout.enableSimulation?this.layout.start():this.chart.redraw(),o.inDragMode=o.hasDragged=!1,this.options.fixedDraggable||delete o.fixedPosition)},redrawHalo:function(o){o&&this.halo&&this.halo.attr({d:o.haloPath(this.options.states.hover.halo.size)})}},addEvent(Chart,"load",function(){var o,t,i,e=this;e.container&&(o=addEvent(e.container,"mousedown",function(o){var a=e.hoverPoint;a&&a.series&&a.series.hasDraggableNodes&&a.series.options.draggable&&(a.series.onMouseDown(a,o),t=addEvent(e.container,"mousemove",function(o){return a&&a.series&&a.series.onMouseMove(a,o)}),i=addEvent(e.container.ownerDocument,"mouseup",function(o){return t(),i(),a&&a.series&&a.series.onMouseUp(a,o)}))})),addEvent(e,"destroy",function(){o()})});