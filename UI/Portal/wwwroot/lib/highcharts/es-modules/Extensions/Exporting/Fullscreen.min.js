"use strict";import AST from"../../Core/Renderer/HTML/AST.js";import U from"../../Core/Utilities.js";const{addEvent,fireEvent}=U,composedMembers=[];function onChartBeforeRender(){this.fullscreen=new Fullscreen(this)}class Fullscreen{static compose(e){U.pushUnique(composedMembers,e)&&addEvent(e,"beforeRender",onChartBeforeRender)}constructor(e){this.chart=e,this.isOpen=!1;e=e.renderTo;this.browserProps||("function"==typeof e.requestFullscreen?this.browserProps={fullscreenChange:"fullscreenchange",requestFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen"}:e.mozRequestFullScreen?this.browserProps={fullscreenChange:"mozfullscreenchange",requestFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen"}:e.webkitRequestFullScreen?this.browserProps={fullscreenChange:"webkitfullscreenchange",requestFullscreen:"webkitRequestFullScreen",exitFullscreen:"webkitExitFullscreen"}:e.msRequestFullscreen&&(this.browserProps={fullscreenChange:"MSFullscreenChange",requestFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen"}))}close(){const e=this,n=e.chart,t=n.options.chart;fireEvent(n,"fullscreenClose",null,function(){e.isOpen&&e.browserProps&&n.container.ownerDocument instanceof Document&&n.container.ownerDocument[e.browserProps.exitFullscreen](),e.unbindFullscreenEvent&&(e.unbindFullscreenEvent=e.unbindFullscreenEvent()),n.setSize(e.origWidth,e.origHeight,!1),e.origWidth=void 0,e.origHeight=void 0,t.width=e.origWidthOption,t.height=e.origHeightOption,e.origWidthOption=void 0,e.origHeightOption=void 0,e.isOpen=!1,e.setButtonText()})}open(){const r=this,s=r.chart,i=s.options.chart;fireEvent(s,"fullscreenOpen",null,function(){if(i&&(r.origWidthOption=i.width,r.origHeightOption=i.height),r.origWidth=s.chartWidth,r.origHeight=s.chartHeight,r.browserProps){const e=addEvent(s.container.ownerDocument,r.browserProps.fullscreenChange,function(){r.isOpen?(r.isOpen=!1,r.close()):(s.setSize(null,null,!1),r.isOpen=!0,r.setButtonText())}),n=addEvent(s,"destroy",e),t=(r.unbindFullscreenEvent=()=>{e(),n()},s.renderTo[r.browserProps.requestFullscreen]());t&&t.catch(function(){alert("Full screen is not supported inside a frame.")})}})}setButtonText(){const e=this.chart,n=e.exportDivElements,t=e.options.exporting,r=t&&t.buttons&&t.buttons.contextButton.menuItems,s=e.options.lang;var i;t&&t.menuItemDefinitions&&s&&s.exitFullscreen&&s.viewFullscreen&&r&&n&&((i=n[r.indexOf("viewFullscreen")])&&AST.setElementHTML(i,this.isOpen?s.exitFullscreen:t.menuItemDefinitions.viewFullscreen.text||s.viewFullscreen))}toggle(){var e=this;e.isOpen?e.close():e.open()}}export default Fullscreen;