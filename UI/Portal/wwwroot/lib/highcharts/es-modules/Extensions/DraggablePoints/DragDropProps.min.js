"use strict";import DraggableChart from"./DraggableChart.js";const flipResizeSide=DraggableChart["flipResizeSide"];import U from"../../Core/Utilities.js";const{isNumber,merge,pick}=U,line={x:{axis:"x",move:!0},y:{axis:"y",move:!0}},flags=line,column={x:{axis:"x",move:!0},y:{axis:"y",move:!1,resize:!0,beforeResize:(e,a,r)=>{var o=pick(r.yBottom,r.series.translatedThreshold),t=e.attr("y"),i=isNumber(r.stackY)?r.stackY-(r.y||0):r.series.options.threshold||0,a=i+a.y;(r.series.yAxis.reversed?a<i:i<=a)?(r=e.attr("height"),e.attr({height:Math.max(0,Math.round(r+(o?o-t-r:0)))})):e.attr({y:Math.round(t+(o?o-t:0))})},resizeSide:(e,a)=>{const r=a.series.chart,o=r.dragHandles,t=e.y>=(a.series.options.threshold||0)?"top":"bottom",i=flipResizeSide(t);return o&&o[i]&&(o[i].destroy(),delete o[i]),t},handlePositioner:e=>{var a=e.shapeArgs||e.graphic&&e.graphic.getBBox()||{},r=e.series.yAxis.reversed,o=e.series.options.threshold||0,e=e.y||0;return{x:a.x||0,y:!r&&o<=e||r&&e<o?a.y||0:(a.y||0)+(a.height||0)}},handleFormatter:e=>{var e=e.shapeArgs||{},a=e.r||0,e=e.width||0,r=e/2;return[["M",a,0],["L",r-5,0],["A",1,1,0,0,0,5+r,0],["A",1,1,0,0,0,r-5,0],["M",5+r,0],["L",e-a,0]]}}},boxplot={x:column.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:e=>({x:e.shapeArgs.x||0,y:e.lowPlot}),handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e<=a.q1},q1:{optionName:"draggableQ1",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:e=>({x:e.shapeArgs.x||0,y:e.q1Plot}),handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e<=a.median&&e>=a.low},median:{axis:"y",move:!0},q3:{optionName:"draggableQ3",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:e=>({x:e.shapeArgs.x||0,y:e.q3Plot}),handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e<=a.high&&e>=a.median},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:e=>({x:e.shapeArgs.x||0,y:e.highPlot}),handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e>=a.q3}},bullet={x:column.x,y:column.y,target:{optionName:"draggableTarget",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:e=>{var a=e.targetGraphic.getBBox();return{x:e.barX,y:a.y+a.height/2}},handleFormatter:column.y.handleFormatter}},ohlc={x:column.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:e=>({x:e.shapeArgs.x,y:e.plotLow}),handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e<=a.open&&e<=a.close},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:e=>({x:e.shapeArgs.x,y:e.plotHigh}),handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e>=a.open&&e>=a.close},open:{optionName:"draggableOpen",axis:"y",move:!0,resize:!0,resizeSide:e=>e.open>=e.close?"top":"bottom",handlePositioner:e=>({x:e.shapeArgs.x,y:e.plotOpen}),handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e<=a.high&&e>=a.low},close:{optionName:"draggableClose",axis:"y",move:!0,resize:!0,resizeSide:e=>e.open>=e.close?"bottom":"top",handlePositioner:e=>({x:e.shapeArgs.x,y:e.plotClose}),handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e<=a.high&&e>=a.low}},waterfall={x:column.x,y:merge(column.y,{handleFormatter:e=>e.isSum||e.isIntermediateSum?null:column.y.handleFormatter(e)})},columnrange={x:{axis:"x",move:!0},low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:e=>{e=e.shapeArgs||e.graphic.getBBox();return{x:e.x||0,y:(e.y||0)+(e.height||0)}},handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e<=a.high},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:e=>{e=e.shapeArgs||e.graphic.getBBox();return{x:e.x||0,y:e.y||0}},handleFormatter:column.y.handleFormatter,propValidate:(e,a)=>e>=a.low}},arearange={x:columnrange.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:e=>{e=e.graphics&&e.graphics[0]&&e.graphics[0].getBBox();return e?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:arearangeHandleFormatter,propValidate:columnrange.low.propValidate},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:e=>{e=e.graphics&&e.graphics[1]&&e.graphics[1].getBBox();return e?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:arearangeHandleFormatter,propValidate:columnrange.high.propValidate}},xrange={y:{axis:"y",move:!0},x:{optionName:"draggableX1",axis:"x",move:!0,resize:!0,resizeSide:"left",handlePositioner:e=>xrangeHandlePositioner(e,"x"),handleFormatter:horizHandleFormatter,propValidate:(e,a)=>e<=a.x2},x2:{optionName:"draggableX2",axis:"x",move:!0,resize:!0,resizeSide:"right",handlePositioner:e=>xrangeHandlePositioner(e,"x2"),handleFormatter:horizHandleFormatter,propValidate:(e,a)=>e>=a.x}},gantt={y:xrange.y,start:merge(xrange.x,{optionName:"draggableStart",validateIndividualDrag:e=>!e.milestone}),end:merge(xrange.x2,{optionName:"draggableEnd",validateIndividualDrag:e=>!e.milestone})};function arearangeHandleFormatter(e){e=e.graphic?e.graphic.getBBox().width/2+1:4;return[["M",0-e,0],["a",e,e,0,1,0,2*e,0],["a",e,e,0,1,0,-2*e,0]]}function horizHandleFormatter(e){var e=e.shapeArgs||e.graphic.getBBox(),a=e.r||0,r=e.height-a,e=e.height/2;return[["M",0,a],["L",0,e-5],["A",1,1,0,0,0,0,5+e],["A",1,1,0,0,0,0,e-5],["M",0,5+e],["L",0,r]]}function xrangeHandlePositioner(e,a){const r=e.series,o=r.xAxis,t=r.yAxis,i=r.chart.inverted,n=r.columnMetrics?r.columnMetrics.offset:-e.shapeArgs.height/2;let l=o.toPixels(e[a],!0),s=t.toPixels(e.y,!0);return i&&(l=o.len-l,s=t.len-s),s+=n,{x:Math.round(l),y:Math.round(s)}}const DragDropProps={arearange:arearange,boxplot:boxplot,bullet:bullet,column:column,columnrange:columnrange,flags:flags,gantt:gantt,line:line,ohlc:ohlc,waterfall:waterfall,xrange:xrange};export default DragDropProps;