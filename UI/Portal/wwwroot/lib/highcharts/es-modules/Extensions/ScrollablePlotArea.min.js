"use strict";import A from"../Core/Animation/AnimationUtilities.js";const stop=A["stop"];import Axis from"../Core/Axis/Axis.js";import Chart from"../Core/Chart/Chart.js";import Series from"../Core/Series/Series.js";import RendererRegistry from"../Core/Renderer/RendererRegistry.js";import U from"../Core/Utilities.js";const{addEvent,createElement,defined,merge,pick}=U;addEvent(Chart,"afterSetChartSize",function(t){let i=this.options.chart.scrollablePlotArea,e=i&&i.minWidth,s=i&&i.minHeight,h,r,l;this.renderer.forExport||(e?(this.scrollablePixelsX=h=Math.max(0,e-this.chartWidth),h&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=merge(this.plotBox),this.plotBox.width=this.plotWidth+=h,this.inverted?this.clipBox.height+=h:this.clipBox.width+=h,l={1:{name:"right",value:h}})):s&&(this.scrollablePixelsY=r=Math.max(0,s-this.chartHeight),defined(r)&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=merge(this.plotBox),this.plotBox.height=this.plotHeight+=r,this.inverted?this.clipBox.width+=r:this.clipBox.height+=r,l={2:{name:"bottom",value:r}})),l&&!t.skipAxes&&this.axes.forEach(function(s){l[s.side]?s.getPlotLinePath=function(){var t=l[s.side].name,i=l[s.side].value,e=this[t];return this[t]=e-i,i=Axis.prototype.getPlotLinePath.apply(this,arguments),this[t]=e,i}:(s.setAxisSize(),s.setAxisTranslation())}))}),addEvent(Chart,"render",function(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()}),Chart.prototype.setUpScrolling=function(){const t={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(t.overflowX="auto"),this.scrollablePixelsY&&(t.overflowY="auto"),this.scrollingParent=createElement("div",{className:"highcharts-scrolling-parent"},{position:"relative"},this.renderTo),this.scrollingContainer=createElement("div",{className:"highcharts-scrolling"},t,this.scrollingParent);let i;addEvent(this.scrollingContainer,"scroll",()=>{this.pointer&&(delete this.pointer.chartPosition,this.hoverPoint&&(i=this.hoverPoint),this.pointer.runPointActions(void 0,i,!0))}),this.innerContainer=createElement("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null},Chart.prototype.moveFixedElements=function(){let i=this.container,e=this.fixedRenderer,t=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-credits",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-reset-zoom",".highcharts-drillup-button",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"],s;this.scrollablePixelsX&&!this.inverted?s=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted||this.scrollablePixelsY&&!this.inverted?s=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(s=".highcharts-yaxis"),s&&t.push(s+":not(.highcharts-radial-axis)",s+"-labels:not(.highcharts-radial-axis-labels)"),t.forEach(function(t){[].forEach.call(i.querySelectorAll(t),function(t){(t.namespaceURI===e.SVG_NS?e.box:e.box.parentNode).appendChild(t),t.style.pointerEvents="auto"})})},Chart.prototype.applyFixed=function(){const t=!this.fixedDiv,i=this.options.chart,e=i.scrollablePlotArea,s=RendererRegistry.getRendererType();let h,r,l,o=(t?(this.fixedDiv=createElement("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(i.style&&i.style.zIndex||0)+2,top:0},null,!0),this.scrollingContainer&&this.scrollingContainer.parentNode.insertBefore(this.fixedDiv,this.scrollingContainer),this.renderTo.style.overflow="visible",this.fixedRenderer=h=new s(this.fixedDiv,this.chartWidth,this.chartHeight,this.options.chart.style),this.scrollableMask=h.path().attr({fill:this.options.chart.backgroundColor||"#fff","fill-opacity":pick(e.opacity,.85),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),addEvent(this,"afterShowResetZoom",this.moveFixedElements),addEvent(this,"afterApplyDrilldown",this.moveFixedElements),addEvent(this,"afterLayOutTitles",this.moveFixedElements)):this.fixedRenderer.setSize(this.chartWidth,this.chartHeight),(this.scrollableDirty||t)&&(this.scrollableDirty=!1,this.moveFixedElements()),r=this.chartWidth+(this.scrollablePixelsX||0),l=this.chartHeight+(this.scrollablePixelsY||0),stop(this.container),this.container.style.width=r+"px",this.container.style.height=l+"px",this.renderer.boxWrapper.attr({width:r,height:l,viewBox:[0,0,r,l].join(" ")}),this.chartBackground.attr({width:r,height:l}),this.scrollingContainer.style.height=this.chartHeight+"px",t&&(e.scrollPositionX&&(this.scrollingContainer.scrollLeft=this.scrollablePixelsX*e.scrollPositionX),e.scrollPositionY&&(this.scrollingContainer.scrollTop=this.scrollablePixelsY*e.scrollPositionY)),this.axisOffset),a=this.plotTop-o[0]-1,n=this.plotLeft-o[3]-1,c=this.plotTop+this.plotHeight+o[2]+1,d=this.plotLeft+this.plotWidth+o[1]+1,p=this.plotLeft+this.plotWidth-(this.scrollablePixelsX||0),g=this.plotTop+this.plotHeight-(this.scrollablePixelsY||0),x;x=this.scrollablePixelsX?[["M",0,a],["L",this.plotLeft-1,a],["L",this.plotLeft-1,c],["L",0,c],["Z"],["M",p,a],["L",this.chartWidth,a],["L",this.chartWidth,c],["L",p,c],["Z"]]:this.scrollablePixelsY?[["M",n,0],["L",n,this.plotTop-1],["L",d,this.plotTop-1],["L",d,0],["Z"],["M",n,g],["L",n,this.chartHeight],["L",d,this.chartHeight],["L",d,g],["Z"]]:[["M",0,0]],"adjustHeight"!==this.redrawTrigger&&this.scrollableMask.attr({d:x})},addEvent(Axis,"afterInit",function(){this.chart.scrollableDirty=!0}),addEvent(Series,"show",function(){this.chart.scrollableDirty=!0});