"use strict";import U from"../../Core/Utilities.js";const pick=U["pick"];class SonificationSpeaker{constructor(s){this.options=s,this.masterVolume=1,this.synthesis=window.speechSynthesis,void 0!==speechSynthesis.onvoiceschanged&&(speechSynthesis.onvoiceschanged=this.setVoice.bind(this)),this.setVoice(),this.scheduled=[]}say(s,e){if(this.synthesis){this.synthesis.cancel();const i=new SpeechSynthesisUtterance(s);this.voice&&(i.voice=this.voice),i.rate=e&&e.rate||this.options.rate||1,i.pitch=e&&e.pitch||this.options.pitch||1,i.volume=pick(e&&e.volume,this.options.volume,1)*this.masterVolume,this.synthesis.speak(i)}}sayAtTime(s,e,i){this.scheduled.push(setTimeout(this.say.bind(this,e,i),s))}cancel(){this.scheduled.forEach(clearTimeout),this.scheduled=[],this.synthesis.cancel()}destroy(){this.cancel()}setMasterVolume(s){this.masterVolume=s}setVoice(){if(this.synthesis){var i=this.options.name,t=this.options.language||"en-US",h=this.synthesis.getVoices(),o=h.length;let e;for(let s=0;s<o;++s){if(i&&h[s].name===i)return void(this.voice=h[s]);if(!e&&h[s].lang===t&&(e=h[s],!i))break}this.voice=e}}}export default SonificationSpeaker;