"use strict";import Annotation from"../Annotation.js";import CrookedLine from"./CrookedLine.js";import ControlPoint from"../ControlPoint.js";import U from"../../../Core/Utilities.js";const{merge,isNumber,defined}=U;function getStartingPath(t,i){return["M",t,i]}function getCirclePath(i,o,s,e){const n=[];for(let t=1;t<=o;t++)n.push(["A",i/2,i/2,0,1,1,s+t*i,e]);return n}class TimeCycles extends CrookedLine{init(t,i,o){defined(i.yAxis)&&i.points.forEach(t=>{t.yAxis=i.yAxis}),defined(i.xAxis)&&i.points.forEach(t=>{t.xAxis=i.xAxis}),super.init(t,i,o)}setPath(){this.shapes[0].options.d=this.getPath()}getPath(){return[getStartingPath(this.startX,this.y)].concat(getCirclePath(this.pixelInterval,this.numberOfCircles,this.startX,this.y))}addShapes(){const t=this.options.typeOptions;this.setPathProperties();var i=this.initShape(merge(t.line,{type:"path",d:this.getPath(),points:this.options.points}),0);t.line=i.options}addControlPoints(){const i=this.options,t=i.typeOptions;i.controlPointOptions.style.cursor=this.chart.inverted?"ns-resize":"ew-resize",t.controlPointOptions.forEach(t=>{t=merge(i.controlPointOptions,t),t=new ControlPoint(this.chart,this,t,0);this.controlPoints.push(t)})}setPathProperties(){var t,i,o,s=this.options.typeOptions,e=s.points;if(e){const n=e[0],r=e[1],h=s.xAxis||0,a=s.yAxis||0,p=this.chart.xAxis[h],c=this.chart.yAxis[a],l=n.x,P=n.y,u=r.x;l&&u&&(e=isNumber(P)?c.toPixels(P):c.top+c.height,s=isNumber(l)?p.toPixels(l):p.left,t=isNumber(u)?p.toPixels(u):p.left+30,i=p.len,t=Math.round(Math.max(Math.abs(t-s),2)),i=Math.floor(i/t)+2,o=(Math.floor((s-p.left)/t)+1)*t,this.startX=s-o,this.y=e,this.pixelInterval=t,this.numberOfCircles=i)}}redraw(t){this.setPathProperties(),this.setPath(),super.redraw(t)}}TimeCycles.prototype.defaultOptions=merge(CrookedLine.prototype.defaultOptions,{typeOptions:{controlPointOptions:[{positioner:function(t){var i=t.points[0];return{x:t.anchor(i).absolutePosition.x-(this.graphic.width||0)/2,y:t.y-(this.graphic.height||0)}},events:{drag:function(t,i){var o=i.anchor(i.points[0]).absolutePosition;i.translatePoint(t.chartX-o.x,0,0),i.redraw(!1)}}},{positioner:function(t){var i=t.points[1];return{x:t.anchor(i).absolutePosition.x-(this.graphic.width||0)/2,y:t.y-(this.graphic.height||0)}},events:{drag:function(t,i){var o=i.anchor(i.points[1]).absolutePosition;i.translatePoint(t.chartX-o.x,0,1),i.redraw(!1)}}}]}});export default Annotation.types.timeCycles=TimeCycles;