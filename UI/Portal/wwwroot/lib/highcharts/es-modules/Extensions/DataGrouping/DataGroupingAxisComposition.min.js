"use strict";import DataGroupingDefaults from"./DataGroupingDefaults.js";import U from"../../Core/Utilities.js";const{addEvent,extend,merge,pick}=U,composedMembers=[];let AxisConstructor;function applyGrouping(o){const e=this,t=e.series;t.forEach(function(t){t.groupPixelWidth=void 0}),t.forEach(function(t){t.groupPixelWidth=e.getGroupPixelWidth&&e.getGroupPixelWidth(),t.groupPixelWidth&&(t.hasProcessed=!0),t.applyGrouping(!!o.hasExtremesChanged)})}function compose(t){AxisConstructor=t,U.pushUnique(composedMembers,t)&&(addEvent(t,"afterSetScale",onAfterSetScale),addEvent(t,"postProcessData",applyGrouping),extend(t.prototype,{applyGrouping:applyGrouping,getGroupPixelWidth:getGroupPixelWidth,setDataGrouping:setDataGrouping}))}function getGroupPixelWidth(){var t=this.series;let o=t.length,e=0,i=!1,r,s;for(;o--;)(s=t[o].options.dataGrouping)&&(e=Math.max(e,pick(s.groupPixelWidth,DataGroupingDefaults.common.groupPixelWidth)),r=(t[o].processedXData||t[o].data).length,(t[o].groupPixelWidth||r>this.chart.plotSizeX/e||r&&s.forced)&&(i=!0));return i?e:0}function onAfterSetScale(){this.series.forEach(function(t){t.hasProcessed=!1})}function setDataGrouping(o,t){let e;if(t=pick(t,!0),o=o||{forced:!1,units:null},this instanceof AxisConstructor)for(e=this.series.length;e--;)this.series[e].update({dataGrouping:o},!1);else this.chart.options.series.forEach(function(t){t.dataGrouping="boolean"==typeof o?o:merge(o,t.dataGrouping)});this.ordinal&&(this.ordinal.slope=void 0),t&&this.chart.redraw()}const DataGroupingAxisComposition={compose:compose};export default DataGroupingAxisComposition;