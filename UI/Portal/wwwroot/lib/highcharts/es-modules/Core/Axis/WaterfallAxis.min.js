"use strict";import StackItem from"./Stacking/StackItem.js";import U from"../Utilities.js";const{addEvent,objectEach,pushUnique}=U;var WaterfallAxis;!function(t){const e=[];function s(){const t=this.waterfall.stacks;t&&(t.changed=!1,delete t.alreadyChanged)}function l(){var t=this,a=t.options.stackLabels;a&&a.enabled&&t.waterfall.stacks&&t.waterfall.renderStackTotals()}function c(){var t=this;t.waterfall||(t.waterfall=new a(t))}function n(){var t=this.axes;for(const a of this.series)if(a.options.stacking){for(const e of t)e.isXAxis||(e.waterfall.stacks.changed=!0);break}}t.compose=function(t,a){pushUnique(e,t)&&(addEvent(t,"init",c),addEvent(t,"afterBuildStacks",s),addEvent(t,"afterRender",l)),pushUnique(e,a)&&addEvent(a,"beforeRedraw",n)};class a{constructor(t){this.axis=t,this.stacks={changed:!1}}renderStackTotals(){const t=this.axis,a=t.waterfall.stacks,e=t.stacking&&t.stacking.stackTotalGroup,s=new StackItem(t,t.options.stackLabels||{},!1,0,void 0);this.dummyStackItem=s,e&&objectEach(a,t=>{objectEach(t,(t,a)=>{s.total=t.stackTotal,s.x=+a,t.label&&(s.label=t.label),StackItem.prototype.render.call(s,e),t.label=s.label,delete s.label})}),s.total=null}}t.Composition=a}(WaterfallAxis=WaterfallAxis||{});export default WaterfallAxis;