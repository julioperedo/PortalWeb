"use strict";import Color from"../../Color/Color.js";const color=Color["parse"];import U from"../../Utilities.js";const{addEvent,extend,merge,pick,splat}=U;var ColorAxisComposition;!function(o){const a=[];let c;function p(){const o=this.options;this.colorAxis=[],o.colorAxis&&(o.colorAxis=splat(o.colorAxis),o.colorAxis.map(o=>new c(this,o)))}function h(t){const o=this.chart.colorAxis||[],e=o=>{o=t.allItems.indexOf(o);-1!==o&&(this.destroyItem(t.allItems[o]),t.allItems.splice(o,1))};let i=[],s,n;for(o.forEach(function(o){(s=o.options)&&s.showInLegend&&(s.dataClasses&&s.visible?i=i.concat(o.getDataClassLegendSymbols()):s.visible&&i.push(o),o.series.forEach(function(o){o.options.showInLegend&&!s.dataClasses||("point"===o.options.legendType?o.points.forEach(function(o){e(o)}):e(o))}))}),n=i.length;n--;)t.allItems.unshift(i[n])}function d(o){o.visible&&o.item.legendColor&&o.item.legendItem.symbol.attr({fill:o.item.legendColor})}function f(t){this.chart.colorAxis?.forEach(o=>{o.update({},t.redraw)})}function u(){(this.chart.colorAxis&&this.chart.colorAxis.length||this.colorAttribs)&&this.translateColors()}function x(){const o=this.axisTypes;o?-1===o.indexOf("colorAxis")&&o.push("colorAxis"):this.axisTypes=["colorAxis"]}function m(o){const t=this,e=o?"show":"hide";t.visible=t.options.visible=Boolean(o),["graphic","dataLabel"].forEach(function(o){t[o]&&t[o][e]()}),this.series.buildKDTree()}function A(){const e=this,o=this.data.length?this.data:this.points,i=this.options.nullColor,s=this.colorAxis,n=this.colorKey;o.forEach(o=>{var t=o.getNestedProperty(n),t=o.options.color||(o.isNull||null===o.value?i:s&&void 0!==t?s.toColor(t,o):o.color||e.color);t&&o.color!==t&&(o.color=t,"point"===e.options.legendType&&o.legendItem&&o.legendItem.label&&e.chart.legend.colorizeItem(o,o.visible))})}function C(){this.elem.attr("fill",color(this.start).tweenTo(color(this.end),this.pos),void 0,!0)}function g(){this.elem.attr("stroke",color(this.start).tweenTo(color(this.end),this.pos),void 0,!0)}o.compose=function(o,t,e,i,s){if(c=c||o,U.pushUnique(a,t)){const n=t.prototype;n.collectionsWithUpdate.push("colorAxis"),n.collectionsWithInit.colorAxis=[n.addColorAxis],addEvent(t,"afterGetAxes",p);{o=t;const r=o.prototype.createAxis;o.prototype.createAxis=function(o,t){var e=this;if("colorAxis"!==o)return r.apply(e,arguments);o=new c(e,merge(t.axis,{index:e[o].length,isX:!1}));return e.isDirtyLegend=!0,e.axes.forEach(o=>{o.series=[]}),e.series.forEach(o=>{o.bindAxes(),o.isDirtyData=!0}),pick(t.redraw,!0)&&e.redraw(t.animation),o}}}if(U.pushUnique(a,e)){const l=e.prototype;l.fillSetter=C,l.strokeSetter=g}U.pushUnique(a,i)&&(addEvent(i,"afterGetAllItems",h),addEvent(i,"afterColorizeItem",d),addEvent(i,"afterUpdate",f)),U.pushUnique(a,s)&&(extend(s.prototype,{optionalAxis:"colorAxis",translateColors:A}),extend(s.prototype.pointClass.prototype,{setVisible:m}),addEvent(s,"afterTranslate",u,{order:1}),addEvent(s,"bindAxes",x))},o.pointSetVisible=m}(ColorAxisComposition=ColorAxisComposition||{});export default ColorAxisComposition;