"use strict";import H from"./Globals.js";const{charts,doc,noop,win}=H;import Pointer from"./Pointer.js";import U from"./Utilities.js";const{addEvent,css,objectEach,pick,removeEvent}=U,touches={},hasPointerEvent=!!win.PointerEvent;function getWebkitTouches(){const e=[];return e.item=function(t){return this[t]},objectEach(touches,function(t){e.push({pageX:t.pageX,pageY:t.pageY,target:t.target})}),e}function translateMSPointer(t,e,n,o){var r=charts[Pointer.hoverChartIndex||NaN];if(("touch"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_TOUCH)&&r){const i=r.pointer;o(t),i[e]({type:n,target:t.currentTarget,preventDefault:noop,touches:getWebkitTouches()})}}class MSPointer extends Pointer{static isRequired(){return!(H.hasTouch||!win.PointerEvent&&!win.MSPointerEvent)}batchMSEvents(t){t(this.chart.container,hasPointerEvent?"pointerdown":"MSPointerDown",this.onContainerPointerDown),t(this.chart.container,hasPointerEvent?"pointermove":"MSPointerMove",this.onContainerPointerMove),t(doc,hasPointerEvent?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}destroy(){this.batchMSEvents(removeEvent),super.destroy()}init(t,e){super.init(t,e),this.hasZoom&&css(t.container,{"-ms-touch-action":"none","touch-action":"none"})}onContainerPointerDown(t){translateMSPointer(t,"onContainerTouchStart","touchstart",function(t){touches[t.pointerId]={pageX:t.pageX,pageY:t.pageY,target:t.currentTarget}})}onContainerPointerMove(t){translateMSPointer(t,"onContainerTouchMove","touchmove",function(t){touches[t.pointerId]={pageX:t.pageX,pageY:t.pageY},touches[t.pointerId].target||(touches[t.pointerId].target=t.currentTarget)})}onDocumentPointerUp(t){translateMSPointer(t,"onDocumentTouchEnd","touchend",function(t){delete touches[t.pointerId]})}setDOMEvents(){var t=this.chart.tooltip;super.setDOMEvents(),(this.hasZoom||pick(t&&t.options.followTouchMove,!0))&&this.batchMSEvents(addEvent)}}!function(e){const n=[];e.compose=function(t){U.pushUnique(n,t)&&addEvent(t,"beforeRender",function(){this.pointer=new e(this,this.options)})}}(MSPointer=MSPointer||{});export default MSPointer;