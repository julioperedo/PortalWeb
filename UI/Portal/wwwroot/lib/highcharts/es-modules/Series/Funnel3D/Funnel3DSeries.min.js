"use strict";import Funnel3DComposition from"./Funnel3DComposition.js";import Funnel3DSeriesDefaults from"./Funnel3DSeriesDefaults.js";import Funnel3DPoint from"./Funnel3DPoint.js";import H from"../../Core/Globals.js";const noop=H["noop"];import Math3D from"../../Core/Math3D.js";const perspective=Math3D["perspective"];import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";const{series:Series,seriesTypes:{column:ColumnSeries}}=SeriesRegistry;import U from"../../Core/Utilities.js";const{extend,merge,pick,relativeLength}=U;class Funnel3DSeries extends ColumnSeries{constructor(){super(...arguments),this.center=void 0,this.data=void 0,this.options=void 0,this.points=void 0}alignDataLabel(e,t,i){const o=this,n=e.dlBoxRaw,s=o.chart.inverted,r=e.plotY>pick(o.translatedThreshold,o.yAxis.len),l=pick(i.inside,!!o.options.stacking),d={x:n.x,y:n.y,height:0};i.align=pick(i.align,!s||l?"center":r?"right":"left"),i.verticalAlign=pick(i.verticalAlign,s||l?"middle":r?"top":"bottom"),"top"!==i.verticalAlign&&(d.y+=n.bottom/("bottom"===i.verticalAlign?1:2)),d.width=o.getWidthAt(d.y),o.options.reversed&&(d.width=n.fullWidth-d.width),l?d.x-=d.width/2:"left"===i.align?(i.align="right",d.x-=1.5*d.width):"right"===i.align?(i.align="left",d.x+=d.width/2):d.x-=d.width/2,e.dlBox=d,ColumnSeries.prototype.alignDataLabel.apply(o,arguments)}bindAxes(){Series.prototype.bindAxes.apply(this,arguments),extend(this.xAxis.options,{gridLineWidth:0,lineWidth:0,title:void 0,tickPositions:[]}),merge(!0,this.yAxis.options,{gridLineWidth:0,title:void 0,labels:{enabled:!1}})}translate(){Series.prototype.translate.apply(this,arguments);const e=this,t=e.chart,i=e.options,o=i.reversed,n=i.ignoreHiddenPoint,s=t.plotWidth,r=t.plotHeight,l=i.center,d=relativeLength(l[0],s),p=relativeLength(l[1],r),a=relativeLength(i.width,s),h=relativeLength(i.height,r),g=relativeLength(i.neckWidth,s),c=relativeLength(i.neckHeight,r),m=p-h/2+h-c,u=e.data;let f=0,y=0,v,S,x,D,w,F,b,A,C;e.getWidthAt=S=function(e){var t=p-h/2;return e>m||h===c?g:g+(a-g)*(1-(e-t)/(h-c))},e.center=[d,p,h],e.centerX=d;for(const L of u)n&&!1===L.visible||(f+=L.y);for(const k of u)b=null,x=f?k.y/f:0,w=p-h/2+y*h,F=w+x*h,v=S(w),A=F-w,C={gradientForSides:pick(k.options.gradientForSides,i.gradientForSides),x:d,y:w,height:A,width:v,z:1,top:{width:v}},v=S(F),C.bottom={fraction:x,width:v},w>=m?C.isCylinder=!0:F>m&&(b=F,v=S(m),F=m,C.bottom.width=v,C.middle={fraction:A?(m-w)/A:0,width:v}),o&&(C.y=w=p+h/2-(y+x)*h,C.middle&&(C.middle.fraction=1-(A?C.middle.fraction:0)),v=C.width,C.width=C.bottom.width,C.bottom.width=v),k.shapeArgs=extend(k.shapeArgs,C),k.percentage=100*x,k.plotX=d,k.plotY=o?p+h/2-(y+x/2)*h:(w+(b||F))/2,D=perspective([{x:d,y:k.plotY,z:o?-(a-S(k.plotY))/2:-S(k.plotY)/2}],t,!0)[0],k.tooltipPos=[D.x,D.y],k.dlBoxRaw={x:d,width:S(k.plotY),y:w,bottom:C.height||0,fullWidth:a},n&&!1===k.visible||(y+=x)}}Funnel3DSeries.compose=Funnel3DComposition.compose,Funnel3DSeries.defaultOptions=merge(ColumnSeries.defaultOptions,Funnel3DSeriesDefaults),extend(Funnel3DSeries.prototype,{pointClass:Funnel3DPoint,translate3dShapes:noop}),SeriesRegistry.registerSeriesType("funnel3d",Funnel3DSeries);export default Funnel3DSeries;