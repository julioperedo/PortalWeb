"use strict";import HeikinAshiPoint from"./HeikinAshiPoint.js";import HeikinAshiSeriesDefaults from"./HeikinAshiSeriesDefaults.js";import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";const CandlestickSeries=SeriesRegistry.seriesTypes["candlestick"];import U from"../../Core/Utilities.js";const{addEvent,merge}=U,composedMembers=[];function onAxisPostProcessData(){const i=this.series;i.forEach(i=>{if(i.is("heikinashi")){const e=i;e.heikiashiData.length=0,e.getHeikinashiData()}})}function onHeikinAshiSeriesAfterTranslate(){var e=this,s=e.points,t=e.heikiashiData,a=e.cropStart||0;for(let i=e.processedYData.length=0;i<s.length;i++){const o=s[i],h=t[i+a];o.open=h[0],o.high=h[1],o.low=h[2],o.close=h[3],e.processedYData.push([o.open,o.high,o.low,o.close])}}function onHeikinAshiSeriesUpdatedData(){this.heikiashiData.length&&(this.heikiashiData.length=0)}class HeikinAshiSeries extends CandlestickSeries{constructor(){super(...arguments),this.data=void 0,this.heikiashiData=[],this.options=void 0,this.points=void 0,this.yData=void 0,this.processedYData=void 0}static compose(i,e){CandlestickSeries.compose(i),U.pushUnique(composedMembers,e)&&addEvent(e,"postProcessData",onAxisPostProcessData),U.pushUnique(composedMembers,HeikinAshiSeries)&&(addEvent(HeikinAshiSeries,"afterTranslate",onHeikinAshiSeriesAfterTranslate),addEvent(HeikinAshiSeries,"updatedData",onHeikinAshiSeriesUpdatedData))}getHeikinashiData(){var i=this,e=i.allGroupedData||i.yData,s=i.heikiashiData;if(!s.length&&e&&e.length){var t=e[0];this.modifyFirstPointValue(t);for(let i=1;i<e.length;i++){var a=e[i],o=s[i-1];this.modifyDataPoint(a,o)}}i.heikiashiData=s}init(){super.init.apply(this,arguments),this.heikiashiData=[]}modifyFirstPointValue(i){var e=(i[0]+i[1]+i[2]+i[3])/4,s=(i[0]+i[3])/2;this.heikiashiData.push([e,i[1],i[2],s])}modifyDataPoint(i,e){var e=(e[0]+e[3])/2,s=(i[0]+i[1]+i[2]+i[3])/4,t=Math.max(i[1],s,e),i=Math.min(i[2],s,e);this.heikiashiData.push([e,t,i,s])}}HeikinAshiSeries.defaultOptions=merge(CandlestickSeries.defaultOptions,HeikinAshiSeriesDefaults),HeikinAshiSeries.prototype.pointClass=HeikinAshiPoint,SeriesRegistry.registerSeriesType("heikinashi",HeikinAshiSeries);export default HeikinAshiSeries;