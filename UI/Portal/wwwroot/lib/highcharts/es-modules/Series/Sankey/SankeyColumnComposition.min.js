"use strict";import U from"../../Core/Utilities.js";const{defined,pushUnique,relativeLength}=U;var SankeyColumnComposition;!function(t){t.compose=function(t,e){const n=t;return n.sankeyColumn=new o(n,e),n};class o{constructor(t,e){this.points=t,this.series=e}getTranslationFactor(t){const e=this.points,n=e.slice(),o=t.chart,i=t.options.minLinkWidth||0;let s,r=0,a,h=(o.plotSizeY||0)-(t.options.borderWidth||0)-(e.length-1)*t.nodePadding;for(;e.length;){for(r=h/e.sankeyColumn.sum(),s=!1,a=e.length;a--;)e[a].getSum()*r<i&&(e.splice(a,1),h=Math.max(0,h-i),s=!0);if(!s)break}e.length=0;for(const l of n)e.push(l);return r}top(n){const o=this.series,i=o.nodePadding,t=this.points.reduce((t,e)=>{return 0<t&&(t+=i),t+=Math.max(e.getSum()*n,o.options.minLinkWidth||0)},0);return{top:0,center:.5,bottom:1}[o.options.nodeAlignment||"center"]*((o.chart.plotSizeY||0)-t)}left(n){const o=this.series,t=o.chart,i=o.options.equalNodes,s=t.inverted?t.plotHeight:t.plotWidth,r=o.nodePadding,e=this.points.reduce((t,e)=>{return 0<t&&(t+=r),t+=i?s/e.series.nodes.length-r:Math.max(e.getSum()*n,o.options.minLinkWidth||0)},0);return((t.plotSizeX||0)-Math.round(e))/2}sum(){return this.points.reduce((t,e)=>t+e.getSum(),0)}offset(e,n){const o=this.points,i=this.series,s=i.nodePadding;let r=0,a;if(i.is("organization")&&e.hangsFrom)return{absoluteTop:e.hangsFrom.nodeY};for(let t=0;t<o.length;t++){var h=o[t].getSum(),l=Math.max(h*n,i.options.minLinkWidth||0),u=e.options[i.chart.inverted?"offsetHorizontal":"offsetVertical"],d=e.options.offset||0;if(a=h?l+s:0,o[t]===e)return{relativeTop:r+(defined(u)?relativeLength(u,l):relativeLength(d,a))};r+=a}}}t.SankeyColumnAdditions=o}(SankeyColumnComposition=SankeyColumnComposition||{});export default SankeyColumnComposition;