!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/indicators/supertrend",["highcharts","highcharts/modules/stock"],function(o){return e(o),e.Highcharts=o,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){"use strict";o=o?o._modules:{};function e(o,e,t,r){o.hasOwnProperty(e)||(o[e]=r.apply(null,t),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:o[e]}})))}e(o,"Stock/Indicators/Supertrend/SupertrendIndicator.js",[o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"],o["Core/Chart/StockChart.js"]],function(o,e,i){const{atr:D,sma:S}=o.seriesTypes,{addEvent:n,correctFloat:v,isArray:b,extend:t,merge:j,objectEach:k}=e;function L(o,e,t){return{index:e,close:o.yData[e][t],x:o.xData[e]}}class r extends S{constructor(){super(...arguments),this.data=void 0,this.linkedParent=void 0,this.options=void 0,this.points=void 0}init(){const t=this,r=(super.init.apply(t,arguments),n(i,"afterLinkSeries",()=>{if(t.options){const o=t.options,e=t.linkedParent.options;o.cropThreshold=e.cropThreshold-(o.params.period-1)}r()},{order:1}))}drawGraph(){const t=this,o=t.options,e=t.linkedParent,r=e?e.points:[],i=t.points,n=t.graph,s=r.length-i.length,l=0<s?s:0,a={options:{gapSize:o.gapSize}},p={top:[],bottom:[],intersect:[]},d={top:{styles:{lineWidth:o.lineWidth,lineColor:o.fallingTrendColor||o.color,dashStyle:o.dashStyle}},bottom:{styles:{lineWidth:o.lineWidth,lineColor:o.risingTrendColor||o.color,dashStyle:o.dashStyle}},intersect:o.changeTrendLine};let c,h,u,g,y,x,f,m,C,T=i.length;for(;T--;)c=i[T],h=i[T-1],u=r[T-1+l],g=r[T-2+l],y=r[T+l],x=r[T+l+1],f=c.options.color,m={x:c.x,plotX:c.plotX,plotY:c.plotY,isNull:!1},!g&&u&&e.yData[u.index-1]&&(g=L(e,u.index-1,3)),!x&&y&&e.yData[y.index+1]&&(x=L(e,y.index+1,3)),!u&&g&&e.yData[g.index+1]?u=L(e,g.index+1,3):!u&&y&&e.yData[y.index-1]&&(u=L(e,y.index-1,3)),c&&u&&y&&g&&c.x!==u.x&&(c.x===y.x?(g=u,u=y):c.x===g.x?(u=g,g={close:e.yData[u.index-1][3],x:e.xData[u.index-1]}):x&&c.x===x.x&&(u=x,g=y)),h&&g&&u?(C={x:h.x,plotX:h.plotX,plotY:h.plotY,isNull:!1},c.y>=u.close&&h.y>=g.close?(c.color=f||o.fallingTrendColor||o.color,p.top.push(m)):c.y<u.close&&h.y<g.close?(c.color=f||o.risingTrendColor||o.color,p.bottom.push(m)):(p.intersect.push(m),p.intersect.push(C),p.intersect.push(j(C,{isNull:!0})),c.y>=u.close&&h.y<g.close?(c.color=f||o.fallingTrendColor||o.color,h.color=f||o.risingTrendColor||o.color,p.top.push(m),p.top.push(j(C,{isNull:!0}))):c.y<u.close&&h.y>=g.close&&(c.color=f||o.risingTrendColor||o.color,h.color=f||o.fallingTrendColor||o.color,p.bottom.push(m),p.bottom.push(j(C,{isNull:!0}))))):u&&(c.y>=u.close?(c.color=f||o.fallingTrendColor||o.color,p.top.push(m)):(c.color=f||o.risingTrendColor||o.color,p.bottom.push(m)));k(p,function(o,e){t.points=o,t.options=j(d[e].styles,a),t.graph=t["graph"+e+"Line"],S.prototype.drawGraph.call(t),t["graph"+e+"Line"]=t.graph}),t.points=i,t.options=o,t.graph=n}getValues(o,e){const t=e.period,r=e.multiplier,i=o.xData,n=o.yData,s=[],l=[],a=[],p=0===t?0:t-1,d=[],c=[];let h,u,g,y,x,f,m,C,T,S;if(!(i.length<=t||!b(n[0])||4!==n[0].length||t<0)){for(h=D.prototype.getValues.call(this,o,{period:t}).yData,S=0;S<h.length;S++)T=n[p+S],C=n[p+S-1]||[],x=d[S-1],f=c[S-1],m=a[S-1],0===S&&(x=f=m=0),u=v((T[1]+T[2])/2+r*h[S]),g=v((T[1]+T[2])/2-r*h[S]),u<x||C[3]>x?d[S]=u:d[S]=x,g>f||C[3]<f?c[S]=g:c[S]=f,m===x&&T[3]<d[S]||m===f&&T[3]<c[S]?y=d[S]:(m===x&&T[3]>d[S]||m===f&&T[3]>c[S])&&(y=c[S]),s.push([i[p+S],y]),l.push(i[p+S]),a.push(y);return{values:s,xData:l,yData:a}}}}return r.defaultOptions=j(S.defaultOptions,{params:{index:void 0,multiplier:3,period:10},risingTrendColor:"#06b535",fallingTrendColor:"#f21313",changeTrendLine:{styles:{lineWidth:1,lineColor:"#333333",dashStyle:"LongDash"}}}),t(r.prototype,{nameBase:"Supertrend",nameComponents:["multiplier","period"]}),o.registerSeriesType("supertrend",r),r}),e(o,"masters/indicators/supertrend.src.js",[],function(){})});