"use strict";import DataConverter from"./DataConverter.js";import U from"../../Core/Utilities.js";const{merge,uniqueKey}=U;class GoogleSheetsConverter extends DataConverter{constructor(e){e=merge(GoogleSheetsConverter.defaultOptions,e);super(e),this.columns=[],this.header=[],this.options=e}parse(e,t){const o=this,r=merge(o.options,e),n=(r.json&&r.json.values||[]).map(e=>e.slice());if(0===n.length)return!1;o.header=[],o.columns=[],o.emit({type:"parse",columns:o.columns,detail:t,headers:o.header});let a;for(let s=0,e=(o.columns=n).length;s<e;s++){a=n[s],o.header[s]=r.firstRowAsNames?""+a.shift():uniqueKey();for(let t=0,e=a.length;t<e;++t)if(a[t]&&"string"==typeof a[t]){let e=o.asGuessedType(a[t]);e instanceof Date&&(e=e.getTime()),o.columns[s][t]=e}}o.emit({type:"afterParse",columns:o.columns,detail:t,headers:o.header})}getTable(){return DataConverter.getTableFromColumns(this.columns,this.header)}}GoogleSheetsConverter.defaultOptions={...DataConverter.defaultOptions};export default GoogleSheetsConverter;