"use strict";import DataConnector from"./DataConnector.js";import U from"../../Core/Utilities.js";import JSONConverter from"../Converters/JSONConverter.js";const merge=U["merge"];class JSONConnector extends DataConnector{constructor(e){e=merge(JSONConnector.defaultOptions,e);super(e),this.converter=new JSONConverter(e),(this.options=e).enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){const o=this,r=o.converter,a=o.table,{data:e,dataUrl:n,dataModifier:s}=o.options;return o.emit({type:"load",data:e,detail:t,table:a}),a.deleteRows(),Promise.resolve(n?fetch(n).then(e=>e.json()):e||[]).then(e=>(e&&(r.parse({data:e}),a.setColumns(r.getTable().getColumns())),o.setModifierOptions(s).then(()=>e))).then(e=>(o.emit({type:"afterLoad",data:e,detail:t,table:a}),o)).catch(e=>{throw o.emit({type:"loadError",detail:t,error:e,table:a}),e})}}JSONConnector.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},DataConnector.registerType("JSON",JSONConnector);export default JSONConnector;