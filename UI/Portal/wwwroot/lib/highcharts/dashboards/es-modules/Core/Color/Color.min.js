"use strict";import H from"../Globals.js";import U from"../Utilities.js";const{isNumber,merge,pInt}=U;class Color{static parse(t){return t?new Color(t):Color.None}constructor(t){this.rgba=[NaN,NaN,NaN,NaN],this.input=t;const s=H.Color;if(s&&s!==Color)return new s(t);this.init(t)}init(t){let s,r,o,e;if("object"==typeof t&&void 0!==t.stops)this.stops=t.stops.map(t=>new Color(t[1]));else if("string"==typeof t){var i,n;if(this.input=t=Color.names[t.toLowerCase()]||t,"#"===t.charAt(0)&&(i=t.length,n=parseInt(t.substr(1),16),7===i?r=[(16711680&n)>>16,(65280&n)>>8,255&n,1]:4===i&&(r=[(3840&n)>>4|(3840&n)>>8,(240&n)>>4|240&n,(15&n)<<4|15&n,1])),!r)for(o=Color.parsers.length;o--&&!r;)(s=(e=Color.parsers[o]).regex.exec(t))&&(r=e.parse(s))}r&&(this.rgba=r)}get(r){const t=this.input,s=this.rgba;if("object"!=typeof t||void 0===this.stops)return s&&isNumber(s[0])?"rgb"===r||!r&&1===s[3]?"rgb("+s[0]+","+s[1]+","+s[2]+")":"a"===r?""+s[3]:"rgba("+s.join(",")+")":t;{const o=merge(t);return o.stops=[].slice.call(o.stops),this.stops.forEach((t,s)=>{o.stops[s]=[o.stops[s][0],t.get(r)]}),o}}brighten(s){const r=this.rgba;if(this.stops)this.stops.forEach(function(t){t.brighten(s)});else if(isNumber(s)&&0!==s)for(let t=0;t<3;t++)r[t]+=pInt(255*s),r[t]<0&&(r[t]=0),255<r[t]&&(r[t]=255);return this}setOpacity(t){return this.rgba[3]=t,this}tweenTo(t,s){var r=this.rgba,o=t.rgba;if(!isNumber(r[0])||!isNumber(o[0]))return t.input||"none";t=1!==o[3]||1!==r[3];return(t?"rgba(":"rgb(")+Math.round(o[0]+(r[0]-o[0])*(1-s))+","+Math.round(o[1]+(r[1]-o[1])*(1-s))+","+Math.round(o[2]+(r[2]-o[2])*(1-s))+(t?","+(o[3]+(r[3]-o[3])*(1-s)):"")+")"}}Color.names={white:"#ffffff",black:"#000000"},Color.parsers=[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(t){return[pInt(t[1]),pInt(t[2]),pInt(t[3]),parseFloat(t[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(t){return[pInt(t[1]),pInt(t[2]),pInt(t[3]),1]}}],Color.None=new Color("");export default Color;