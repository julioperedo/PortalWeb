"use strict";import A from"../Animation/AnimationUtilities.js";const{animate,animObject,setAnimation}=A;import Axis from"../Axis/Axis.js";import D from"../Defaults.js";const{defaultOptions,defaultTime}=D;import Templating from"../Templating.js";const numberFormat=Templating["numberFormat"];import Foundation from"../Foundation.js";const registerEventOptions=Foundation["registerEventOptions"];import H from"../Globals.js";const{charts,doc,marginNames,svg,win}=H;import RendererRegistry from"../Renderer/RendererRegistry.js";import Series from"../Series/Series.js";import SeriesRegistry from"../Series/SeriesRegistry.js";const seriesTypes=SeriesRegistry["seriesTypes"];import SVGRenderer from"../Renderer/SVG/SVGRenderer.js";import Time from"../Time.js";import U from"../Utilities.js";import AST from"../Renderer/HTML/AST.js";const{addEvent,attr,createElement,css,defined,diffObjects,discardElement,erase,error,extend,find,fireEvent,getStyle,isArray,isNumber,isObject,isString,merge,objectEach,pick,pInt,relativeLength,removeEvent,splat,syncTimeout,uniqueKey}=U;class Chart{static chart(t,e,i){return new Chart(t,e,i)}constructor(t,e,i){this.axes=void 0,this.axisOffset=void 0,this.bounds=void 0,this.chartHeight=void 0,this.chartWidth=void 0,this.clipBox=void 0,this.colorCounter=void 0,this.container=void 0,this.eventOptions=void 0,this.index=void 0,this.isResizing=void 0,this.labelCollectors=void 0,this.margin=void 0,this.numberFormatter=void 0,this.options=void 0,this.plotBox=void 0,this.plotHeight=void 0,this.plotLeft=void 0,this.plotTop=void 0,this.plotWidth=void 0,this.pointCount=void 0,this.pointer=void 0,this.renderer=void 0,this.renderTo=void 0,this.series=void 0,this.sharedClips={},this.spacing=void 0,this.spacingBox=void 0,this.symbolCounter=void 0,this.time=void 0,this.titleOffset=void 0,this.userOptions=void 0,this.xAxis=void 0,this.yAxis=void 0,this.zooming=void 0,this.getArgs(t,e,i)}getArgs(t,e,i){isString(t)||t.nodeName?(this.renderTo=t,this.init(e,i)):this.init(t,e)}setZoomOptions(){var t=this.options.chart,e=t.zooming;this.zooming={...e,type:pick(t.zoomType,e.type),key:pick(t.zoomKey,e.key),pinchType:pick(t.pinchType,e.pinchType),singleTouch:pick(t.zoomBySingleTouch,e.singleTouch,!1),resetButton:merge(e.resetButton,t.resetZoomButton)}}init(i,s){fireEvent(this,"init",{args:arguments},function(){var t=merge(defaultOptions,i),e=t.chart,t=(this.userOptions=extend({},i),this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.labelCollectors=[],this.callback=s,this.isResizing=0,this.options=t,this.axes=[],this.series=[],this.time=i.time&&Object.keys(i.time).length?new Time(i.time):H.time,this.numberFormatter=e.numberFormatter||numberFormat,this.styledMode=e.styledMode,this.hasCartesianSeries=e.showAxes,this);t.index=charts.length,charts.push(t),H.chartCount++,registerEventOptions(this,e),t.xAxis=[],t.yAxis=[],t.pointCount=t.colorCounter=t.symbolCounter=0,this.setZoomOptions(),fireEvent(t,"afterInit"),t.firstRender()})}initSeries(t){const e=this,i=e.options.chart,s=t.type||i.type,o=seriesTypes[s],r=(o||error(17,!0,e,{missingModuleFor:s}),new o);return"function"==typeof r.init&&r.init(e,t),r}setSeriesData(){this.getSeriesOrderByLinks().forEach(function(t){t.points||t.data||!t.enabledDataSorting||t.setData(t.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(t,e){return t.linkedSeries.length||e.linkedSeries.length?e.linkedSeries.length-t.linkedSeries.length:0})}orderItems(t,i=0){const s=this[t],o=this.options[t]=splat(this.options[t]).slice(),r=this.userOptions[t]=this.userOptions[t]?splat(this.userOptions[t]).slice():[];if(this.hasRendered&&(o.splice(i),r.splice(i)),s)for(let t=i,e=s.length;t<e;++t){const n=s[t];n&&(n.index=t,n instanceof Series&&(n.name=n.getName()),n.options.isInternal||(o[t]=n.options,r[t]=n.userOptions))}}isInsidePlot(t,e,i={}){var{inverted:s,plotBox:o,plotLeft:r,plotTop:n,scrollablePlotBox:a}=this;let h=0,d=0;i.visiblePlotOnly&&this.scrollingContainer&&({scrollLeft:h,scrollTop:d}=this.scrollingContainer);const l=i.series,c=i.visiblePlotOnly&&a||o,p=i.inverted?e:t,g=i.inverted?t:e,f={x:p,y:g,isInsidePlot:!0,options:i};return i.ignoreX||(a=l&&(s&&!this.polar?l.yAxis:l.xAxis)||{pos:r,len:1/0},(o=i.paneCoordinates?a.pos+p:r+p)>=Math.max(h+r,a.pos)&&o<=Math.min(h+r+c.width,a.pos+a.len)||(f.isInsidePlot=!1)),!i.ignoreY&&f.isInsidePlot&&(t=!s&&i.axis&&!i.axis.isXAxis&&i.axis||l&&(s?l.xAxis:l.yAxis)||{pos:n,len:1/0},(e=i.paneCoordinates?t.pos+g:n+g)>=Math.max(d+n,t.pos)&&e<=Math.min(d+n+c.height,t.pos+t.len)||(f.isInsidePlot=!1)),fireEvent(this,"afterIsInsidePlot",f),f.isInsidePlot}redraw(t){fireEvent(this,"beforeRedraw");const e=this,i=e.hasCartesianSeries?e.axes:e.colorAxis||[],s=e.series,o=e.pointer,r=e.legend,n=e.userOptions.legend,a=e.renderer,h=a.isHidden(),d=[];let l,c,p,g=e.isDirtyBox,f=e.isDirtyLegend,m;for(a.rootFontSize=a.boxWrapper.getStyle("font-size"),e.setResponsive&&e.setResponsive(!1),setAnimation(!!e.hasRendered&&t,e),h&&e.temporaryDisplay(),e.layOutTitles(!1),p=s.length;p--;)if(((m=s[p]).options.stacking||m.options.centerInCategory)&&(c=!0,m.isDirty)){l=!0;break}if(l)for(p=s.length;p--;)(m=s[p]).options.stacking&&(m.isDirty=!0);s.forEach(function(t){t.isDirty&&("point"===t.options.legendType?("function"==typeof t.updateTotals&&t.updateTotals(),f=!0):n&&(n.labelFormatter||n.labelFormat)&&(f=!0)),t.isDirtyData&&fireEvent(t,"updatedData")}),f&&r&&r.options.enabled&&(r.render(),e.isDirtyLegend=!1),c&&e.getStacks(),i.forEach(function(t){t.updateNames(),t.setScale()}),e.getMargins(),i.forEach(function(t){t.isDirty&&(g=!0)}),i.forEach(function(t){var e=t.min+","+t.max;t.extKey!==e&&(t.extKey=e,d.push(function(){fireEvent(t,"afterSetExtremes",extend(t.eventArgs,t.getExtremes())),delete t.eventArgs})),(g||c)&&t.redraw()}),g&&e.drawChartBox(),fireEvent(e,"predraw"),s.forEach(function(t){(g||t.isDirty)&&t.visible&&t.redraw(),t.isDirtyData=!1}),o&&o.reset(!0),a.draw(),fireEvent(e,"redraw"),fireEvent(e,"render"),h&&e.temporaryDisplay(!0),d.forEach(function(t){t.call()})}get(e){var i=this.series;function s(t){return t.id===e||t.options&&t.options.id===e}let o=find(this.axes,s)||find(this.series,s);for(let t=0;!o&&t<i.length;t++)o=find(i[t].points||[],s);return o}getAxes(){const t=this.options;fireEvent(this,"getAxes");for(const e of["xAxis","yAxis"])for(const i of t[e]=splat(t[e]||{}))new Axis(this,i,e);fireEvent(this,"afterGetAxes")}getSelectedPoints(){return this.series.reduce((e,t)=>(t.getPointsCollection().forEach(t=>{pick(t.selectedStaging,t.selected)&&e.push(t)}),e),[])}getSelectedSeries(){return this.series.filter(function(t){return t.selected})}setTitle(t,e,i){this.applyDescription("title",t),this.applyDescription("subtitle",e),this.applyDescription("caption",void 0),this.layOutTitles(i)}applyDescription(i,t){const s=this;var e=this.options[i]=merge(this.options[i],t);let o=this[i];o&&t&&(this[i]=o=o.destroy()),e&&!o&&((o=this.renderer.text(e.text,0,0,e.useHTML).attr({align:e.align,class:"highcharts-"+i,zIndex:e.zIndex||4}).add()).update=function(t,e){s.applyDescription(i,t),s.layOutTitles(e)},this.styledMode||o.css(extend("title"===i?{fontSize:this.options.isStock?"1em":"1.2em"}:{},e.style)),this[i]=o)}layOutTitles(t=!0){const n=[0,0,0],a=this.renderer,h=this.spacingBox;["title","subtitle","caption"].forEach(function(t){const e=this[t],i=this.options[t],s=i.verticalAlign||"top",o="title"===t?"top"===s?-3:0:"top"===s?n[0]+2:0;var r;e&&(e.css({width:(i.width||h.width+(i.widthAdjust||0))+"px"}),t=a.fontMetrics(e).b,r=Math.round(e.getBBox(i.useHTML).height),e.align(extend({y:"bottom"===s?t:o+t,height:r},i),!1,"spacingBox"),i.floating||("top"===s?n[0]=Math.ceil(n[0]+r):"bottom"===s&&(n[2]=Math.ceil(n[2]+r))))},this),n[0]&&"top"===(this.options.title.verticalAlign||"top")&&(n[0]+=this.options.title.margin),n[2]&&"bottom"===this.options.caption.verticalAlign&&(n[2]+=this.options.caption.margin);var e=!this.titleOffset||this.titleOffset.join(",")!==n.join(",");this.titleOffset=n,fireEvent(this,"afterLayOutTitles"),!this.isDirtyBox&&e&&(this.isDirtyBox=this.isDirtyLegend=e,this.hasRendered&&t&&this.isDirtyBox&&this.redraw())}getContainerBox(){return{width:getStyle(this.renderTo,"width",!0)||0,height:getStyle(this.renderTo,"height",!0)||0}}getChartSize(){var t=this,e=t.options.chart,i=e.width,e=e.height,s=t.getContainerBox();t.chartWidth=Math.max(0,i||s.width||600),t.chartHeight=Math.max(0,relativeLength(e,t.chartWidth)||(1<s.height?s.height:400)),t.containerBox=s}temporaryDisplay(t){let e=this.renderTo,i;if(t)for(;e&&e.style;)e.hcOrigStyle&&(css(e,e.hcOrigStyle),delete e.hcOrigStyle),e.hcOrigDetached&&(doc.body.removeChild(e),e.hcOrigDetached=!1),e=e.parentNode;else for(;e&&e.style&&(doc.body.contains(e)||e.parentNode||(e.hcOrigDetached=!0,doc.body.appendChild(e)),"none"!==getStyle(e,"display",!1)&&!e.hcOricDetached||(e.hcOrigStyle={display:e.style.display,height:e.style.height,overflow:e.style.overflow},i={display:"block",overflow:"hidden"},e!==this.renderTo&&(i.height=0),css(e,i),e.offsetWidth||e.style.setProperty("display","block","important")),(e=e.parentNode)!==doc.body););}setClassName(t){this.container.className="highcharts-container "+(t||"")}getContainer(){var t=this,e=t.options,i=e.chart,s="data-highcharts-chart",o=uniqueKey();let r,n=t.renderTo;n||(t.renderTo=n=i.renderTo),isString(n)&&(t.renderTo=n=doc.getElementById(n)),n||error(13,!0,t);var a=pInt(attr(n,s)),a=(isNumber(a)&&charts[a]&&charts[a].hasRendered&&charts[a].destroy(),attr(n,s,t.index),n.innerHTML=AST.emptyHTML,i.skipClone||n.offsetWidth||t.temporaryDisplay(),t.getChartSize(),t.chartWidth),s=t.chartHeight,o=(css(n,{overflow:"hidden"}),t.styledMode||(r=extend({position:"relative",overflow:"hidden",width:a+"px",height:s+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none"},i.style||{})),createElement("div",{id:o},r,n));t.container=o,t._cursor=o.style.cursor;const h=i.renderer||!svg?RendererRegistry.getRendererType(i.renderer):SVGRenderer;if(t.renderer=new h(o,a,s,void 0,i.forExport,e.exporting&&e.exporting.allowHTML,t.styledMode),t.containerBox=t.getContainerBox(),setAnimation(void 0,t),t.setClassName(i.className),t.styledMode)for(const d in e.defs)this.renderer.definition(e.defs[d]);else t.renderer.setStyle(i.style);t.renderer.chartIndex=t.index,fireEvent(this,"afterGetContainer")}getMargins(t){var{spacing:e,margin:i,titleOffset:s}=this;this.resetMargins(),s[0]&&!defined(i[0])&&(this.plotTop=Math.max(this.plotTop,s[0]+e[0])),s[2]&&!defined(i[2])&&(this.marginBottom=Math.max(this.marginBottom,s[2]+e[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(i,e),fireEvent(this,"getMargins"),t||this.getAxisMargins()}getAxisMargins(){function t(t){t.forEach(function(t){t.visible&&t.getOffset()})}const i=this,s=i.axisOffset=[0,0,0,0],e=i.colorAxis,o=i.margin;i.hasCartesianSeries?t(i.axes):e&&e.length&&t(e),marginNames.forEach(function(t,e){defined(o[e])||(i[t]+=s[e])}),i.setChartSize()}getOptions(){return diffObjects(this.userOptions,defaultOptions)}reflow(t){const e=this,i=e.containerBox,s=e.getContainerBox();delete e.pointer.chartPosition,!e.isPrinting&&!e.isResizing&&i&&s.width&&(s.width===i.width&&s.height===i.height||(U.clearTimeout(e.reflowTimeout),e.reflowTimeout=syncTimeout(function(){e.container&&e.setSize(void 0,void 0,!1)},t?100:0)),e.containerBox=s)}setReflow(){const e=this;var t=t=>{e.options?.chart.reflow&&e.hasLoaded&&e.reflow(t)};"function"==typeof ResizeObserver?new ResizeObserver(t).observe(e.renderTo):(t=addEvent(win,"resize",t),addEvent(this,"destroy",t))}setSize(t,e,i){const s=this,o=s.renderer;s.isResizing+=1,setAnimation(i,s);i=o.globalAnimation;s.oldChartHeight=s.chartHeight,s.oldChartWidth=s.chartWidth,void 0!==t&&(s.options.chart.width=t),void 0!==e&&(s.options.chart.height=e),s.getChartSize(),s.styledMode||(i?animate:css)(s.container,{width:s.chartWidth+"px",height:s.chartHeight+"px"},i),s.setChartSize(!0),o.setSize(s.chartWidth,s.chartHeight,i),s.axes.forEach(function(t){t.isDirty=!0,t.setScale()}),s.isDirtyLegend=!0,s.isDirtyBox=!0,s.layOutTitles(),s.getMargins(),s.redraw(i),s.oldChartHeight=null,fireEvent(s,"resize"),setTimeout(()=>{s&&fireEvent(s,"endResize",void 0,()=>{--s.isResizing})},animObject(i).duration)}setChartSize(t){const e=this,i=e.inverted,s=e.renderer,o=e.chartWidth,r=e.chartHeight,n=e.options.chart,a=e.spacing,h=e.clipOffset;e.plotLeft=l=Math.round(e.plotLeft),e.plotTop=c=Math.round(e.plotTop),e.plotWidth=p=Math.max(0,Math.round(o-l-e.marginRight)),e.plotHeight=d=Math.max(0,Math.round(r-c-e.marginBottom)),e.plotSizeX=i?d:p,e.plotSizeY=i?p:d,e.plotBorderWidth=n.plotBorderWidth||0,e.spacingBox=s.spacingBox={x:a[3],y:a[0],width:o-a[3]-a[1],height:r-a[0]-a[2]},e.plotBox=s.plotBox={x:l,y:c,width:p,height:d};var d,l=2*Math.floor(e.plotBorderWidth/2),c=Math.ceil(Math.max(l,h[3])/2),p=Math.ceil(Math.max(l,h[0])/2);e.clipBox={x:c,y:p,width:Math.floor(e.plotSizeX-Math.max(l,h[1])/2-c),height:Math.max(0,Math.floor(e.plotSizeY-Math.max(l,h[2])/2-p))},t||(e.axes.forEach(function(t){t.setAxisSize(),t.setAxisTranslation()}),s.alignElements()),fireEvent(e,"afterSetChartSize",{skipAxes:t})}resetMargins(){fireEvent(this,"resetMargins");const o=this,r=o.options.chart;["margin","spacing"].forEach(function(i){const t=r[i],s=isObject(t)?t:[t,t,t,t];["Top","Right","Bottom","Left"].forEach(function(t,e){o[i][e]=pick(r[i+t],s[e])})}),marginNames.forEach(function(t,e){o[t]=pick(o.margin[e],o.spacing[e])}),o.axisOffset=[0,0,0,0],o.clipOffset=[0,0,0,0]}drawChartBox(){const t=this,e=t.options.chart,i=t.renderer,s=t.chartWidth,o=t.chartHeight,r=t.styledMode,n=t.plotBGImage,a=e.backgroundColor,h=e.plotBackgroundColor,d=e.plotBackgroundImage,l=t.plotLeft,c=t.plotTop,p=t.plotWidth,g=t.plotHeight,f=t.plotBox,m=t.clipRect,u=t.clipBox;let x=t.chartBackground,y=t.plotBackground,v=t.plotBorder,S,b,w,E="animate";x||(t.chartBackground=x=i.rect().addClass("highcharts-background").add(),E="attr"),r?S=b=x.strokeWidth():(S=e.borderWidth||0,b=S+(e.shadow?8:0),w={fill:a||"none"},(S||x["stroke-width"])&&(w.stroke=e.borderColor,w["stroke-width"]=S),x.attr(w).shadow(e.shadow)),x[E]({x:b/2,y:b/2,width:s-b-S%2,height:o-b-S%2,r:e.borderRadius}),E="animate",y||(E="attr",t.plotBackground=y=i.rect().addClass("highcharts-plot-background").add()),y[E](f),r||(y.attr({fill:h||"none"}).shadow(e.plotShadow),d&&(n?(d!==n.attr("href")&&n.attr("href",d),n.animate(f)):t.plotBGImage=i.image(d,l,c,p,g).add())),m?m.animate({width:u.width,height:u.height}):t.clipRect=i.clipRect(u),E="animate",v||(E="attr",t.plotBorder=v=i.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),r||v.attr({stroke:e.plotBorderColor,"stroke-width":e.plotBorderWidth||0,fill:"none"}),v[E](v.crisp({x:l,y:c,width:p,height:g},-v.strokeWidth())),t.isDirtyBox=!1,fireEvent(this,"afterDrawChartBox")}propFromSeries(){const e=this,i=e.options.chart,s=e.options.series;let o,r,n;["inverted","angular","polar"].forEach(function(t){for(r=seriesTypes[i.type],n=i[t]||r&&r.prototype[t],o=s&&s.length;!n&&o--;)(r=seriesTypes[s[o].type])&&r.prototype[t]&&(n=!0);e[t]=n})}linkSeries(t){const i=this,e=i.series;e.forEach(function(t){t.linkedSeries.length=0}),e.forEach(function(t){let e=t.options.linkedTo;isString(e)&&(e=":previous"===e?i.series[t.index-1]:i.get(e))&&e.linkedParent!==t&&(e.linkedSeries.push(t),(t.linkedParent=e).enabledDataSorting&&t.setDataSortingOptions(),t.visible=pick(t.options.visible,e.options.visible,t.visible))}),fireEvent(this,"afterLinkSeries",{isUpdating:t})}renderSeries(){this.series.forEach(function(t){t.translate(),t.render()})}render(){function t(t){t.forEach(function(t){t.visible&&t.render()})}const e=this,i=e.axes,s=e.colorAxis,o=e.renderer;let r=0;e.setTitle(),fireEvent(e,"beforeMargins"),e.getStacks&&e.getStacks(),e.getMargins(!0),e.setChartSize();var n=e.plotWidth,a=(i.some(function(t){if(t.horiz&&t.visible&&t.options.labels.enabled&&t.series.length)return r=21,!0}),e.plotHeight=Math.max(e.plotHeight-r,0),e.plotHeight);i.forEach(function(t){t.setScale()}),e.getAxisMargins();const h=1.1<n/e.plotWidth,d=1.05<a/e.plotHeight;(h||d)&&(i.forEach(function(t){(t.horiz&&h||!t.horiz&&d)&&t.setTickInterval(!0)}),e.getMargins()),e.drawChartBox(),e.hasCartesianSeries?t(i):s&&s.length&&t(s),e.seriesGroup||(e.seriesGroup=o.g("series-group").attr({zIndex:3}).shadow(e.options.chart.seriesGroupShadow).add()),e.renderSeries(),e.addCredits(),e.setResponsive&&e.setResponsive(),e.hasRendered=!0}addCredits(t){const e=this,i=merge(!0,this.options.credits,t);i.enabled&&!this.credits&&(this.credits=this.renderer.text(i.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){i.href&&(win.location.href=i.href)}).attr({align:i.position.align,zIndex:8}),e.styledMode||this.credits.css(i.style),this.credits.add().align(i.position),this.credits.update=function(t){e.credits=e.credits.destroy(),e.addCredits(t)})}destroy(){const i=this,t=i.axes,e=i.series,s=i.container,o=s&&s.parentNode;let r;for(fireEvent(i,"destroy"),i.renderer.forExport?erase(charts,i):charts[i.index]=void 0,H.chartCount--,i.renderTo.removeAttribute("data-highcharts-chart"),removeEvent(i),r=t.length;r--;)t[r]=t[r].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),r=e.length;r--;)e[r]=e[r].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(function(t){const e=i[t];e&&e.destroy&&(i[t]=e.destroy())}),s&&(s.innerHTML=AST.emptyHTML,removeEvent(s),o&&discardElement(s)),objectEach(i,function(t,e){delete i[e]})}firstRender(){const e=this,t=e.options,i=(e.getContainer(),e.resetMargins(),e.setChartSize(),e.propFromSeries(),e.getAxes(),isArray(t.series)?t.series:[]);t.series=[],i.forEach(function(t){e.initSeries(t)}),e.linkSeries(),e.setSeriesData(),fireEvent(e,"beforeRender"),e.render(),e.pointer.getChartPosition(),e.renderer.imgCount||e.hasLoaded||e.onload(),e.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(t){t&&void 0!==this.index&&t.apply(this,[this])},this),fireEvent(this,"load"),fireEvent(this,"render"),defined(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){const{options:t,title:e}=this;t&&!this.accessibility&&(this.renderer.boxWrapper.attr({role:"img","aria-label":(e&&e.element.textContent||"").replace(/</g,"&lt;")}),t.accessibility&&!1===t.accessibility.enabled||error('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(t,e,i){const s=this;let o;return t&&(e=pick(e,!0),fireEvent(s,"addSeries",{options:t},function(){o=s.initSeries(t),s.isDirtyLegend=!0,s.linkSeries(),o.enabledDataSorting&&o.setData(t.data,!1),fireEvent(s,"afterAddSeries",{series:o}),e&&s.redraw(i)})),o}addAxis(t,e,i,s){return this.createAxis(e?"xAxis":"yAxis",{axis:t,redraw:i,animation:s})}addColorAxis(t,e,i){return this.createAxis("colorAxis",{axis:t,redraw:e,animation:i})}createAxis(t,e){t=new Axis(this,e.axis,t);return pick(e.redraw,!0)&&this.redraw(e.animation),t}showLoading(t){function e(){r&&css(r,{left:i.plotLeft+"px",top:i.plotTop+"px",width:i.plotWidth+"px",height:i.plotHeight+"px"})}const i=this,s=i.options,o=s.loading;let r=i.loadingDiv,n=i.loadingSpan;r||(i.loadingDiv=r=createElement("div",{className:"highcharts-loading highcharts-loading-hidden"},null,i.container)),n||(i.loadingSpan=n=createElement("span",{className:"highcharts-loading-inner"},null,r),addEvent(i,"redraw",e)),r.className="highcharts-loading",AST.setElementHTML(n,pick(t,s.lang.loading,"")),i.styledMode||(css(r,extend(o.style,{zIndex:10})),css(n,o.labelStyle),i.loadingShown||(css(r,{opacity:0,display:""}),animate(r,{opacity:o.style.opacity||.5},{duration:o.showDuration||0}))),i.loadingShown=!0,e()}hideLoading(){const t=this.options,e=this.loadingDiv;e&&(e.className="highcharts-loading highcharts-loading-hidden",this.styledMode||animate(e,{opacity:0},{duration:t.loading.hideDuration||100,complete:function(){css(e,{display:"none"})}})),this.loadingShown=!1}update(i,t,r,e){const n=this,s={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},o=i.isResponsiveOptions,a=[];let h,d,l;fireEvent(n,"update",{options:i}),o||n.setResponsive(!1,!0),i=diffObjects(i,n.options),n.userOptions=merge(n.userOptions,i);var c=i.chart,p=(c&&(merge(!0,n.options.chart,c),this.setZoomOptions(),"className"in c&&n.setClassName(c.className),("inverted"in c||"polar"in c||"type"in c)&&(n.propFromSeries(),h=!0),"alignTicks"in c&&(h=!0),"events"in c&&registerEventOptions(this,c),objectEach(c,function(t,e){-1!==n.propsRequireUpdateSeries.indexOf("chart."+e)&&(d=!0),-1!==n.propsRequireDirtyBox.indexOf(e)&&(n.isDirtyBox=!0),-1!==n.propsRequireReflow.indexOf(e)&&(o?n.isDirtyBox=!0:l=!0)}),!n.styledMode&&c.style&&n.renderer.setStyle(n.options.chart.style||{})),!n.styledMode&&i.colors&&(this.options.colors=i.colors),i.time&&(this.time===defaultTime&&(this.time=new Time(i.time)),merge(!0,n.options.time,i.time)),objectEach(i,function(t,e){n[e]&&"function"==typeof n[e].update?n[e].update(t,!1):"function"==typeof n[s[e]]?n[s[e]](t):"colors"!==e&&-1===n.collectionsWithUpdate.indexOf(e)&&merge(!0,n.options[e],i[e]),"chart"!==e&&-1!==n.propsRequireUpdateSeries.indexOf(e)&&(d=!0)}),this.collectionsWithUpdate.forEach(function(o){i[o]&&(splat(i[o]).forEach(function(t,e){var i=defined(t.id);let s;(s=!(s=i?n.get(t.id):s)&&n[o]&&(s=n[o][pick(t.index,e)])&&(i&&defined(s.options.id)||s.options.isInternal)?void 0:s)&&s.coll===o&&(s.update(t,!1),r&&(s.touched=!0)),!s&&r&&n.collectionsWithInit[o]&&(n.collectionsWithInit[o][0].apply(n,[t].concat(n.collectionsWithInit[o][1]||[]).concat([!1])).touched=!0)}),r&&n[o].forEach(function(t){t.touched||t.options.isInternal?delete t.touched:a.push(t)}))}),a.forEach(function(t){t.chart&&t.remove&&t.remove(!1)}),h&&n.axes.forEach(function(t){t.update({},!1)}),d&&n.getSeriesOrderByLinks().forEach(function(t){t.chart&&t.update({},!1)},this),c&&c.width),c=c&&(isString(c.height)?relativeLength(c.height,p||n.chartWidth):c.height);l||isNumber(p)&&p!==n.chartWidth||isNumber(c)&&c!==n.chartHeight?n.setSize(p,c,e):pick(t,!0)&&n.redraw(e),fireEvent(n,"afterUpdate",{options:i,redraw:t,animation:e})}setSubtitle(t,e){this.applyDescription("subtitle",t),this.layOutTitles(e)}setCaption(t,e){this.applyDescription("caption",t),this.layOutTitles(e)}showResetZoom(){const t=this,e=defaultOptions.lang,i=t.zooming.resetButton,s=i.theme,o="chart"===i.relativeTo||"spacingBox"===i.relativeTo?null:"scrollablePlotBox";function r(){t.zoomOut()}fireEvent(this,"beforeShowResetZoom",null,function(){t.resetZoomButton=t.renderer.button(e.resetZoom,null,null,r,s).attr({align:i.position.align,title:e.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(i.position,!1,o)}),fireEvent(this,"afterShowResetZoom")}zoomOut(){fireEvent(this,"selection",{resetSelection:!0},this.zoom)}zoom(t){const n=this,a=n.pointer;let h=!1,d;!t||t.resetSelection?(n.axes.forEach(function(t){d=t.zoom()}),a.initiated=!1):t.xAxis.concat(t.yAxis).forEach(function(t){const e=t.axis,i=e.isXAxis,{hasPinched:s,mouseDownX:o,mouseDownY:r}=a;(a[i?"zoomX":"zoomY"]&&defined(o)&&defined(r)&&n.isInsidePlot(o-n.plotLeft,r-n.plotTop,{axis:e,ignoreX:s,ignoreY:s})||!defined(n.inverted?o:r))&&(d=e.zoom(t.min,t.max),e.displayBtn&&(h=!0))});const e=n.resetZoomButton;h&&!e?n.showResetZoom():!h&&isObject(e)&&(n.resetZoomButton=e.destroy()),d&&n.redraw(pick(n.options.chart.animation,t&&t.animation,n.pointCount<100))}pan(f,t){const m=this,e=m.hoverPoints,i="object"==typeof t?t:{enabled:t,type:"x"},s=m.options.chart,u=(s&&s.panning&&(s.panning=i),i.type);let x;fireEvent(this,"pan",{originalEvent:f},function(){e&&e.forEach(function(t){t.setState()});let t=m.xAxis;"xy"===u?t=t.concat(m.yAxis):"y"===u&&(t=m.yAxis);const g={};t.forEach(function(o){if(o.options.panningEnabled&&!o.options.isInternal){var r=o.horiz,n=f[r?"chartX":"chartY"],r=r?"mouseDownX":"mouseDownY",a=m[r],h=o.minPointOffset||0,d=o.reversed&&!m.inverted||!o.reversed&&m.inverted?-1:1,l=o.getExtremes(),c=o.toValue(a-n,!0)+h*d,a=o.toValue(a+o.len-n,!0)-(h*d||o.isXAxis&&o.pointRangePadding||0),d=a<c,p=o.hasVerticalPanning();let t=d?a:c,e=d?c:a,i=o.panningState,s;!p||o.isXAxis||i&&!i.isDirty||o.series.forEach(function(t){var e=t.getProcessedData(!0),e=t.getExtremes(e.yData,!0);i=i||{startMin:Number.MAX_VALUE,startMax:-Number.MAX_VALUE},isNumber(e.dataMin)&&isNumber(e.dataMax)&&(i.startMin=Math.min(pick(t.options.threshold,1/0),e.dataMin,i.startMin),i.startMax=Math.max(pick(t.options.threshold,-1/0),e.dataMax,i.startMax))});d=Math.min(pick(i&&i.startMin,l.dataMin),h?l.min:o.toValue(o.toPixels(l.min)-o.minPixelPadding)),c=Math.max(pick(i&&i.startMax,l.dataMax),h?l.max:o.toValue(o.toPixels(l.max)+o.minPixelPadding));o.panningState=i,o.isOrdinal||(0<(s=d-t)&&(e+=s,t=d),0<(s=e-c)&&(e=c,t-=s),o.series.length&&t!==l.min&&e!==l.max&&t>=d&&e<=c&&(o.setExtremes(t,e,!1,!1,{trigger:"pan"}),!m.resetZoomButton&&t!==d&&e!==c&&u.match("y")&&(m.showResetZoom(),o.displayBtn=!1),x=!0),g[r]=n)}}),objectEach(g,(t,e)=>{m[e]=t}),x&&m.redraw(!1),css(m.container,{cursor:"move"})})}}extend(Chart.prototype,{callbacks:[],collectionsWithInit:{xAxis:[Chart.prototype.addAxis,[!0]],yAxis:[Chart.prototype.addAxis,[!1]],series:[Chart.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]});export default Chart;