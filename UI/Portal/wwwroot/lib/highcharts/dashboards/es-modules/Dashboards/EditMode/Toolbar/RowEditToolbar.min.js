import U from"../../../Core/Utilities.js";import EditGlobals from"../EditGlobals.js";import EditToolbar from"./EditToolbar.js";import GUIElement from"../../Layout/GUIElement.js";const{merge,objectEach}=U;class RowEditToolbar extends EditToolbar{static getMenuItemsConfig(t,e){const o=[];return t.dragDrop?.enabled&&o.push({id:"drag",type:"icon",icon:e+"drag.svg",events:{onmousedown:function(t){const e=this.menu.parent,o=e.editMode.dragDrop;o&&e.row&&o.onDragStart(t,e.row)}}}),t.settings?.enabled&&o.push({id:"settings",type:"icon",icon:e+"settings.svg",events:{click:function(t){this.menu.parent.editMode.setEditOverlay(),this.menu.parent.onRowOptions(t)}}}),o.push({id:"destroy",type:"icon",className:EditGlobals.classNames.menuDestroy,icon:e+"destroy.svg",events:{click:function(t){const e=this.menu.parent,o=this.menu.parent.editMode,i=o.confirmationPopup;i.show({confirmButton:{value:o.lang.confirmButton,callback:e.onRowDestroy,context:e},cancelButton:{value:o.lang.cancelButton,callback:()=>{i.closePopup()}},text:o.lang.confirmDestroyRow})}}}),o}constructor(t){super(t,merge(RowEditToolbar.defaultOptions,(t.options.toolbars||{}).row,{menu:{items:RowEditToolbar.getMenuItemsConfig(t.options,t.iconsURLPrefix)}})),this.menu.initItems({})}refreshOutline(t,e){this.row&&this.row.container&&super.refreshOutline(t,e,this.row,2)}showToolbar(t){var e,o,i,s=this;t.container&&s.editMode.isActive()&&!(s.editMode.dragDrop||{}).isActive?(i=(o=GUIElement.getOffsets(t,s.editMode.board.container)).right-o.left,objectEach(s.menu.items,t=>{t.activate()}),i=i/2-s.container.clientWidth/2,e=o.left+i,o=o.top-s.container.clientHeight,s.setPosition(e,o),s.row=t,s.refreshOutline(-i,s.container.clientHeight)):s.isVisible&&s.hide()}onRowOptions(t){var e=this;e.editMode.sidebar&&e.editMode.sidebar.show(e.row)}onRowDestroy(t){var e=this;e.row&&(this.resetEditedRow(),e.row.destroy(),e.row=void 0,e.editMode.hideToolbars(["cell","row"]))}resetEditedRow(){this.editedRow=void 0}}RowEditToolbar.defaultOptions={enabled:!0,className:EditGlobals.classNames.editToolbar,outline:!0,outlineClassName:EditGlobals.classNames.editToolbarRowOutline,menu:{className:EditGlobals.classNames.editToolbarRow,itemsClassName:EditGlobals.classNames.editToolbarItem,items:[]}};export default RowEditToolbar;